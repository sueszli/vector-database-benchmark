'''
The masks generated by the CNN / predictor are not binary and are of the wrong size.
This script thresholds them - to binary and resizes them to be the correct size (same size as input images).
'''
import os
from os import listdir
from os.path import isfile, join
from scipy import misc

MASK_OUTPUT_PATH = 'MASKS_RESIZED'
MASK_INPUT_PATH = 'outputs'
# Input image sizes.
TARGET_SIZE = (375,1242)


masks = [MASK_INPUT_PATH + os.sep + f for f in listdir(MASK_INPUT_PATH) if isfile(join(MASK_INPUT_PATH, f))]

for i in masks:
    img = misc.imread(i, flatten=True)
    resized = misc.imresize(img, TARGET_SIZE, interp='bilinear', mode=None)
    thresholded = resized > 10
    misc.imsave(MASK_OUTPUT_PATH + os. sep + os.path.basename(i)+ '.png', thresholded)

