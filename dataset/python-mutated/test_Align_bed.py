"""Tests for Align.bed module."""
import unittest
import tempfile
import os
from io import StringIO
from Bio import Align
from Bio.Align import Alignment
from Bio.Seq import Seq
from Bio.SeqRecord import SeqRecord
from Bio import SeqIO
import numpy as np

class TestAlign_dna_rna(unittest.TestCase):

    def setUp(self):
        if False:
            print('Hello World!')
        data = {}
        records = SeqIO.parse('Blat/dna.fa', 'fasta')
        for record in records:
            (name, start_end) = record.id.split(':')
            assert name == 'chr3'
            (start, end) = start_end.split('-')
            start = int(start)
            end = int(end)
            sequence = str(record.seq)
            assert len(sequence) == end - start
            data[start] = sequence
        self.dna = Seq(data, length=198295559)
        records = SeqIO.parse('Blat/rna.fa', 'fasta')
        self.rna = {record.id: record.seq for record in records}

    def check_alignments(self, alignments):
        if False:
            print('Hello World!')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 1711))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr3')
        self.assertEqual(alignment.query.id, 'NR_046654.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[42530895, 42530958, 42532020, 42532095, 42532563, 42532606], [181, 118, 118, 43, 43, 0]])))
        alignment.target.seq = self.dna
        alignment.query.seq = self.rna[alignment.query.id]
        self.assertTrue(np.array_equal(alignment.substitutions, np.array([[36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0], [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]])))
        self.assertEqual(alignment.substitutions.alphabet, 'ACGTacgt')
        self.assertEqual(str(alignment), 'chr3       42530895 CGGAAGTACTTCTGGGGGTACATACTCATCGGCTGGGGTATGGTACCAGGGAGGGCTTCC\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNR_046654       181 CGGAAGTACTTCTGGGGGTACATACTCATCGGCTGGGGTATGGTACCAGGGAGGGCTTCC\n\nchr3       42530955 AGGCTGGGGACAGAGGGGGCAAGGCCTGGAGAACTCCCTAGGGGGAGGGTGCCAACCCAG\n                 60 |||---------------------------------------------------------\nNR_046654       121 AGG---------------------------------------------------------\n\nchr3       42531015 CTTGCAGTCCTACGTCTTGCTTAGCTGCAGGTCCTGCCTGCAAGGATATCAGCCAAGGGT\n                120 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531075 CAAGAAAGTCCTCAAAATGTCTGATCCCAGGACAAGTCCCTCAGGTTGCAGCTGCACCTA\n                180 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531135 GGGCTGACCTGTGGGACAGATTTTGTGAACATCTTTCCATTTCCCTTTAGTTCCCGAAAT\n                240 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531195 ACAcagggccactgctaatctataaagggcctctgtcacaattagaaagagaatgtccgt\n                300 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531255 ctaggtagacacagcccttcaggcatacagcttCACCCCCTCAGTGGAGCATCCCTCCGT\n                360 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531315 GGTGAACAACCTATGCAACCAAAGACAGCAGACTGACAACCCACCCTTTtctctctccct\n                420 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531375 ccctctccctgcttttctccaaaatctctccctcatgccctctacccctgcttcctgtgc\n                480 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531435 cctctctgctctttcactctccctGGGCCTGACAGGGGTACCCAGCACATTCACCATGGT\n                540 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531495 GTGGACCATCGCCAGGATCCATTTTGAGGATTATGGGTGAGCTGCTGCCCCACACACTCC\n                600 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531555 CCCGGCCGCCATCACTTGGGCAGGCCCCCTGGGTGGGATGATAATGCCATCTGGCCTTGG\n                660 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531615 TGAGTGGACAAAAACCACAGCTCTCGGGCCAGAGGGGAGGCTGGAGGAGGACCTGGGGAG\n                720 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531675 CAACAGACTCTGGGCCCGGGGTTGCTAAAGTGCTCAGGAGCAGAGCTGGGGACAACTGGG\n                780 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531735 GGAGGTGCTGCTGAGTCTCTCTCTGGCTGAGGACAATCCCTCTCATTCCTCCCCACGGTC\n                840 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531795 TGCTCAGGTGCTGGGACACCATCAACTCCTCACTGTGGTGGATCATAAAGGGCCCCATCC\n                900 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531855 TCACCTCCATCTTGGTAAGATaccctcccaccacctagagatggggaaacaggcccaaag\n                960 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531915 ggcaggcaacttagcccaaggtcacatgggaaattagtatctaggtcagaactgaaacgt\n               1020 ------------------------------------------------------------\nNR_046654       118 ------------------------------------------------------------\n\nchr3       42531975 agcttcctaatgcccaatgcaggatcatccccacccctgtcctaccagTTCTTCCTTGAG\n               1080 ---------------------------------------------...||||||||||||\nNR_046654       118 ---------------------------------------------CAGTTCTTCCTTGAG\n\nchr3       42532035 CGTAAGCGGATTGGGAGCACAGTCCTTAGGGATTTGAAGGAGGTAGAGTTCCCGGATGAC\n               1140 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNR_046654       103 CGTAAGCGGATTGGGAGCACAGTCCTTAGGGATTTGAAGGAGGTAGAGTTCCCGGATGAC\n\nchr3       42532095 CTGCCCAAAGGGGAAATGCCAGAGGAGAGGTAAGATAGAGAGAGGGGCAGCAGGACCCTG\n               1200 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532155 GGAAAGAAGACAGGCCAGCAGTCAAGGGGCCTGAACACCTCAGCCTTCCCGCTCTGACTG\n               1260 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532215 CCCGAACTCGGGTCCCCACCCACTAGGTAAACTTCATCCTGTTTATTTGCATCATCCGAA\n               1320 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532275 TCCTGCTTCAGAAACTGCGGCCCCCAGATATCAGGAAGAGTGACAGCAGTCCATACTCGT\n               1380 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532335 GAGTGTGGGCCTAGTGCCTCAGCCCCCAGTACCTCCATCCCCAGTCCTCAAATCATCCCA\n               1440 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532395 CATCTCCTTGAAGTCCTCCCACCCCAAACATCCAGAGTCACCAAAGAGCCACATTGTTCT\n               1500 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532455 TTCCCACCTCCACCATGGCCTGGCTcagcccaccaccatcccctgctccagccccaccct\n               1560 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532515 caCCAGGCTGCACTCAGAGCCCTGCATGCTTCTCCTGCCCACACTCACCTAGCATCCTTC\n               1620 ------------------------------------------------||||||||||||\nNR_046654        43 ------------------------------------------------CTAGCATCCTTC\n\nchr3       42532575 CCAGGTATGCATCTGCTGCCAAGCCAGGgag 42532606\n               1680 ||||||||||||||||||||||||||||...     1711\nNR_046654        31 CCAGGTATGCATCTGCTGCCAAGCCAGGGAG        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr3\t42530895\t42532606\tNR_046654.1\t1000\t-\t42530895\t42532606\t0\t3\t63,75,43,\t0,1125,1668,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 978)
        self.assertEqual(alignment.shape, (2, 1711))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr3')
        self.assertEqual(alignment.query.id, 'NR_046654.1_modified')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[42530895, 42530922, 42530958, 42532020, 42532037, 42532039, 42532095, 42532563, 42532606], [179, 152, 116, 116, 99, 99, 43, 43, 0]])))
        self.assertEqual(str(alignment), 'chr3       42530895 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNR_046654       179 ????????????????????????????????????????????????????????????\n\nchr3       42530955 ????????????????????????????????????????????????????????????\n                 60 |||---------------------------------------------------------\nNR_046654       119 ???---------------------------------------------------------\n\nchr3       42531015 ????????????????????????????????????????????????????????????\n                120 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531075 ????????????????????????????????????????????????????????????\n                180 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531135 ????????????????????????????????????????????????????????????\n                240 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531195 ????????????????????????????????????????????????????????????\n                300 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531255 ????????????????????????????????????????????????????????????\n                360 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531315 ????????????????????????????????????????????????????????????\n                420 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531375 ????????????????????????????????????????????????????????????\n                480 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531435 ????????????????????????????????????????????????????????????\n                540 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531495 ????????????????????????????????????????????????????????????\n                600 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531555 ????????????????????????????????????????????????????????????\n                660 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531615 ????????????????????????????????????????????????????????????\n                720 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531675 ????????????????????????????????????????????????????????????\n                780 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531735 ????????????????????????????????????????????????????????????\n                840 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531795 ????????????????????????????????????????????????????????????\n                900 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531855 ????????????????????????????????????????????????????????????\n                960 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531915 ????????????????????????????????????????????????????????????\n               1020 ------------------------------------------------------------\nNR_046654       116 ------------------------------------------------------------\n\nchr3       42531975 ????????????????????????????????????????????????????????????\n               1080 ---------------------------------------------|||||||||||||||\nNR_046654       116 ---------------------------------------------???????????????\n\nchr3       42532035 ????????????????????????????????????????????????????????????\n               1140 ||--||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNR_046654       101 ??--????????????????????????????????????????????????????????\n\nchr3       42532095 ????????????????????????????????????????????????????????????\n               1200 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532155 ????????????????????????????????????????????????????????????\n               1260 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532215 ????????????????????????????????????????????????????????????\n               1320 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532275 ????????????????????????????????????????????????????????????\n               1380 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532335 ????????????????????????????????????????????????????????????\n               1440 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532395 ????????????????????????????????????????????????????????????\n               1500 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532455 ????????????????????????????????????????????????????????????\n               1560 ------------------------------------------------------------\nNR_046654        43 ------------------------------------------------------------\n\nchr3       42532515 ????????????????????????????????????????????????????????????\n               1620 ------------------------------------------------||||||||||||\nNR_046654        43 ------------------------------------------------????????????\n\nchr3       42532575 ??????????????????????????????? 42532606\n               1680 |||||||||||||||||||||||||||||||     1711\nNR_046654        31 ???????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr3\t42530895\t42532606\tNR_046654.1_modified\t978\t-\t42530895\t42532606\t0\t5\t27,36,17,56,43,\t0,27,1125,1144,1668,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 5407))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr3')
        self.assertEqual(alignment.query.id, 'NR_111921.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[48663767, 48663813, 48665640, 48665722, 48669098, 48669174], [0, 46, 46, 128, 128, 204]])))
        alignment.target.seq = self.dna
        alignment.query.seq = self.rna[alignment.query.id]
        self.assertTrue(np.array_equal(alignment.substitutions, np.array([[53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0], [9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0]])))
        self.assertEqual(alignment.substitutions.alphabet, 'ACGTacgt')
        self.assertEqual(str(alignment), 'chr3       48663767 CACGAGAGGAGCGGAGGCGAGGGGTGAACGCGGAGCACTCCAATCGGTCAGTCATTGTTT\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||--------------\nNR_111921         0 CACGAGAGGAGCGGAGGCGAGGGGTGAACGCGGAGCACTCCAATCG--------------\n\nchr3       48663827 CTATTGGCACAATGGGAGGCCCCGCCCCTCACGGCGGACTCATCGCATGGGGGAGGGGGC\n                 60 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48663887 TCCGCGGGTTGCCGGCTAACCGTGAGAGAGTCCGGGAGGTACACTATACGGACCGGCCTC\n                120 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48663947 CAAAGGCGGAATCGATAACGAGCTGCAGCGCCGGGTGCAGAGGACGCGGGCATCCCGAAG\n                180 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664007 CCCAGGAAGAGGTCAGGGCCGGGACCCCAGAACGCTCCACAGGGTGCGGCTCCCGCGATG\n                240 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664067 GGGTGGATCCTGGTTCTAACAGGCGAGGAACTCCTGGCCAAGGCCTCTGGCCCGCCCCGA\n                300 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664127 ACGGTCCCTATGACATCACCATCAACCAATCAGTCGGCGCATCCTTTCGCCCCTTGACTG\n                360 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664187 CTCCGCTTCCGGGAGGCGGGGCTTCTGCGGGTTCCACCTCCCGAGCGCCCCTTGTGGCTA\n                420 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664247 CCAAGGTCAGGCAACAGGTGTCCAGTTGTTCCCTCTCCTGTCTACGAATCTGAGGACCTC\n                480 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664307 CCCAGGATCAGAGCTCTGGGCCTGATACACGGCCGGGGTTCCTACGGGTTTGTGAGTGGG\n                540 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664367 GGTGGAAGATCTGCAGAGGCACTTAGGGCTGAACTCCTTTGAATGGGAGCCAATCGGTGC\n                600 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664427 AGGGGCTGGAGGAGCGAGTCCCCCAAAGTAGttttatttatctatttagagacaaggtct\n                660 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664487 cactctttcggagtgcagtggtgatcacagctcaccgtagcctcgaactccccaggcgat\n                720 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664547 tctctcacctcagcctcccgagtagctgggactacgggtacatgtcatcacacttggcta\n                780 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664607 atttttgcattttttatagagacagggtctcaccatgtaggccagattagtcttgaactc\n                840 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664667 ctgggctcaagcaatccgcccatcttggcctcccaaagtgctgggattataggtgtgagc\n                900 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664727 caccgcgcccggcAACCCAGAAGTGGTTTTGACAGCAccagcgctttctgtgtccacaat\n                960 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664787 ctagtgagtagagggcacaaaacctgacaccacggaggcagacaggcaggggctctgccg\n               1020 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664847 gggaagggtgttggagtcccaaaggaggcgtctgagtcaccttcgcaacctgggacgcct\n               1080 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664907 tcttgcataagatgcctgagcagtgccttgaatgaccaaggggagatccgcatctgcaaa\n               1140 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48664967 ggaagggcagggagggatagggattgggggtgggcatcctaggtcttggagactgtgtgg\n               1200 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665027 gcaaatgtgcagagacataaagggactatggctgagggaaatcaagCCCTGCCCTCTCAC\n               1260 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665087 CAATAGGGCTGGCGCTGGTCCCAGCTAACACTCCTTTTGGAGAGCAAAGCTCCTCACTTC\n               1320 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665147 TGAGTAGTGAGATTGATTGCGGATCACTCTCCATGTTGCTGCCTGCTGTGTGTCATCCCA\n               1380 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665207 CTGTCATCCTCCCTTTGTGGCTGTTCTGTGGAGCCCCTCTCCCTCAATCTGCACTCACCT\n               1440 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665267 CTATGCCCCAGCCCCATTGGCAGCTCCTAATGCACTCCCGGTaaaaaaaaaaaaacaaaa\n               1500 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665327 aCCAGATGTTAGTGATAGTGGTGGTAGTTCTTCTCTCCACCTCCAAATCTTGCCCTTGCC\n               1560 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665387 TCCTAATAAGACCCCTATGTGGTTTAACCTCAttttttttttttttttttttttttgaga\n               1620 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665447 tggagtttcactctgtcacccaggctggagtgaagtggtgtgatGGGGCTTCACCATGTg\n               1680 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665507 atggggcttcaccatgttggccaggctggtatcaaactcctgacctctagtgatctgccc\n               1740 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665567 gcctcagcctcccaaagtgctgggattaccggcatgaggcaccgtgcccagccTATCCTC\n               1800 ------------------------------------------------------------\nNR_111921        46 ------------------------------------------------------------\n\nchr3       48665627 CTTCTCTTATCAGCTCCCAACTAGAGGTCCACCCAGGACCCAGAGACCTGGATTTGAGGC\n               1860 -------------|||||||||||||||||||||||||||||||||||||||||||||||\nNR_111921        46 -------------CTCCCAACTAGAGGTCCACCCAGGACCCAGAGACCTGGATTTGAGGC\n\nchr3       48665687 TGCTGGGCGGCAGATGGAGCGATCAGAAGACCAGGGTAAGGGTGTGGCAGATACTGCCAC\n               1920 |||||||||||||||||||||||||||||||||||-------------------------\nNR_111921        93 TGCTGGGCGGCAGATGGAGCGATCAGAAGACCAGG-------------------------\n\nchr3       48665747 TAACACTTCTCAGCCTTTCCTTCTCCTGCCTTTTCCACCCCACCCTGTGTTTGTCTACTC\n               1980 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48665807 CCAGCCAGGTGTACCTTTCCAGGGGAAGACCTGGCCAACCTGTCCAGCTCAATTAtccag\n               2040 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48665867 cagttctttgacctcactgagatctcgagtccattgttcatcacctcagctattgacctg\n               2100 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48665927 tgtcattagccttatagagttcagtgccacggaaactccctgccctgttctttttctttt\n               2160 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48665987 tctttttttttttttttttgagacagagccttgctctgtcgcccaggctggagtgcagtg\n               2220 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666047 gcgcgatctcggctcactgcaagctctgcctcccaggttcacaccattctcctgactcag\n               2280 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666107 cctcccgagtagctgggactacaggcgtccaccaccatgcccagctaatttttttttttg\n               2340 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666167 tatttttagtagagacggcgtttcaccgtgttagccaggctggtctcgatctcctgacct\n               2400 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666227 tgtgatgctcccgcctcggcctcccaaagtgctgggattacaggcatgagccattgtgcc\n               2460 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666287 cggcctgccctgttcttcttagacaaacttgctgggctaaaatctaaccccgttaaaata\n               2520 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666347 gactatttacgtattgtttgcctctagcgcagcagaacattgctggagaaaaacaaacaa\n               2580 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666407 ccgtgctaattggtctcattttatattcatgaccacaagcctcagtattatatcggaggg\n               2640 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666467 cctatccagtgcagtagggcaagaaaaataataagttatgaagattggaagggaaaaaaa\n               2700 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666527 actaattcacaagcagtaggattgtatatgtaaaaatttcaaaggaacctataggtaagt\n               2760 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666587 tgttagaatgagttcagcaaagttgttggacacaagatcaatatataaaaatcagttgca\n               2820 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666647 atttctatatgtcaccaacagttagaaaataaatttcttgcctgggcatgttggctcaag\n               2880 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666707 cctgtaatcccagcactttgggtggccaaggcgggcagatcacctgaggtcaggagtttg\n               2940 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666767 agaccagtttggccaacatggtgaaatcccgtctctactaaaaatacagaaattagccgg\n               3000 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666827 gcgtggtggtgggcacctgtagtcccagctactgaggaggctgaggcaggagaatcactt\n               3060 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666887 gaacctgggaggcagaggttgcagtgaacgagaaaaaaaaattttttttcttaaaaacaa\n               3120 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48666947 tgatgtttacaatagcatcaagtaatatcaaatgctgaggaataaacctaatgaaagatg\n               3180 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667007 tgcaaagactacatacacacatacaaaaaaactataaaacattattgagggaaataaaga\n               3240 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667067 cataggcctggcattggtggctcatgcctgaaatctcagcactttggagggccaaggtgg\n               3300 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667127 gtggatcatttgaggtcaggagttagagatcagtccggccaacatggtgaaacctcatct\n               3360 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667187 ctactaaaaatacaaaaaaattagcttggccaggtgcagtggctcacacctgtaatccca\n               3420 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667247 gcactttgggaggctgaggcgggcggatcatgaggtcaggagatcgagaccatcctggct\n               3480 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667307 aacacggtgaaaccctgtctctactaaaaatacaaaaaaaaattagccgggcctgatggc\n               3540 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667367 gggcgcccgtagtcccagctactcgggaggctgaggtagcagaatggcgtgaacctggga\n               3600 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667427 ggtgcagcttgcagtgagcctaaattgcgccactgcactccagcctgggtaacagagcga\n               3660 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667487 gactccgtttcaaaaaaaaaaaaaaaaattagctgggcatgctgttgtgcacctgcaatc\n               3720 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667547 ccagctactctggaggatgaggcagaagtgcctgaacctgggacacagaggttgcagtga\n               3780 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667607 gccaagatcatgccattgcactccagcctggacaacacagccagacgctatctgaaaaaa\n               3840 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667667 aaaaaaaaaaaaaaagtaaaaaaaatgagaaataaagacataaataaagtgaaaaattgt\n               3900 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667727 tccaatattggaaaagtcaatattataaaggtgccaattttcccaaattgatatatggat\n               3960 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667787 tcgatgcaacttcagttaaaaatcccactaaattttggctgggtgcggtggctcacacct\n               4020 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667847 gtaatcccagcactttgggaggctgaggcgggcggatcacaaggtcaggagatcgagacc\n               4080 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667907 atcttggctaacatggtgaaaccgtctctactaaaaatacaaaagttagccgggtgtggt\n               4140 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48667967 ggcgggcacctgtagtcccagctacttgggaggctgagacagaatggcgtgaacctgggg\n               4200 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668027 aggcggagcttgcagtgagccaagttgacgccactgcactccagcctgggcgacagagca\n               4260 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668087 agactctgtctcaaaaaaaaaaaaaaaaaaaTCCCACTAGATTTTGTGTGTGTGTAAACT\n               4320 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668147 GACAAACTAGATTTAGcagcctgagcaacacagcaaaaccccatctctacaaaaaataca\n               4380 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668207 aaaattttgcacatgcctgtatagtcccagctacttgggaggctgaagtgggaggatcat\n               4440 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668267 gtgagctctggggaggtcgaggctgtagtgagctatgatcacatgctgcactctagcctg\n               4500 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668327 ggcaacagagcaagagaccctgtatctaaaaaaagaatgaaaattaaaaaataaaaaGAa\n               4560 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668387 accaagattgtgtggtactggtacgaggataggaagactaaaggaacgaaatccagagac\n               4620 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668447 aggcctgaagatgtgtggaaacttgaattttgacaagggtgGTTCTTCAGAGCTAACATG\n               4680 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668507 AAGAAAGGGTTGTTTTCTTTTTTTTGTTTCCCcaggagcaactctattaactgaaagaat\n               4740 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668567 aggcttttcaataaatgatgctgggtcagttggatatccatatagaaaaaattaaatgag\n               4800 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668627 atctctatttcacactgcttgcataatcaattccatataaatttgacatctgaaaatata\n               4860 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668687 cagtttctagaaaacagtatTAAGACCttgttttgttttttgttgttgttgttttttgtt\n               4920 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668747 ttgttttttgttttttgagacagagtctcgctctgtcgccaggctggaatacagtggtgc\n               4980 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668807 aaccttggctcactgcaacctctgactccctagttcaagcaattctcctgcctcagcctc\n               5040 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668867 ccgagtagctgcgattacaggcacatgccaccacgcccagctaatttttgtatttttagt\n               5100 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668927 agagatgggggtttcaccatgttggccaggatggtctcgatctcctgaccctgtaatccg\n               5160 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48668987 cccacctcggcctcccaaagtgctgggattacaggcgtgagccactgcacctggccAAGA\n               5220 ------------------------------------------------------------\nNR_111921       128 ------------------------------------------------------------\n\nchr3       48669047 GAAGATCTTAAAGGTGACTTTAAGCAAACttttttttttttttttttacagagacgggag\n               5280 ---------------------------------------------------.........\nNR_111921       128 ---------------------------------------------------AGACGGGAG\n\nchr3       48669107 ctggagtgcagtggctgttcacaagcgtgaAAGCAAAGATTAAAAAATTTGTTTTTATAT\n               5340 ..............................||||||||||||||||||||||||||||||\nNR_111921       137 CTGGAGTGCAGTGGCTGTTCACAAGCGTGAAAGCAAAGATTAAAAAATTTGTTTTTATAT\n\nchr3       48669167 TAAAAAA 48669174\n               5400 |||||||     5407\nNR_111921       197 TAAAAAA      204\n')
        self.assertEqual(format(alignment, 'bed'), 'chr3\t48663767\t48669174\tNR_111921.1\t1000\t+\t48663767\t48669174\t0\t3\t46,82,76,\t0,1873,5331,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 972)
        self.assertEqual(alignment.shape, (2, 5407))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr3')
        self.assertEqual(alignment.query.id, 'NR_111921.1_modified')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[48663767, 48663795, 48663796, 48663813, 48665640, 48665716, 48665722, 48669098, 48669174], [0, 28, 28, 45, 45, 121, 127, 127, 203]])))
        self.assertEqual(str(alignment), 'chr3       48663767 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||-|||||||||||||||||--------------\nNR_111921         0 ????????????????????????????-?????????????????--------------\n\nchr3       48663827 ????????????????????????????????????????????????????????????\n                 60 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48663887 ????????????????????????????????????????????????????????????\n                120 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48663947 ????????????????????????????????????????????????????????????\n                180 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664007 ????????????????????????????????????????????????????????????\n                240 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664067 ????????????????????????????????????????????????????????????\n                300 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664127 ????????????????????????????????????????????????????????????\n                360 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664187 ????????????????????????????????????????????????????????????\n                420 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664247 ????????????????????????????????????????????????????????????\n                480 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664307 ????????????????????????????????????????????????????????????\n                540 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664367 ????????????????????????????????????????????????????????????\n                600 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664427 ????????????????????????????????????????????????????????????\n                660 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664487 ????????????????????????????????????????????????????????????\n                720 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664547 ????????????????????????????????????????????????????????????\n                780 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664607 ????????????????????????????????????????????????????????????\n                840 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664667 ????????????????????????????????????????????????????????????\n                900 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664727 ????????????????????????????????????????????????????????????\n                960 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664787 ????????????????????????????????????????????????????????????\n               1020 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664847 ????????????????????????????????????????????????????????????\n               1080 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664907 ????????????????????????????????????????????????????????????\n               1140 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48664967 ????????????????????????????????????????????????????????????\n               1200 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665027 ????????????????????????????????????????????????????????????\n               1260 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665087 ????????????????????????????????????????????????????????????\n               1320 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665147 ????????????????????????????????????????????????????????????\n               1380 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665207 ????????????????????????????????????????????????????????????\n               1440 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665267 ????????????????????????????????????????????????????????????\n               1500 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665327 ????????????????????????????????????????????????????????????\n               1560 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665387 ????????????????????????????????????????????????????????????\n               1620 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665447 ????????????????????????????????????????????????????????????\n               1680 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665507 ????????????????????????????????????????????????????????????\n               1740 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665567 ????????????????????????????????????????????????????????????\n               1800 ------------------------------------------------------------\nNR_111921        45 ------------------------------------------------------------\n\nchr3       48665627 ????????????????????????????????????????????????????????????\n               1860 -------------|||||||||||||||||||||||||||||||||||||||||||||||\nNR_111921        45 -------------???????????????????????????????????????????????\n\nchr3       48665687 ????????????????????????????????????????????????????????????\n               1920 |||||||||||||||||||||||||||||||||||-------------------------\nNR_111921        92 ???????????????????????????????????-------------------------\n\nchr3       48665747 ????????????????????????????????????????????????????????????\n               1980 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48665807 ????????????????????????????????????????????????????????????\n               2040 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48665867 ????????????????????????????????????????????????????????????\n               2100 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48665927 ????????????????????????????????????????????????????????????\n               2160 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48665987 ????????????????????????????????????????????????????????????\n               2220 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666047 ????????????????????????????????????????????????????????????\n               2280 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666107 ????????????????????????????????????????????????????????????\n               2340 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666167 ????????????????????????????????????????????????????????????\n               2400 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666227 ????????????????????????????????????????????????????????????\n               2460 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666287 ????????????????????????????????????????????????????????????\n               2520 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666347 ????????????????????????????????????????????????????????????\n               2580 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666407 ????????????????????????????????????????????????????????????\n               2640 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666467 ????????????????????????????????????????????????????????????\n               2700 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666527 ????????????????????????????????????????????????????????????\n               2760 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666587 ????????????????????????????????????????????????????????????\n               2820 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666647 ????????????????????????????????????????????????????????????\n               2880 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666707 ????????????????????????????????????????????????????????????\n               2940 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666767 ????????????????????????????????????????????????????????????\n               3000 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666827 ????????????????????????????????????????????????????????????\n               3060 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666887 ????????????????????????????????????????????????????????????\n               3120 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48666947 ????????????????????????????????????????????????????????????\n               3180 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667007 ????????????????????????????????????????????????????????????\n               3240 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667067 ????????????????????????????????????????????????????????????\n               3300 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667127 ????????????????????????????????????????????????????????????\n               3360 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667187 ????????????????????????????????????????????????????????????\n               3420 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667247 ????????????????????????????????????????????????????????????\n               3480 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667307 ????????????????????????????????????????????????????????????\n               3540 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667367 ????????????????????????????????????????????????????????????\n               3600 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667427 ????????????????????????????????????????????????????????????\n               3660 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667487 ????????????????????????????????????????????????????????????\n               3720 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667547 ????????????????????????????????????????????????????????????\n               3780 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667607 ????????????????????????????????????????????????????????????\n               3840 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667667 ????????????????????????????????????????????????????????????\n               3900 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667727 ????????????????????????????????????????????????????????????\n               3960 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667787 ????????????????????????????????????????????????????????????\n               4020 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667847 ????????????????????????????????????????????????????????????\n               4080 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667907 ????????????????????????????????????????????????????????????\n               4140 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48667967 ????????????????????????????????????????????????????????????\n               4200 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668027 ????????????????????????????????????????????????????????????\n               4260 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668087 ????????????????????????????????????????????????????????????\n               4320 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668147 ????????????????????????????????????????????????????????????\n               4380 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668207 ????????????????????????????????????????????????????????????\n               4440 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668267 ????????????????????????????????????????????????????????????\n               4500 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668327 ????????????????????????????????????????????????????????????\n               4560 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668387 ????????????????????????????????????????????????????????????\n               4620 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668447 ????????????????????????????????????????????????????????????\n               4680 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668507 ????????????????????????????????????????????????????????????\n               4740 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668567 ????????????????????????????????????????????????????????????\n               4800 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668627 ????????????????????????????????????????????????????????????\n               4860 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668687 ????????????????????????????????????????????????????????????\n               4920 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668747 ????????????????????????????????????????????????????????????\n               4980 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668807 ????????????????????????????????????????????????????????????\n               5040 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668867 ????????????????????????????????????????????????????????????\n               5100 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668927 ????????????????????????????????????????????????????????????\n               5160 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48668987 ????????????????????????????????????????????????????????????\n               5220 ------------------------------------------------------------\nNR_111921       127 ------------------------------------------------------------\n\nchr3       48669047 ????????????????????????????????????????????????????????????\n               5280 ---------------------------------------------------|||||||||\nNR_111921       127 ---------------------------------------------------?????????\n\nchr3       48669107 ????????????????????????????????????????????????????????????\n               5340 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNR_111921       136 ????????????????????????????????????????????????????????????\n\nchr3       48669167 ??????? 48669174\n               5400 |||||||     5407\nNR_111921       196 ???????      203\n')
        self.assertEqual(format(alignment, 'bed'), 'chr3\t48663767\t48669174\tNR_111921.1_modified\t972\t+\t48663767\t48669174\t0\t5\t28,17,76,6,76,\t0,29,1873,1949,5331,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_reading(self):
        if False:
            print('Hello World!')
        'Test parsing dna_rna.bed.'
        path = 'Blat/dna_rna.bed'
        alignments = Align.parse(path, 'bed')
        self.check_alignments(alignments)
        alignments.rewind()
        self.check_alignments(alignments)
        with Align.parse(path, 'bed') as alignments:
            self.check_alignments(alignments)
        with self.assertRaises(AttributeError):
            alignments._stream
        with Align.parse(path, 'bed') as alignments:
            pass
        with self.assertRaises(AttributeError):
            alignments._stream

    def test_writing(self):
        if False:
            for i in range(10):
                print('nop')
        'Test writing the alignments in dna_rna.bed.'
        path = 'Blat/dna_rna.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 4)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

class TestAlign_dna(unittest.TestCase):

    def test_reading_psl_34_001(self):
        if False:
            for i in range(10):
                print('nop')
        'Test parsing psl_34_001.bed.'
        path = 'Blat/psl_34_001.bed'
        alignments = Align.parse(path, 'bed')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 16))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[61646095, 61646111], [0, 16]])))
        self.assertEqual(str(alignment), 'chr4       61646095 ???????????????? 61646111\n                  0 ||||||||||||||||       16\nhg19_dna          0 ????????????????       16\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t61646095\t61646111\thg19_dna\t1000\t+\t61646095\t61646111\t0\t1\t16,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 33))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[10271783, 10271816], [0, 33]])))
        self.assertEqual(str(alignment), 'chr1       10271783 ????????????????????????????????? 10271816\n                  0 |||||||||||||||||||||||||||||||||       33\nhg19_dna          0 ?????????????????????????????????       33\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t10271783\t10271816\thg19_dna\t1000\t+\t10271783\t10271816\t0\t1\t33,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 17))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[53575980, 53575997], [17, 0]])))
        self.assertEqual(str(alignment), 'chr2       53575980 ????????????????? 53575997\n                  0 |||||||||||||||||       17\nhg19_dna         17 ?????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t53575980\t53575997\thg19_dna\t1000\t-\t53575980\t53575997\t0\t1\t17,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 854)
        self.assertEqual(alignment.shape, (2, 41))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr9')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[85737865, 85737906], [0, 41]])))
        self.assertEqual(str(alignment), 'chr9       85737865 ????????????????????????????????????????? 85737906\n                  0 |||||||||||||||||||||||||||||||||||||||||       41\nhg19_dna          0 ?????????????????????????????????????????       41\n')
        self.assertEqual(format(alignment, 'bed'), 'chr9\t85737865\t85737906\thg19_dna\t854\t+\t85737865\t85737906\t0\t1\t41,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 41))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr8')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[95160479, 95160520], [0, 41]])))
        self.assertEqual(str(alignment), 'chr8       95160479 ????????????????????????????????????????? 95160520\n                  0 |||||||||||||||||||||||||||||||||||||||||       41\nhg19_dna          0 ?????????????????????????????????????????       41\n')
        self.assertEqual(format(alignment, 'bed'), 'chr8\t95160479\t95160520\thg19_dna\t1000\t+\t95160479\t95160520\t0\t1\t41,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 834)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr22')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[42144400, 42144436], [0, 36]])))
        self.assertEqual(str(alignment), 'chr22      42144400 ???????????????????????????????????? 42144436\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna          0 ????????????????????????????????????       36\n')
        self.assertEqual(format(alignment, 'bed'), 'chr22\t42144400\t42144436\thg19_dna\t834\t+\t42144400\t42144436\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 682)
        self.assertEqual(alignment.shape, (2, 44))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[183925984, 183925990, 183926028], [0, 6, 44]])))
        self.assertEqual(str(alignment), 'chr2      183925984 ???????????????????????????????????????????? 183926028\n                  0 ||||||||||||||||||||||||||||||||||||||||||||        44\nhg19_dna          0 ????????????????????????????????????????????        44\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t183925984\t183926028\thg19_dna\t682\t+\t183925984\t183926028\t0\t2\t6,38,\t0,6,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 890)
        self.assertEqual(alignment.shape, (2, 170))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[35483340, 35483365, 35483499, 35483510], [0, 25, 25, 36]])))
        self.assertEqual(str(alignment), 'chr19      35483340 ????????????????????????????????????????????????????????????\n                  0 |||||||||||||||||||||||||-----------------------------------\nhg19_dna          0 ?????????????????????????-----------------------------------\n\nchr19      35483400 ????????????????????????????????????????????????????????????\n                 60 ------------------------------------------------------------\nhg19_dna         25 ------------------------------------------------------------\n\nchr19      35483460 ?????????????????????????????????????????????????? 35483510\n                120 ---------------------------------------|||||||||||      170\nhg19_dna         25 ---------------------------------------???????????       36\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t35483340\t35483510\thg19_dna\t890\t+\t35483340\t35483510\t0\t2\t25,11,\t0,159,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr18')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[23891310, 23891349], [0, 39]])))
        self.assertEqual(str(alignment), 'chr18      23891310 ??????????????????????????????????????? 23891349\n                  0 |||||||||||||||||||||||||||||||||||||||       39\nhg19_dna          0 ???????????????????????????????????????       39\n')
        self.assertEqual(format(alignment, 'bed'), 'chr18\t23891310\t23891349\thg19_dna\t1000\t+\t23891310\t23891349\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 930)
        self.assertEqual(alignment.shape, (2, 28))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr18')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[43252217, 43252245], [0, 28]])))
        self.assertEqual(str(alignment), 'chr18      43252217 ???????????????????????????? 43252245\n                  0 ||||||||||||||||||||||||||||       28\nhg19_dna          0 ????????????????????????????       28\n')
        self.assertEqual(format(alignment, 'bed'), 'chr18\t43252217\t43252245\thg19_dna\t930\t+\t43252217\t43252245\t0\t1\t28,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 912)
        self.assertEqual(alignment.shape, (2, 51))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[52759147, 52759154, 52759160, 52759198], [0, 7, 7, 45]])))
        self.assertEqual(str(alignment), 'chr13      52759147 ??????????????????????????????????????????????????? 52759198\n                  0 |||||||------||||||||||||||||||||||||||||||||||||||       51\nhg19_dna          0 ???????------??????????????????????????????????????       45\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t52759147\t52759198\thg19_dna\t912\t+\t52759147\t52759198\t0\t2\t7,38,\t0,13,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 50))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[1207056, 1207106], [0, 50]])))
        self.assertEqual(str(alignment), 'chr1        1207056 ?????????????????????????????????????????????????? 1207106\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||      50\nhg19_dna          0 ??????????????????????????????????????????????????      50\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t1207056\t1207106\thg19_dna\t1000\t+\t1207056\t1207106\t0\t1\t50,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 824)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[61700837, 61700871], [0, 34]])))
        self.assertEqual(str(alignment), 'chr1       61700837 ?????????????????????????????????? 61700871\n                  0 ||||||||||||||||||||||||||||||||||       34\nhg19_dna          0 ??????????????????????????????????       34\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t61700837\t61700871\thg19_dna\t824\t+\t61700837\t61700871\t0\t1\t34,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 572)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[37558157, 37558167, 37558173, 37558191], [28, 18, 18, 0]])))
        self.assertEqual(str(alignment), 'chr4       37558157 ?????????????????????????????????? 37558191\n                  0 ||||||||||------||||||||||||||||||       34\nhg19_dna         28 ??????????------??????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t37558157\t37558191\thg19_dna\t572\t-\t37558157\t37558191\t0\t2\t10,18,\t0,16,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 892)
        self.assertEqual(alignment.shape, (2, 37))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr22')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[48997405, 48997442], [37, 0]])))
        self.assertEqual(str(alignment), 'chr22      48997405 ????????????????????????????????????? 48997442\n                  0 |||||||||||||||||||||||||||||||||||||       37\nhg19_dna         37 ?????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr22\t48997405\t48997442\thg19_dna\t892\t-\t48997405\t48997442\t0\t1\t37,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 946)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[120641740, 120641776], [36, 0]])))
        self.assertEqual(str(alignment), 'chr2      120641740 ???????????????????????????????????? 120641776\n                  0 ||||||||||||||||||||||||||||||||||||        36\nhg19_dna         36 ????????????????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t120641740\t120641776\thg19_dna\t946\t-\t120641740\t120641776\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[54017130, 54017169], [39, 0]])))
        self.assertEqual(str(alignment), 'chr19      54017130 ??????????????????????????????????????? 54017169\n                  0 |||||||||||||||||||||||||||||||||||||||       39\nhg19_dna         39 ???????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t54017130\t54017169\thg19_dna\t1000\t-\t54017130\t54017169\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 848)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[553742, 553781], [39, 0]])))
        self.assertEqual(str(alignment), 'chr19        553742 ??????????????????????????????????????? 553781\n                  0 |||||||||||||||||||||||||||||||||||||||     39\nhg19_dna         39 ???????????????????????????????????????      0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t553742\t553781\thg19_dna\t848\t-\t553742\t553781\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 834)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr10')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[99388555, 99388591], [36, 0]])))
        self.assertEqual(str(alignment), 'chr10      99388555 ???????????????????????????????????? 99388591\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna         36 ????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr10\t99388555\t99388591\thg19_dna\t834\t-\t99388555\t99388591\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 920)
        self.assertEqual(alignment.shape, (2, 25))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr10')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[112178171, 112178196], [25, 0]])))
        self.assertEqual(str(alignment), 'chr10     112178171 ????????????????????????? 112178196\n                  0 |||||||||||||||||||||||||        25\nhg19_dna         25 ?????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr10\t112178171\t112178196\thg19_dna\t920\t-\t112178171\t112178196\t0\t1\t25,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 946)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[39368490, 39368526], [36, 0]])))
        self.assertEqual(str(alignment), 'chr1       39368490 ???????????????????????????????????? 39368526\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna         36 ????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t39368490\t39368526\thg19_dna\t946\t-\t39368490\t39368526\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 942)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[220325687, 220325721], [34, 0]])))
        self.assertEqual(str(alignment), 'chr1      220325687 ?????????????????????????????????? 220325721\n                  0 ||||||||||||||||||||||||||||||||||        34\nhg19_dna         34 ??????????????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t220325687\t220325721\thg19_dna\t942\t-\t220325687\t220325721\t0\t1\t34,\t0,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_writing_psl_34_001(self):
        if False:
            while True:
                i = 10
        'Test writing the alignments in psl_34_001.bed.'
        path = 'Blat/psl_34_001.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 22)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

    def test_reading_psl_34_003(self):
        if False:
            while True:
                i = 10
        'Test parsing psl_34_003.bed.'
        path = 'Blat/psl_34_003.bed'
        alignments = Align.parse(path, 'bed')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 16))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'hg18_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[61646095, 61646111], [0, 16]])))
        self.assertEqual(str(alignment), 'chr4       61646095 ???????????????? 61646111\n                  0 ||||||||||||||||       16\nhg18_dna          0 ????????????????       16\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t61646095\t61646111\thg18_dna\t1000\t+\t61646095\t61646111\t0\t1\t16,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 33))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg18_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[10271783, 10271816], [0, 33]])))
        self.assertEqual(str(alignment), 'chr1       10271783 ????????????????????????????????? 10271816\n                  0 |||||||||||||||||||||||||||||||||       33\nhg18_dna          0 ?????????????????????????????????       33\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t10271783\t10271816\thg18_dna\t1000\t+\t10271783\t10271816\t0\t1\t33,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 17))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg18_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[53575980, 53575997], [17, 0]])))
        self.assertEqual(str(alignment), 'chr2       53575980 ????????????????? 53575997\n                  0 |||||||||||||||||       17\nhg18_dna         17 ?????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t53575980\t53575997\thg18_dna\t1000\t-\t53575980\t53575997\t0\t1\t17,\t0,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_writing_psl_34_003(self):
        if False:
            return 10
        'Test writing the alignments in psl_34_003.bed.'
        path = 'Blat/psl_34_003.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 3)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

    def test_reading_psl_34_004(self):
        if False:
            while True:
                i = 10
        'Test parsing psl_34_004.bed.'
        path = 'Blat/psl_34_004.bed'
        alignments = Align.parse(path, 'bed')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 854)
        self.assertEqual(alignment.shape, (2, 41))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr9')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[85737865, 85737906], [0, 41]])))
        self.assertEqual(str(alignment), 'chr9       85737865 ????????????????????????????????????????? 85737906\n                  0 |||||||||||||||||||||||||||||||||||||||||       41\nhg19_dna          0 ?????????????????????????????????????????       41\n')
        self.assertEqual(format(alignment, 'bed'), 'chr9\t85737865\t85737906\thg19_dna\t854\t+\t85737865\t85737906\t0\t1\t41,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 41))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr8')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[95160479, 95160520], [0, 41]])))
        self.assertEqual(str(alignment), 'chr8       95160479 ????????????????????????????????????????? 95160520\n                  0 |||||||||||||||||||||||||||||||||||||||||       41\nhg19_dna          0 ?????????????????????????????????????????       41\n')
        self.assertEqual(format(alignment, 'bed'), 'chr8\t95160479\t95160520\thg19_dna\t1000\t+\t95160479\t95160520\t0\t1\t41,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 834)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr22')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[42144400, 42144436], [0, 36]])))
        self.assertEqual(str(alignment), 'chr22      42144400 ???????????????????????????????????? 42144436\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna          0 ????????????????????????????????????       36\n')
        self.assertEqual(format(alignment, 'bed'), 'chr22\t42144400\t42144436\thg19_dna\t834\t+\t42144400\t42144436\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 682)
        self.assertEqual(alignment.shape, (2, 44))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[183925984, 183925990, 183926028], [0, 6, 44]])))
        self.assertEqual(str(alignment), 'chr2      183925984 ???????????????????????????????????????????? 183926028\n                  0 ||||||||||||||||||||||||||||||||||||||||||||        44\nhg19_dna          0 ????????????????????????????????????????????        44\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t183925984\t183926028\thg19_dna\t682\t+\t183925984\t183926028\t0\t2\t6,38,\t0,6,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 890)
        self.assertEqual(alignment.shape, (2, 170))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[35483340, 35483365, 35483499, 35483510], [0, 25, 25, 36]])))
        self.assertEqual(str(alignment), 'chr19      35483340 ????????????????????????????????????????????????????????????\n                  0 |||||||||||||||||||||||||-----------------------------------\nhg19_dna          0 ?????????????????????????-----------------------------------\n\nchr19      35483400 ????????????????????????????????????????????????????????????\n                 60 ------------------------------------------------------------\nhg19_dna         25 ------------------------------------------------------------\n\nchr19      35483460 ?????????????????????????????????????????????????? 35483510\n                120 ---------------------------------------|||||||||||      170\nhg19_dna         25 ---------------------------------------???????????       36\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t35483340\t35483510\thg19_dna\t890\t+\t35483340\t35483510\t0\t2\t25,11,\t0,159,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr18')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[23891310, 23891349], [0, 39]])))
        self.assertEqual(str(alignment), 'chr18      23891310 ??????????????????????????????????????? 23891349\n                  0 |||||||||||||||||||||||||||||||||||||||       39\nhg19_dna          0 ???????????????????????????????????????       39\n')
        self.assertEqual(format(alignment, 'bed'), 'chr18\t23891310\t23891349\thg19_dna\t1000\t+\t23891310\t23891349\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 930)
        self.assertEqual(alignment.shape, (2, 28))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr18')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[43252217, 43252245], [0, 28]])))
        self.assertEqual(str(alignment), 'chr18      43252217 ???????????????????????????? 43252245\n                  0 ||||||||||||||||||||||||||||       28\nhg19_dna          0 ????????????????????????????       28\n')
        self.assertEqual(format(alignment, 'bed'), 'chr18\t43252217\t43252245\thg19_dna\t930\t+\t43252217\t43252245\t0\t1\t28,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 912)
        self.assertEqual(alignment.shape, (2, 51))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[52759147, 52759154, 52759160, 52759198], [0, 7, 7, 45]])))
        self.assertEqual(str(alignment), 'chr13      52759147 ??????????????????????????????????????????????????? 52759198\n                  0 |||||||------||||||||||||||||||||||||||||||||||||||       51\nhg19_dna          0 ???????------??????????????????????????????????????       45\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t52759147\t52759198\thg19_dna\t912\t+\t52759147\t52759198\t0\t2\t7,38,\t0,13,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 50))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[1207056, 1207106], [0, 50]])))
        self.assertEqual(str(alignment), 'chr1        1207056 ?????????????????????????????????????????????????? 1207106\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||      50\nhg19_dna          0 ??????????????????????????????????????????????????      50\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t1207056\t1207106\thg19_dna\t1000\t+\t1207056\t1207106\t0\t1\t50,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 824)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[61700837, 61700871], [0, 34]])))
        self.assertEqual(str(alignment), 'chr1       61700837 ?????????????????????????????????? 61700871\n                  0 ||||||||||||||||||||||||||||||||||       34\nhg19_dna          0 ??????????????????????????????????       34\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t61700837\t61700871\thg19_dna\t824\t+\t61700837\t61700871\t0\t1\t34,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 572)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[37558157, 37558167, 37558173, 37558191], [28, 18, 18, 0]])))
        self.assertEqual(str(alignment), 'chr4       37558157 ?????????????????????????????????? 37558191\n                  0 ||||||||||------||||||||||||||||||       34\nhg19_dna         28 ??????????------??????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t37558157\t37558191\thg19_dna\t572\t-\t37558157\t37558191\t0\t2\t10,18,\t0,16,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 892)
        self.assertEqual(alignment.shape, (2, 37))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr22')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[48997405, 48997442], [37, 0]])))
        self.assertEqual(str(alignment), 'chr22      48997405 ????????????????????????????????????? 48997442\n                  0 |||||||||||||||||||||||||||||||||||||       37\nhg19_dna         37 ?????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr22\t48997405\t48997442\thg19_dna\t892\t-\t48997405\t48997442\t0\t1\t37,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 946)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[120641740, 120641776], [36, 0]])))
        self.assertEqual(str(alignment), 'chr2      120641740 ???????????????????????????????????? 120641776\n                  0 ||||||||||||||||||||||||||||||||||||        36\nhg19_dna         36 ????????????????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t120641740\t120641776\thg19_dna\t946\t-\t120641740\t120641776\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[54017130, 54017169], [39, 0]])))
        self.assertEqual(str(alignment), 'chr19      54017130 ??????????????????????????????????????? 54017169\n                  0 |||||||||||||||||||||||||||||||||||||||       39\nhg19_dna         39 ???????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t54017130\t54017169\thg19_dna\t1000\t-\t54017130\t54017169\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 848)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[553742, 553781], [39, 0]])))
        self.assertEqual(str(alignment), 'chr19        553742 ??????????????????????????????????????? 553781\n                  0 |||||||||||||||||||||||||||||||||||||||     39\nhg19_dna         39 ???????????????????????????????????????      0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t553742\t553781\thg19_dna\t848\t-\t553742\t553781\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 834)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr10')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[99388555, 99388591], [36, 0]])))
        self.assertEqual(str(alignment), 'chr10      99388555 ???????????????????????????????????? 99388591\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna         36 ????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr10\t99388555\t99388591\thg19_dna\t834\t-\t99388555\t99388591\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 920)
        self.assertEqual(alignment.shape, (2, 25))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr10')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[112178171, 112178196], [25, 0]])))
        self.assertEqual(str(alignment), 'chr10     112178171 ????????????????????????? 112178196\n                  0 |||||||||||||||||||||||||        25\nhg19_dna         25 ?????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr10\t112178171\t112178196\thg19_dna\t920\t-\t112178171\t112178196\t0\t1\t25,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 946)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[39368490, 39368526], [36, 0]])))
        self.assertEqual(str(alignment), 'chr1       39368490 ???????????????????????????????????? 39368526\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna         36 ????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t39368490\t39368526\thg19_dna\t946\t-\t39368490\t39368526\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 942)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[220325687, 220325721], [34, 0]])))
        self.assertEqual(str(alignment), 'chr1      220325687 ?????????????????????????????????? 220325721\n                  0 ||||||||||||||||||||||||||||||||||        34\nhg19_dna         34 ??????????????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t220325687\t220325721\thg19_dna\t942\t-\t220325687\t220325721\t0\t1\t34,\t0,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_writing_psl_34_004(self):
        if False:
            i = 10
            return i + 15
        'Test writing the alignments in psl_34_004.bed.'
        path = 'Blat/psl_34_004.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 19)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

    def test_reading_psl_34_005(self):
        if False:
            print('Hello World!')
        'Test parsing psl_34_005.bed.'
        path = 'Blat/psl_34_005.bed'
        alignments = Align.parse(path, 'bed')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 16))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[61646095, 61646111], [0, 16]])))
        self.assertEqual(str(alignment), 'chr4       61646095 ???????????????? 61646111\n                  0 ||||||||||||||||       16\nhg19_dna          0 ????????????????       16\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t61646095\t61646111\thg19_dna\t1000\t+\t61646095\t61646111\t0\t1\t16,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 33))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[10271783, 10271816], [0, 33]])))
        self.assertEqual(str(alignment), 'chr1       10271783 ????????????????????????????????? 10271816\n                  0 |||||||||||||||||||||||||||||||||       33\nhg19_dna          0 ?????????????????????????????????       33\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t10271783\t10271816\thg19_dna\t1000\t+\t10271783\t10271816\t0\t1\t33,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 17))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[53575980, 53575997], [17, 0]])))
        self.assertEqual(str(alignment), 'chr2       53575980 ????????????????? 53575997\n                  0 |||||||||||||||||       17\nhg19_dna         17 ?????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t53575980\t53575997\thg19_dna\t1000\t-\t53575980\t53575997\t0\t1\t17,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 854)
        self.assertEqual(alignment.shape, (2, 41))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr9')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[85737865, 85737906], [0, 41]])))
        self.assertEqual(str(alignment), 'chr9       85737865 ????????????????????????????????????????? 85737906\n                  0 |||||||||||||||||||||||||||||||||||||||||       41\nhg19_dna          0 ?????????????????????????????????????????       41\n')
        self.assertEqual(format(alignment, 'bed'), 'chr9\t85737865\t85737906\thg19_dna\t854\t+\t85737865\t85737906\t0\t1\t41,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 41))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr8')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[95160479, 95160520], [0, 41]])))
        self.assertEqual(str(alignment), 'chr8       95160479 ????????????????????????????????????????? 95160520\n                  0 |||||||||||||||||||||||||||||||||||||||||       41\nhg19_dna          0 ?????????????????????????????????????????       41\n')
        self.assertEqual(format(alignment, 'bed'), 'chr8\t95160479\t95160520\thg19_dna\t1000\t+\t95160479\t95160520\t0\t1\t41,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 834)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr22')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[42144400, 42144436], [0, 36]])))
        self.assertEqual(str(alignment), 'chr22      42144400 ???????????????????????????????????? 42144436\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna          0 ????????????????????????????????????       36\n')
        self.assertEqual(format(alignment, 'bed'), 'chr22\t42144400\t42144436\thg19_dna\t834\t+\t42144400\t42144436\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 682)
        self.assertEqual(alignment.shape, (2, 44))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[183925984, 183925990, 183926028], [0, 6, 44]])))
        self.assertEqual(str(alignment), 'chr2      183925984 ???????????????????????????????????????????? 183926028\n                  0 ||||||||||||||||||||||||||||||||||||||||||||        44\nhg19_dna          0 ????????????????????????????????????????????        44\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t183925984\t183926028\thg19_dna\t682\t+\t183925984\t183926028\t0\t2\t6,38,\t0,6,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 890)
        self.assertEqual(alignment.shape, (2, 170))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[35483340, 35483365, 35483499, 35483510], [0, 25, 25, 36]])))
        self.assertEqual(str(alignment), 'chr19      35483340 ????????????????????????????????????????????????????????????\n                  0 |||||||||||||||||||||||||-----------------------------------\nhg19_dna          0 ?????????????????????????-----------------------------------\n\nchr19      35483400 ????????????????????????????????????????????????????????????\n                 60 ------------------------------------------------------------\nhg19_dna         25 ------------------------------------------------------------\n\nchr19      35483460 ?????????????????????????????????????????????????? 35483510\n                120 ---------------------------------------|||||||||||      170\nhg19_dna         25 ---------------------------------------???????????       36\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t35483340\t35483510\thg19_dna\t890\t+\t35483340\t35483510\t0\t2\t25,11,\t0,159,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr18')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[23891310, 23891349], [0, 39]])))
        self.assertEqual(str(alignment), 'chr18      23891310 ??????????????????????????????????????? 23891349\n                  0 |||||||||||||||||||||||||||||||||||||||       39\nhg19_dna          0 ???????????????????????????????????????       39\n')
        self.assertEqual(format(alignment, 'bed'), 'chr18\t23891310\t23891349\thg19_dna\t1000\t+\t23891310\t23891349\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 930)
        self.assertEqual(alignment.shape, (2, 28))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr18')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[43252217, 43252245], [0, 28]])))
        self.assertEqual(str(alignment), 'chr18      43252217 ???????????????????????????? 43252245\n                  0 ||||||||||||||||||||||||||||       28\nhg19_dna          0 ????????????????????????????       28\n')
        self.assertEqual(format(alignment, 'bed'), 'chr18\t43252217\t43252245\thg19_dna\t930\t+\t43252217\t43252245\t0\t1\t28,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 912)
        self.assertEqual(alignment.shape, (2, 51))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[52759147, 52759154, 52759160, 52759198], [0, 7, 7, 45]])))
        self.assertEqual(str(alignment), 'chr13      52759147 ??????????????????????????????????????????????????? 52759198\n                  0 |||||||------||||||||||||||||||||||||||||||||||||||       51\nhg19_dna          0 ???????------??????????????????????????????????????       45\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t52759147\t52759198\thg19_dna\t912\t+\t52759147\t52759198\t0\t2\t7,38,\t0,13,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 50))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[1207056, 1207106], [0, 50]])))
        self.assertEqual(str(alignment), 'chr1        1207056 ?????????????????????????????????????????????????? 1207106\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||      50\nhg19_dna          0 ??????????????????????????????????????????????????      50\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t1207056\t1207106\thg19_dna\t1000\t+\t1207056\t1207106\t0\t1\t50,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 824)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[61700837, 61700871], [0, 34]])))
        self.assertEqual(str(alignment), 'chr1       61700837 ?????????????????????????????????? 61700871\n                  0 ||||||||||||||||||||||||||||||||||       34\nhg19_dna          0 ??????????????????????????????????       34\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t61700837\t61700871\thg19_dna\t824\t+\t61700837\t61700871\t0\t1\t34,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 572)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[37558157, 37558167, 37558173, 37558191], [28, 18, 18, 0]])))
        self.assertEqual(str(alignment), 'chr4       37558157 ?????????????????????????????????? 37558191\n                  0 ||||||||||------||||||||||||||||||       34\nhg19_dna         28 ??????????------??????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t37558157\t37558191\thg19_dna\t572\t-\t37558157\t37558191\t0\t2\t10,18,\t0,16,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 892)
        self.assertEqual(alignment.shape, (2, 37))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr22')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[48997405, 48997442], [37, 0]])))
        self.assertEqual(str(alignment), 'chr22      48997405 ????????????????????????????????????? 48997442\n                  0 |||||||||||||||||||||||||||||||||||||       37\nhg19_dna         37 ?????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr22\t48997405\t48997442\thg19_dna\t892\t-\t48997405\t48997442\t0\t1\t37,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 946)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[120641740, 120641776], [36, 0]])))
        self.assertEqual(str(alignment), 'chr2      120641740 ???????????????????????????????????? 120641776\n                  0 ||||||||||||||||||||||||||||||||||||        36\nhg19_dna         36 ????????????????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr2\t120641740\t120641776\thg19_dna\t946\t-\t120641740\t120641776\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[54017130, 54017169], [39, 0]])))
        self.assertEqual(str(alignment), 'chr19      54017130 ??????????????????????????????????????? 54017169\n                  0 |||||||||||||||||||||||||||||||||||||||       39\nhg19_dna         39 ???????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t54017130\t54017169\thg19_dna\t1000\t-\t54017130\t54017169\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 848)
        self.assertEqual(alignment.shape, (2, 39))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr19')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[553742, 553781], [39, 0]])))
        self.assertEqual(str(alignment), 'chr19        553742 ??????????????????????????????????????? 553781\n                  0 |||||||||||||||||||||||||||||||||||||||     39\nhg19_dna         39 ???????????????????????????????????????      0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr19\t553742\t553781\thg19_dna\t848\t-\t553742\t553781\t0\t1\t39,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 834)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr10')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[99388555, 99388591], [36, 0]])))
        self.assertEqual(str(alignment), 'chr10      99388555 ???????????????????????????????????? 99388591\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna         36 ????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr10\t99388555\t99388591\thg19_dna\t834\t-\t99388555\t99388591\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 920)
        self.assertEqual(alignment.shape, (2, 25))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr10')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[112178171, 112178196], [25, 0]])))
        self.assertEqual(str(alignment), 'chr10     112178171 ????????????????????????? 112178196\n                  0 |||||||||||||||||||||||||        25\nhg19_dna         25 ?????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr10\t112178171\t112178196\thg19_dna\t920\t-\t112178171\t112178196\t0\t1\t25,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 946)
        self.assertEqual(alignment.shape, (2, 36))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[39368490, 39368526], [36, 0]])))
        self.assertEqual(str(alignment), 'chr1       39368490 ???????????????????????????????????? 39368526\n                  0 ||||||||||||||||||||||||||||||||||||       36\nhg19_dna         36 ????????????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t39368490\t39368526\thg19_dna\t946\t-\t39368490\t39368526\t0\t1\t36,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 942)
        self.assertEqual(alignment.shape, (2, 34))
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'hg19_dna')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[220325687, 220325721], [34, 0]])))
        self.assertEqual(str(alignment), 'chr1      220325687 ?????????????????????????????????? 220325721\n                  0 ||||||||||||||||||||||||||||||||||        34\nhg19_dna         34 ??????????????????????????????????         0\n')
        self.assertEqual(format(alignment, 'bed'), 'chr1\t220325687\t220325721\thg19_dna\t942\t-\t220325687\t220325721\t0\t1\t34,\t0,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_writing_psl_34_005(self):
        if False:
            while True:
                i = 10
        'Test writing the alignments in psl_34_005.bed.'
        path = 'Blat/psl_34_005.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 22)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

class TestAlign_dnax_prot(unittest.TestCase):

    def test_reading_psl_35_001(self):
        if False:
            i = 10
            return i + 15
        'Test parsing psl_35_001.bed.'
        path = 'Blat/psl_35_001.bed'
        alignments = Align.parse(path, 'bed')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[75566694, 75566850], [0, 156]])))
        self.assertEqual(str(alignment), 'chr13      75566694 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nchr13      75566754 ????????????????????????????????????????????????????????????\n                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        60 ????????????????????????????????????????????????????????????\n\nchr13      75566814 ???????????????????????????????????? 75566850\n                120 ||||||||||||||||||||||||||||||||||||      156\nCAG33136.       120 ????????????????????????????????????      156\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t75566694\t75566850\tCAG33136.1\t1000\t+\t75566694\t75566850\t0\t1\t156,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[75560749, 75560881], [0, 132]])))
        self.assertEqual(str(alignment), 'chr13      75560749 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nchr13      75560809 ????????????????????????????????????????????????????????????\n                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        60 ????????????????????????????????????????????????????????????\n\nchr13      75560869 ???????????? 75560881\n                120 ||||||||||||      132\nCAG33136.       120 ????????????      132\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t75560749\t75560881\tCAG33136.1\t1000\t+\t75560749\t75560881\t0\t1\t132,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 986)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[75549820, 75549865, 75567225, 75567312], [0, 45, 45, 132]])))
        self.assertEqual(str(alignment), 'chr13      75549820 ????????????????????????????????????????????????????????????\n                  0 |||||||||||||||||||||||||||||||||||||||||||||---------------\nCAG33136.         0 ?????????????????????????????????????????????---------------\n\nchr13      75549880 ????????????????????????????????????????????????????????????\n                 60 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75549940 ????????????????????????????????????????????????????????????\n                120 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550000 ????????????????????????????????????????????????????????????\n                180 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550060 ????????????????????????????????????????????????????????????\n                240 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550120 ????????????????????????????????????????????????????????????\n                300 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550180 ????????????????????????????????????????????????????????????\n                360 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550240 ????????????????????????????????????????????????????????????\n                420 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550300 ????????????????????????????????????????????????????????????\n                480 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550360 ????????????????????????????????????????????????????????????\n                540 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550420 ????????????????????????????????????????????????????????????\n                600 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550480 ????????????????????????????????????????????????????????????\n                660 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550540 ????????????????????????????????????????????????????????????\n                720 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550600 ????????????????????????????????????????????????????????????\n                780 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550660 ????????????????????????????????????????????????????????????\n                840 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550720 ????????????????????????????????????????????????????????????\n                900 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550780 ????????????????????????????????????????????????????????????\n                960 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550840 ????????????????????????????????????????????????????????????\n               1020 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550900 ????????????????????????????????????????????????????????????\n               1080 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75550960 ????????????????????????????????????????????????????????????\n               1140 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551020 ????????????????????????????????????????????????????????????\n               1200 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551080 ????????????????????????????????????????????????????????????\n               1260 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551140 ????????????????????????????????????????????????????????????\n               1320 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551200 ????????????????????????????????????????????????????????????\n               1380 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551260 ????????????????????????????????????????????????????????????\n               1440 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551320 ????????????????????????????????????????????????????????????\n               1500 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551380 ????????????????????????????????????????????????????????????\n               1560 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551440 ????????????????????????????????????????????????????????????\n               1620 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551500 ????????????????????????????????????????????????????????????\n               1680 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551560 ????????????????????????????????????????????????????????????\n               1740 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551620 ????????????????????????????????????????????????????????????\n               1800 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551680 ????????????????????????????????????????????????????????????\n               1860 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551740 ????????????????????????????????????????????????????????????\n               1920 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551800 ????????????????????????????????????????????????????????????\n               1980 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551860 ????????????????????????????????????????????????????????????\n               2040 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551920 ????????????????????????????????????????????????????????????\n               2100 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75551980 ????????????????????????????????????????????????????????????\n               2160 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552040 ????????????????????????????????????????????????????????????\n               2220 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552100 ????????????????????????????????????????????????????????????\n               2280 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552160 ????????????????????????????????????????????????????????????\n               2340 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552220 ????????????????????????????????????????????????????????????\n               2400 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552280 ????????????????????????????????????????????????????????????\n               2460 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552340 ????????????????????????????????????????????????????????????\n               2520 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552400 ????????????????????????????????????????????????????????????\n               2580 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552460 ????????????????????????????????????????????????????????????\n               2640 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552520 ????????????????????????????????????????????????????????????\n               2700 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552580 ????????????????????????????????????????????????????????????\n               2760 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552640 ????????????????????????????????????????????????????????????\n               2820 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552700 ????????????????????????????????????????????????????????????\n               2880 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552760 ????????????????????????????????????????????????????????????\n               2940 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552820 ????????????????????????????????????????????????????????????\n               3000 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552880 ????????????????????????????????????????????????????????????\n               3060 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75552940 ????????????????????????????????????????????????????????????\n               3120 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553000 ????????????????????????????????????????????????????????????\n               3180 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553060 ????????????????????????????????????????????????????????????\n               3240 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553120 ????????????????????????????????????????????????????????????\n               3300 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553180 ????????????????????????????????????????????????????????????\n               3360 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553240 ????????????????????????????????????????????????????????????\n               3420 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553300 ????????????????????????????????????????????????????????????\n               3480 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553360 ????????????????????????????????????????????????????????????\n               3540 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553420 ????????????????????????????????????????????????????????????\n               3600 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553480 ????????????????????????????????????????????????????????????\n               3660 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553540 ????????????????????????????????????????????????????????????\n               3720 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553600 ????????????????????????????????????????????????????????????\n               3780 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553660 ????????????????????????????????????????????????????????????\n               3840 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553720 ????????????????????????????????????????????????????????????\n               3900 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553780 ????????????????????????????????????????????????????????????\n               3960 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553840 ????????????????????????????????????????????????????????????\n               4020 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553900 ????????????????????????????????????????????????????????????\n               4080 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75553960 ????????????????????????????????????????????????????????????\n               4140 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554020 ????????????????????????????????????????????????????????????\n               4200 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554080 ????????????????????????????????????????????????????????????\n               4260 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554140 ????????????????????????????????????????????????????????????\n               4320 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554200 ????????????????????????????????????????????????????????????\n               4380 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554260 ????????????????????????????????????????????????????????????\n               4440 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554320 ????????????????????????????????????????????????????????????\n               4500 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554380 ????????????????????????????????????????????????????????????\n               4560 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554440 ????????????????????????????????????????????????????????????\n               4620 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554500 ????????????????????????????????????????????????????????????\n               4680 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554560 ????????????????????????????????????????????????????????????\n               4740 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554620 ????????????????????????????????????????????????????????????\n               4800 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554680 ????????????????????????????????????????????????????????????\n               4860 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554740 ????????????????????????????????????????????????????????????\n               4920 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554800 ????????????????????????????????????????????????????????????\n               4980 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554860 ????????????????????????????????????????????????????????????\n               5040 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554920 ????????????????????????????????????????????????????????????\n               5100 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75554980 ????????????????????????????????????????????????????????????\n               5160 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555040 ????????????????????????????????????????????????????????????\n               5220 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555100 ????????????????????????????????????????????????????????????\n               5280 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555160 ????????????????????????????????????????????????????????????\n               5340 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555220 ????????????????????????????????????????????????????????????\n               5400 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555280 ????????????????????????????????????????????????????????????\n               5460 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555340 ????????????????????????????????????????????????????????????\n               5520 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555400 ????????????????????????????????????????????????????????????\n               5580 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555460 ????????????????????????????????????????????????????????????\n               5640 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555520 ????????????????????????????????????????????????????????????\n               5700 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555580 ????????????????????????????????????????????????????????????\n               5760 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555640 ????????????????????????????????????????????????????????????\n               5820 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555700 ????????????????????????????????????????????????????????????\n               5880 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555760 ????????????????????????????????????????????????????????????\n               5940 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555820 ????????????????????????????????????????????????????????????\n               6000 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555880 ????????????????????????????????????????????????????????????\n               6060 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75555940 ????????????????????????????????????????????????????????????\n               6120 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556000 ????????????????????????????????????????????????????????????\n               6180 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556060 ????????????????????????????????????????????????????????????\n               6240 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556120 ????????????????????????????????????????????????????????????\n               6300 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556180 ????????????????????????????????????????????????????????????\n               6360 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556240 ????????????????????????????????????????????????????????????\n               6420 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556300 ????????????????????????????????????????????????????????????\n               6480 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556360 ????????????????????????????????????????????????????????????\n               6540 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556420 ????????????????????????????????????????????????????????????\n               6600 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556480 ????????????????????????????????????????????????????????????\n               6660 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556540 ????????????????????????????????????????????????????????????\n               6720 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556600 ????????????????????????????????????????????????????????????\n               6780 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556660 ????????????????????????????????????????????????????????????\n               6840 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556720 ????????????????????????????????????????????????????????????\n               6900 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556780 ????????????????????????????????????????????????????????????\n               6960 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556840 ????????????????????????????????????????????????????????????\n               7020 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556900 ????????????????????????????????????????????????????????????\n               7080 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75556960 ????????????????????????????????????????????????????????????\n               7140 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557020 ????????????????????????????????????????????????????????????\n               7200 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557080 ????????????????????????????????????????????????????????????\n               7260 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557140 ????????????????????????????????????????????????????????????\n               7320 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557200 ????????????????????????????????????????????????????????????\n               7380 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557260 ????????????????????????????????????????????????????????????\n               7440 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557320 ????????????????????????????????????????????????????????????\n               7500 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557380 ????????????????????????????????????????????????????????????\n               7560 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557440 ????????????????????????????????????????????????????????????\n               7620 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557500 ????????????????????????????????????????????????????????????\n               7680 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557560 ????????????????????????????????????????????????????????????\n               7740 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557620 ????????????????????????????????????????????????????????????\n               7800 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557680 ????????????????????????????????????????????????????????????\n               7860 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557740 ????????????????????????????????????????????????????????????\n               7920 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557800 ????????????????????????????????????????????????????????????\n               7980 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557860 ????????????????????????????????????????????????????????????\n               8040 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557920 ????????????????????????????????????????????????????????????\n               8100 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75557980 ????????????????????????????????????????????????????????????\n               8160 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558040 ????????????????????????????????????????????????????????????\n               8220 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558100 ????????????????????????????????????????????????????????????\n               8280 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558160 ????????????????????????????????????????????????????????????\n               8340 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558220 ????????????????????????????????????????????????????????????\n               8400 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558280 ????????????????????????????????????????????????????????????\n               8460 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558340 ????????????????????????????????????????????????????????????\n               8520 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558400 ????????????????????????????????????????????????????????????\n               8580 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558460 ????????????????????????????????????????????????????????????\n               8640 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558520 ????????????????????????????????????????????????????????????\n               8700 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558580 ????????????????????????????????????????????????????????????\n               8760 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558640 ????????????????????????????????????????????????????????????\n               8820 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558700 ????????????????????????????????????????????????????????????\n               8880 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558760 ????????????????????????????????????????????????????????????\n               8940 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558820 ????????????????????????????????????????????????????????????\n               9000 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558880 ????????????????????????????????????????????????????????????\n               9060 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75558940 ????????????????????????????????????????????????????????????\n               9120 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559000 ????????????????????????????????????????????????????????????\n               9180 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559060 ????????????????????????????????????????????????????????????\n               9240 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559120 ????????????????????????????????????????????????????????????\n               9300 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559180 ????????????????????????????????????????????????????????????\n               9360 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559240 ????????????????????????????????????????????????????????????\n               9420 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559300 ????????????????????????????????????????????????????????????\n               9480 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559360 ????????????????????????????????????????????????????????????\n               9540 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559420 ????????????????????????????????????????????????????????????\n               9600 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559480 ????????????????????????????????????????????????????????????\n               9660 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559540 ????????????????????????????????????????????????????????????\n               9720 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559600 ????????????????????????????????????????????????????????????\n               9780 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559660 ????????????????????????????????????????????????????????????\n               9840 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559720 ????????????????????????????????????????????????????????????\n               9900 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559780 ????????????????????????????????????????????????????????????\n               9960 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559840 ????????????????????????????????????????????????????????????\n              10020 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559900 ????????????????????????????????????????????????????????????\n              10080 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75559960 ????????????????????????????????????????????????????????????\n              10140 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560020 ????????????????????????????????????????????????????????????\n              10200 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560080 ????????????????????????????????????????????????????????????\n              10260 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560140 ????????????????????????????????????????????????????????????\n              10320 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560200 ????????????????????????????????????????????????????????????\n              10380 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560260 ????????????????????????????????????????????????????????????\n              10440 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560320 ????????????????????????????????????????????????????????????\n              10500 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560380 ????????????????????????????????????????????????????????????\n              10560 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560440 ????????????????????????????????????????????????????????????\n              10620 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560500 ????????????????????????????????????????????????????????????\n              10680 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560560 ????????????????????????????????????????????????????????????\n              10740 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560620 ????????????????????????????????????????????????????????????\n              10800 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560680 ????????????????????????????????????????????????????????????\n              10860 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560740 ????????????????????????????????????????????????????????????\n              10920 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560800 ????????????????????????????????????????????????????????????\n              10980 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560860 ????????????????????????????????????????????????????????????\n              11040 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560920 ????????????????????????????????????????????????????????????\n              11100 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75560980 ????????????????????????????????????????????????????????????\n              11160 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561040 ????????????????????????????????????????????????????????????\n              11220 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561100 ????????????????????????????????????????????????????????????\n              11280 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561160 ????????????????????????????????????????????????????????????\n              11340 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561220 ????????????????????????????????????????????????????????????\n              11400 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561280 ????????????????????????????????????????????????????????????\n              11460 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561340 ????????????????????????????????????????????????????????????\n              11520 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561400 ????????????????????????????????????????????????????????????\n              11580 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561460 ????????????????????????????????????????????????????????????\n              11640 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561520 ????????????????????????????????????????????????????????????\n              11700 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561580 ????????????????????????????????????????????????????????????\n              11760 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561640 ????????????????????????????????????????????????????????????\n              11820 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561700 ????????????????????????????????????????????????????????????\n              11880 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561760 ????????????????????????????????????????????????????????????\n              11940 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561820 ????????????????????????????????????????????????????????????\n              12000 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561880 ????????????????????????????????????????????????????????????\n              12060 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75561940 ????????????????????????????????????????????????????????????\n              12120 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562000 ????????????????????????????????????????????????????????????\n              12180 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562060 ????????????????????????????????????????????????????????????\n              12240 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562120 ????????????????????????????????????????????????????????????\n              12300 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562180 ????????????????????????????????????????????????????????????\n              12360 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562240 ????????????????????????????????????????????????????????????\n              12420 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562300 ????????????????????????????????????????????????????????????\n              12480 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562360 ????????????????????????????????????????????????????????????\n              12540 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562420 ????????????????????????????????????????????????????????????\n              12600 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562480 ????????????????????????????????????????????????????????????\n              12660 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562540 ????????????????????????????????????????????????????????????\n              12720 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562600 ????????????????????????????????????????????????????????????\n              12780 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562660 ????????????????????????????????????????????????????????????\n              12840 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562720 ????????????????????????????????????????????????????????????\n              12900 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562780 ????????????????????????????????????????????????????????????\n              12960 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562840 ????????????????????????????????????????????????????????????\n              13020 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562900 ????????????????????????????????????????????????????????????\n              13080 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75562960 ????????????????????????????????????????????????????????????\n              13140 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563020 ????????????????????????????????????????????????????????????\n              13200 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563080 ????????????????????????????????????????????????????????????\n              13260 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563140 ????????????????????????????????????????????????????????????\n              13320 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563200 ????????????????????????????????????????????????????????????\n              13380 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563260 ????????????????????????????????????????????????????????????\n              13440 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563320 ????????????????????????????????????????????????????????????\n              13500 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563380 ????????????????????????????????????????????????????????????\n              13560 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563440 ????????????????????????????????????????????????????????????\n              13620 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563500 ????????????????????????????????????????????????????????????\n              13680 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563560 ????????????????????????????????????????????????????????????\n              13740 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563620 ????????????????????????????????????????????????????????????\n              13800 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563680 ????????????????????????????????????????????????????????????\n              13860 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563740 ????????????????????????????????????????????????????????????\n              13920 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563800 ????????????????????????????????????????????????????????????\n              13980 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563860 ????????????????????????????????????????????????????????????\n              14040 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563920 ????????????????????????????????????????????????????????????\n              14100 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75563980 ????????????????????????????????????????????????????????????\n              14160 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564040 ????????????????????????????????????????????????????????????\n              14220 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564100 ????????????????????????????????????????????????????????????\n              14280 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564160 ????????????????????????????????????????????????????????????\n              14340 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564220 ????????????????????????????????????????????????????????????\n              14400 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564280 ????????????????????????????????????????????????????????????\n              14460 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564340 ????????????????????????????????????????????????????????????\n              14520 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564400 ????????????????????????????????????????????????????????????\n              14580 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564460 ????????????????????????????????????????????????????????????\n              14640 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564520 ????????????????????????????????????????????????????????????\n              14700 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564580 ????????????????????????????????????????????????????????????\n              14760 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564640 ????????????????????????????????????????????????????????????\n              14820 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564700 ????????????????????????????????????????????????????????????\n              14880 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564760 ????????????????????????????????????????????????????????????\n              14940 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564820 ????????????????????????????????????????????????????????????\n              15000 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564880 ????????????????????????????????????????????????????????????\n              15060 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75564940 ????????????????????????????????????????????????????????????\n              15120 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565000 ????????????????????????????????????????????????????????????\n              15180 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565060 ????????????????????????????????????????????????????????????\n              15240 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565120 ????????????????????????????????????????????????????????????\n              15300 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565180 ????????????????????????????????????????????????????????????\n              15360 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565240 ????????????????????????????????????????????????????????????\n              15420 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565300 ????????????????????????????????????????????????????????????\n              15480 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565360 ????????????????????????????????????????????????????????????\n              15540 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565420 ????????????????????????????????????????????????????????????\n              15600 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565480 ????????????????????????????????????????????????????????????\n              15660 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565540 ????????????????????????????????????????????????????????????\n              15720 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565600 ????????????????????????????????????????????????????????????\n              15780 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565660 ????????????????????????????????????????????????????????????\n              15840 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565720 ????????????????????????????????????????????????????????????\n              15900 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565780 ????????????????????????????????????????????????????????????\n              15960 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565840 ????????????????????????????????????????????????????????????\n              16020 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565900 ????????????????????????????????????????????????????????????\n              16080 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75565960 ????????????????????????????????????????????????????????????\n              16140 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566020 ????????????????????????????????????????????????????????????\n              16200 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566080 ????????????????????????????????????????????????????????????\n              16260 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566140 ????????????????????????????????????????????????????????????\n              16320 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566200 ????????????????????????????????????????????????????????????\n              16380 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566260 ????????????????????????????????????????????????????????????\n              16440 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566320 ????????????????????????????????????????????????????????????\n              16500 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566380 ????????????????????????????????????????????????????????????\n              16560 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566440 ????????????????????????????????????????????????????????????\n              16620 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566500 ????????????????????????????????????????????????????????????\n              16680 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566560 ????????????????????????????????????????????????????????????\n              16740 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566620 ????????????????????????????????????????????????????????????\n              16800 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566680 ????????????????????????????????????????????????????????????\n              16860 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566740 ????????????????????????????????????????????????????????????\n              16920 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566800 ????????????????????????????????????????????????????????????\n              16980 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566860 ????????????????????????????????????????????????????????????\n              17040 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566920 ????????????????????????????????????????????????????????????\n              17100 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75566980 ????????????????????????????????????????????????????????????\n              17160 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75567040 ????????????????????????????????????????????????????????????\n              17220 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75567100 ????????????????????????????????????????????????????????????\n              17280 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75567160 ????????????????????????????????????????????????????????????\n              17340 ------------------------------------------------------------\nCAG33136.        45 ------------------------------------------------------------\n\nchr13      75567220 ????????????????????????????????????????????????????????????\n              17400 -----|||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        45 -----???????????????????????????????????????????????????????\n\nchr13      75567280 ???????????????????????????????? 75567312\n              17460 ||||||||||||||||||||||||||||||||    17492\nCAG33136.       100 ????????????????????????????????      132\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t75549820\t75567312\tCAG33136.1\t986\t+\t75549820\t75567312\t0\t2\t45,87,\t0,17405,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[75604767, 75604827, 75605728, 75605809], [0, 60, 60, 141]])))
        self.assertEqual(str(alignment), 'chr13      75604767 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nchr13      75604827 ????????????????????????????????????????????????????????????\n                 60 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75604887 ????????????????????????????????????????????????????????????\n                120 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75604947 ????????????????????????????????????????????????????????????\n                180 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605007 ????????????????????????????????????????????????????????????\n                240 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605067 ????????????????????????????????????????????????????????????\n                300 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605127 ????????????????????????????????????????????????????????????\n                360 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605187 ????????????????????????????????????????????????????????????\n                420 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605247 ????????????????????????????????????????????????????????????\n                480 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605307 ????????????????????????????????????????????????????????????\n                540 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605367 ????????????????????????????????????????????????????????????\n                600 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605427 ????????????????????????????????????????????????????????????\n                660 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605487 ????????????????????????????????????????????????????????????\n                720 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605547 ????????????????????????????????????????????????????????????\n                780 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605607 ????????????????????????????????????????????????????????????\n                840 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605667 ????????????????????????????????????????????????????????????\n                900 ------------------------------------------------------------\nCAG33136.        60 ------------------------------------------------------------\n\nchr13      75605727 ????????????????????????????????????????????????????????????\n                960 -|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        60 -???????????????????????????????????????????????????????????\n\nchr13      75605787 ?????????????????????? 75605809\n               1020 ||||||||||||||||||||||     1042\nCAG33136.       119 ??????????????????????      141\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t75604767\t75605809\tCAG33136.1\t1000\t+\t75604767\t75605809\t0\t2\t60,81,\t0,961,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[75594914, 75594989], [0, 75]])))
        self.assertEqual(str(alignment), 'chr13      75594914 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nchr13      75594974 ??????????????? 75594989\n                 60 |||||||||||||||       75\nCAG33136.        60 ???????????????       75\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t75594914\t75594989\tCAG33136.1\t1000\t+\t75594914\t75594989\t0\t1\t75,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1000)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr13')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[75569459, 75569507], [0, 48]])))
        self.assertEqual(str(alignment), 'chr13      75569459 ???????????????????????????????????????????????? 75569507\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||       48\nCAG33136.         0 ????????????????????????????????????????????????       48\n')
        self.assertEqual(format(alignment, 'bed'), 'chr13\t75569459\t75569507\tCAG33136.1\t1000\t+\t75569459\t75569507\t0\t1\t48,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 530)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[41260685, 41260787], [0, 102]])))
        self.assertEqual(str(alignment), 'chr4       41260685 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nchr4       41260745 ?????????????????????????????????????????? 41260787\n                 60 ||||||||||||||||||||||||||||||||||||||||||      102\nCAG33136.        60 ??????????????????????????????????????????      102\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t41260685\t41260787\tCAG33136.1\t530\t+\t41260685\t41260787\t0\t1\t102,\t0,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 166)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr4')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[41257605, 41257731, 41263227, 41263290], [0, 126, 126, 189]])))
        self.assertEqual(str(alignment), 'chr4       41257605 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nchr4       41257665 ????????????????????????????????????????????????????????????\n                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        60 ????????????????????????????????????????????????????????????\n\nchr4       41257725 ????????????????????????????????????????????????????????????\n                120 ||||||------------------------------------------------------\nCAG33136.       120 ??????------------------------------------------------------\n\nchr4       41257785 ????????????????????????????????????????????????????????????\n                180 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41257845 ????????????????????????????????????????????????????????????\n                240 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41257905 ????????????????????????????????????????????????????????????\n                300 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41257965 ????????????????????????????????????????????????????????????\n                360 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258025 ????????????????????????????????????????????????????????????\n                420 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258085 ????????????????????????????????????????????????????????????\n                480 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258145 ????????????????????????????????????????????????????????????\n                540 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258205 ????????????????????????????????????????????????????????????\n                600 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258265 ????????????????????????????????????????????????????????????\n                660 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258325 ????????????????????????????????????????????????????????????\n                720 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258385 ????????????????????????????????????????????????????????????\n                780 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258445 ????????????????????????????????????????????????????????????\n                840 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258505 ????????????????????????????????????????????????????????????\n                900 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258565 ????????????????????????????????????????????????????????????\n                960 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258625 ????????????????????????????????????????????????????????????\n               1020 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258685 ????????????????????????????????????????????????????????????\n               1080 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258745 ????????????????????????????????????????????????????????????\n               1140 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258805 ????????????????????????????????????????????????????????????\n               1200 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258865 ????????????????????????????????????????????????????????????\n               1260 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258925 ????????????????????????????????????????????????????????????\n               1320 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41258985 ????????????????????????????????????????????????????????????\n               1380 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259045 ????????????????????????????????????????????????????????????\n               1440 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259105 ????????????????????????????????????????????????????????????\n               1500 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259165 ????????????????????????????????????????????????????????????\n               1560 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259225 ????????????????????????????????????????????????????????????\n               1620 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259285 ????????????????????????????????????????????????????????????\n               1680 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259345 ????????????????????????????????????????????????????????????\n               1740 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259405 ????????????????????????????????????????????????????????????\n               1800 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259465 ????????????????????????????????????????????????????????????\n               1860 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259525 ????????????????????????????????????????????????????????????\n               1920 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259585 ????????????????????????????????????????????????????????????\n               1980 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259645 ????????????????????????????????????????????????????????????\n               2040 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259705 ????????????????????????????????????????????????????????????\n               2100 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259765 ????????????????????????????????????????????????????????????\n               2160 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259825 ????????????????????????????????????????????????????????????\n               2220 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259885 ????????????????????????????????????????????????????????????\n               2280 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41259945 ????????????????????????????????????????????????????????????\n               2340 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260005 ????????????????????????????????????????????????????????????\n               2400 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260065 ????????????????????????????????????????????????????????????\n               2460 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260125 ????????????????????????????????????????????????????????????\n               2520 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260185 ????????????????????????????????????????????????????????????\n               2580 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260245 ????????????????????????????????????????????????????????????\n               2640 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260305 ????????????????????????????????????????????????????????????\n               2700 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260365 ????????????????????????????????????????????????????????????\n               2760 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260425 ????????????????????????????????????????????????????????????\n               2820 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260485 ????????????????????????????????????????????????????????????\n               2880 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260545 ????????????????????????????????????????????????????????????\n               2940 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260605 ????????????????????????????????????????????????????????????\n               3000 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260665 ????????????????????????????????????????????????????????????\n               3060 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260725 ????????????????????????????????????????????????????????????\n               3120 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260785 ????????????????????????????????????????????????????????????\n               3180 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260845 ????????????????????????????????????????????????????????????\n               3240 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260905 ????????????????????????????????????????????????????????????\n               3300 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41260965 ????????????????????????????????????????????????????????????\n               3360 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261025 ????????????????????????????????????????????????????????????\n               3420 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261085 ????????????????????????????????????????????????????????????\n               3480 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261145 ????????????????????????????????????????????????????????????\n               3540 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261205 ????????????????????????????????????????????????????????????\n               3600 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261265 ????????????????????????????????????????????????????????????\n               3660 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261325 ????????????????????????????????????????????????????????????\n               3720 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261385 ????????????????????????????????????????????????????????????\n               3780 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261445 ????????????????????????????????????????????????????????????\n               3840 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261505 ????????????????????????????????????????????????????????????\n               3900 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261565 ????????????????????????????????????????????????????????????\n               3960 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261625 ????????????????????????????????????????????????????????????\n               4020 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261685 ????????????????????????????????????????????????????????????\n               4080 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261745 ????????????????????????????????????????????????????????????\n               4140 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261805 ????????????????????????????????????????????????????????????\n               4200 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261865 ????????????????????????????????????????????????????????????\n               4260 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261925 ????????????????????????????????????????????????????????????\n               4320 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41261985 ????????????????????????????????????????????????????????????\n               4380 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262045 ????????????????????????????????????????????????????????????\n               4440 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262105 ????????????????????????????????????????????????????????????\n               4500 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262165 ????????????????????????????????????????????????????????????\n               4560 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262225 ????????????????????????????????????????????????????????????\n               4620 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262285 ????????????????????????????????????????????????????????????\n               4680 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262345 ????????????????????????????????????????????????????????????\n               4740 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262405 ????????????????????????????????????????????????????????????\n               4800 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262465 ????????????????????????????????????????????????????????????\n               4860 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262525 ????????????????????????????????????????????????????????????\n               4920 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262585 ????????????????????????????????????????????????????????????\n               4980 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262645 ????????????????????????????????????????????????????????????\n               5040 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262705 ????????????????????????????????????????????????????????????\n               5100 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262765 ????????????????????????????????????????????????????????????\n               5160 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262825 ????????????????????????????????????????????????????????????\n               5220 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262885 ????????????????????????????????????????????????????????????\n               5280 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41262945 ????????????????????????????????????????????????????????????\n               5340 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41263005 ????????????????????????????????????????????????????????????\n               5400 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41263065 ????????????????????????????????????????????????????????????\n               5460 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41263125 ????????????????????????????????????????????????????????????\n               5520 ------------------------------------------------------------\nCAG33136.       126 ------------------------------------------------------------\n\nchr4       41263185 ????????????????????????????????????????????????????????????\n               5580 ------------------------------------------||||||||||||||||||\nCAG33136.       126 ------------------------------------------??????????????????\n\nchr4       41263245 ????????????????????????????????????????????? 41263290\n               5640 |||||||||||||||||||||||||||||||||||||||||||||     5685\nCAG33136.       144 ?????????????????????????????????????????????      189\n')
        self.assertEqual(format(alignment, 'bed'), 'chr4\t41257605\t41263290\tCAG33136.1\t166\t+\t41257605\t41263290\t0\t2\t126,63,\t0,5622,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_writing_psl_35_001(self):
        if False:
            while True:
                i = 10
        'Test writing the alignments in psl_35_001.bed.'
        path = 'Blat/psl_35_001.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 8)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

    def test_reading_psl_35_002(self):
        if False:
            print('Hello World!')
        'Test parsing psl_35_002.bed.'
        path = 'Blat/psl_35_002.bed'
        alignments = Align.parse(path, 'bed')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 972)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'KI537979')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[9712654, 9712786, 9715941, 9716097, 9716445, 9716532, 9718374, 9718422, 9739264, 9739339, 9743706, 9743766, 9744511, 9744592], [0, 132, 132, 288, 288, 375, 375, 423, 423, 498, 498, 558, 558, 639]])))
        self.assertEqual(str(alignment), 'KI537979    9712654 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nKI537979    9712714 ????????????????????????????????????????????????????????????\n                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        60 ????????????????????????????????????????????????????????????\n\nKI537979    9712774 ????????????????????????????????????????????????????????????\n                120 ||||||||||||------------------------------------------------\nCAG33136.       120 ????????????------------------------------------------------\n\nKI537979    9712834 ????????????????????????????????????????????????????????????\n                180 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9712894 ????????????????????????????????????????????????????????????\n                240 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9712954 ????????????????????????????????????????????????????????????\n                300 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713014 ????????????????????????????????????????????????????????????\n                360 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713074 ????????????????????????????????????????????????????????????\n                420 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713134 ????????????????????????????????????????????????????????????\n                480 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713194 ????????????????????????????????????????????????????????????\n                540 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713254 ????????????????????????????????????????????????????????????\n                600 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713314 ????????????????????????????????????????????????????????????\n                660 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713374 ????????????????????????????????????????????????????????????\n                720 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713434 ????????????????????????????????????????????????????????????\n                780 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713494 ????????????????????????????????????????????????????????????\n                840 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713554 ????????????????????????????????????????????????????????????\n                900 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713614 ????????????????????????????????????????????????????????????\n                960 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713674 ????????????????????????????????????????????????????????????\n               1020 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713734 ????????????????????????????????????????????????????????????\n               1080 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713794 ????????????????????????????????????????????????????????????\n               1140 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713854 ????????????????????????????????????????????????????????????\n               1200 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713914 ????????????????????????????????????????????????????????????\n               1260 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9713974 ????????????????????????????????????????????????????????????\n               1320 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714034 ????????????????????????????????????????????????????????????\n               1380 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714094 ????????????????????????????????????????????????????????????\n               1440 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714154 ????????????????????????????????????????????????????????????\n               1500 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714214 ????????????????????????????????????????????????????????????\n               1560 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714274 ????????????????????????????????????????????????????????????\n               1620 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714334 ????????????????????????????????????????????????????????????\n               1680 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714394 ????????????????????????????????????????????????????????????\n               1740 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714454 ????????????????????????????????????????????????????????????\n               1800 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714514 ????????????????????????????????????????????????????????????\n               1860 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714574 ????????????????????????????????????????????????????????????\n               1920 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714634 ????????????????????????????????????????????????????????????\n               1980 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714694 ????????????????????????????????????????????????????????????\n               2040 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714754 ????????????????????????????????????????????????????????????\n               2100 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714814 ????????????????????????????????????????????????????????????\n               2160 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714874 ????????????????????????????????????????????????????????????\n               2220 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714934 ????????????????????????????????????????????????????????????\n               2280 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9714994 ????????????????????????????????????????????????????????????\n               2340 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715054 ????????????????????????????????????????????????????????????\n               2400 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715114 ????????????????????????????????????????????????????????????\n               2460 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715174 ????????????????????????????????????????????????????????????\n               2520 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715234 ????????????????????????????????????????????????????????????\n               2580 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715294 ????????????????????????????????????????????????????????????\n               2640 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715354 ????????????????????????????????????????????????????????????\n               2700 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715414 ????????????????????????????????????????????????????????????\n               2760 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715474 ????????????????????????????????????????????????????????????\n               2820 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715534 ????????????????????????????????????????????????????????????\n               2880 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715594 ????????????????????????????????????????????????????????????\n               2940 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715654 ????????????????????????????????????????????????????????????\n               3000 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715714 ????????????????????????????????????????????????????????????\n               3060 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715774 ????????????????????????????????????????????????????????????\n               3120 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715834 ????????????????????????????????????????????????????????????\n               3180 ------------------------------------------------------------\nCAG33136.       132 ------------------------------------------------------------\n\nKI537979    9715894 ????????????????????????????????????????????????????????????\n               3240 -----------------------------------------------|||||||||||||\nCAG33136.       132 -----------------------------------------------?????????????\n\nKI537979    9715954 ????????????????????????????????????????????????????????????\n               3300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       145 ????????????????????????????????????????????????????????????\n\nKI537979    9716014 ????????????????????????????????????????????????????????????\n               3360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       205 ????????????????????????????????????????????????????????????\n\nKI537979    9716074 ????????????????????????????????????????????????????????????\n               3420 |||||||||||||||||||||||-------------------------------------\nCAG33136.       265 ???????????????????????-------------------------------------\n\nKI537979    9716134 ????????????????????????????????????????????????????????????\n               3480 ------------------------------------------------------------\nCAG33136.       288 ------------------------------------------------------------\n\nKI537979    9716194 ????????????????????????????????????????????????????????????\n               3540 ------------------------------------------------------------\nCAG33136.       288 ------------------------------------------------------------\n\nKI537979    9716254 ????????????????????????????????????????????????????????????\n               3600 ------------------------------------------------------------\nCAG33136.       288 ------------------------------------------------------------\n\nKI537979    9716314 ????????????????????????????????????????????????????????????\n               3660 ------------------------------------------------------------\nCAG33136.       288 ------------------------------------------------------------\n\nKI537979    9716374 ????????????????????????????????????????????????????????????\n               3720 ------------------------------------------------------------\nCAG33136.       288 ------------------------------------------------------------\n\nKI537979    9716434 ????????????????????????????????????????????????????????????\n               3780 -----------|||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       288 -----------?????????????????????????????????????????????????\n\nKI537979    9716494 ????????????????????????????????????????????????????????????\n               3840 ||||||||||||||||||||||||||||||||||||||----------------------\nCAG33136.       337 ??????????????????????????????????????----------------------\n\nKI537979    9716554 ????????????????????????????????????????????????????????????\n               3900 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716614 ????????????????????????????????????????????????????????????\n               3960 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716674 ????????????????????????????????????????????????????????????\n               4020 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716734 ????????????????????????????????????????????????????????????\n               4080 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716794 ????????????????????????????????????????????????????????????\n               4140 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716854 ????????????????????????????????????????????????????????????\n               4200 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716914 ????????????????????????????????????????????????????????????\n               4260 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9716974 ????????????????????????????????????????????????????????????\n               4320 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717034 ????????????????????????????????????????????????????????????\n               4380 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717094 ????????????????????????????????????????????????????????????\n               4440 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717154 ????????????????????????????????????????????????????????????\n               4500 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717214 ????????????????????????????????????????????????????????????\n               4560 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717274 ????????????????????????????????????????????????????????????\n               4620 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717334 ????????????????????????????????????????????????????????????\n               4680 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717394 ????????????????????????????????????????????????????????????\n               4740 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717454 ????????????????????????????????????????????????????????????\n               4800 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717514 ????????????????????????????????????????????????????????????\n               4860 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717574 ????????????????????????????????????????????????????????????\n               4920 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717634 ????????????????????????????????????????????????????????????\n               4980 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717694 ????????????????????????????????????????????????????????????\n               5040 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717754 ????????????????????????????????????????????????????????????\n               5100 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717814 ????????????????????????????????????????????????????????????\n               5160 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717874 ????????????????????????????????????????????????????????????\n               5220 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717934 ????????????????????????????????????????????????????????????\n               5280 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9717994 ????????????????????????????????????????????????????????????\n               5340 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9718054 ????????????????????????????????????????????????????????????\n               5400 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9718114 ????????????????????????????????????????????????????????????\n               5460 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9718174 ????????????????????????????????????????????????????????????\n               5520 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9718234 ????????????????????????????????????????????????????????????\n               5580 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9718294 ????????????????????????????????????????????????????????????\n               5640 ------------------------------------------------------------\nCAG33136.       375 ------------------------------------------------------------\n\nKI537979    9718354 ????????????????????????????????????????????????????????????\n               5700 --------------------||||||||||||||||||||||||||||||||||||||||\nCAG33136.       375 --------------------????????????????????????????????????????\n\nKI537979    9718414 ????????????????????????????????????????????????????????????\n               5760 ||||||||----------------------------------------------------\nCAG33136.       415 ????????----------------------------------------------------\n\nKI537979    9718474 ????????????????????????????????????????????????????????????\n               5820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718534 ????????????????????????????????????????????????????????????\n               5880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718594 ????????????????????????????????????????????????????????????\n               5940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718654 ????????????????????????????????????????????????????????????\n               6000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718714 ????????????????????????????????????????????????????????????\n               6060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718774 ????????????????????????????????????????????????????????????\n               6120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718834 ????????????????????????????????????????????????????????????\n               6180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718894 ????????????????????????????????????????????????????????????\n               6240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9718954 ????????????????????????????????????????????????????????????\n               6300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719014 ????????????????????????????????????????????????????????????\n               6360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719074 ????????????????????????????????????????????????????????????\n               6420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719134 ????????????????????????????????????????????????????????????\n               6480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719194 ????????????????????????????????????????????????????????????\n               6540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719254 ????????????????????????????????????????????????????????????\n               6600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719314 ????????????????????????????????????????????????????????????\n               6660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719374 ????????????????????????????????????????????????????????????\n               6720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719434 ????????????????????????????????????????????????????????????\n               6780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719494 ????????????????????????????????????????????????????????????\n               6840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719554 ????????????????????????????????????????????????????????????\n               6900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719614 ????????????????????????????????????????????????????????????\n               6960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719674 ????????????????????????????????????????????????????????????\n               7020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719734 ????????????????????????????????????????????????????????????\n               7080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719794 ????????????????????????????????????????????????????????????\n               7140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719854 ????????????????????????????????????????????????????????????\n               7200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719914 ????????????????????????????????????????????????????????????\n               7260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9719974 ????????????????????????????????????????????????????????????\n               7320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720034 ????????????????????????????????????????????????????????????\n               7380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720094 ????????????????????????????????????????????????????????????\n               7440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720154 ????????????????????????????????????????????????????????????\n               7500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720214 ????????????????????????????????????????????????????????????\n               7560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720274 ????????????????????????????????????????????????????????????\n               7620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720334 ????????????????????????????????????????????????????????????\n               7680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720394 ????????????????????????????????????????????????????????????\n               7740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720454 ????????????????????????????????????????????????????????????\n               7800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720514 ????????????????????????????????????????????????????????????\n               7860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720574 ????????????????????????????????????????????????????????????\n               7920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720634 ????????????????????????????????????????????????????????????\n               7980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720694 ????????????????????????????????????????????????????????????\n               8040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720754 ????????????????????????????????????????????????????????????\n               8100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720814 ????????????????????????????????????????????????????????????\n               8160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720874 ????????????????????????????????????????????????????????????\n               8220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720934 ????????????????????????????????????????????????????????????\n               8280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9720994 ????????????????????????????????????????????????????????????\n               8340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721054 ????????????????????????????????????????????????????????????\n               8400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721114 ????????????????????????????????????????????????????????????\n               8460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721174 ????????????????????????????????????????????????????????????\n               8520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721234 ????????????????????????????????????????????????????????????\n               8580 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721294 ????????????????????????????????????????????????????????????\n               8640 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721354 ????????????????????????????????????????????????????????????\n               8700 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721414 ????????????????????????????????????????????????????????????\n               8760 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721474 ????????????????????????????????????????????????????????????\n               8820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721534 ????????????????????????????????????????????????????????????\n               8880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721594 ????????????????????????????????????????????????????????????\n               8940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721654 ????????????????????????????????????????????????????????????\n               9000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721714 ????????????????????????????????????????????????????????????\n               9060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721774 ????????????????????????????????????????????????????????????\n               9120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721834 ????????????????????????????????????????????????????????????\n               9180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721894 ????????????????????????????????????????????????????????????\n               9240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9721954 ????????????????????????????????????????????????????????????\n               9300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722014 ????????????????????????????????????????????????????????????\n               9360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722074 ????????????????????????????????????????????????????????????\n               9420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722134 ????????????????????????????????????????????????????????????\n               9480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722194 ????????????????????????????????????????????????????????????\n               9540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722254 ????????????????????????????????????????????????????????????\n               9600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722314 ????????????????????????????????????????????????????????????\n               9660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722374 ????????????????????????????????????????????????????????????\n               9720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722434 ????????????????????????????????????????????????????????????\n               9780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722494 ????????????????????????????????????????????????????????????\n               9840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722554 ????????????????????????????????????????????????????????????\n               9900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722614 ????????????????????????????????????????????????????????????\n               9960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722674 ????????????????????????????????????????????????????????????\n              10020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722734 ????????????????????????????????????????????????????????????\n              10080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722794 ????????????????????????????????????????????????????????????\n              10140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722854 ????????????????????????????????????????????????????????????\n              10200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722914 ????????????????????????????????????????????????????????????\n              10260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9722974 ????????????????????????????????????????????????????????????\n              10320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723034 ????????????????????????????????????????????????????????????\n              10380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723094 ????????????????????????????????????????????????????????????\n              10440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723154 ????????????????????????????????????????????????????????????\n              10500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723214 ????????????????????????????????????????????????????????????\n              10560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723274 ????????????????????????????????????????????????????????????\n              10620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723334 ????????????????????????????????????????????????????????????\n              10680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723394 ????????????????????????????????????????????????????????????\n              10740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723454 ????????????????????????????????????????????????????????????\n              10800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723514 ????????????????????????????????????????????????????????????\n              10860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723574 ????????????????????????????????????????????????????????????\n              10920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723634 ????????????????????????????????????????????????????????????\n              10980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723694 ????????????????????????????????????????????????????????????\n              11040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723754 ????????????????????????????????????????????????????????????\n              11100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723814 ????????????????????????????????????????????????????????????\n              11160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723874 ????????????????????????????????????????????????????????????\n              11220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723934 ????????????????????????????????????????????????????????????\n              11280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9723994 ????????????????????????????????????????????????????????????\n              11340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724054 ????????????????????????????????????????????????????????????\n              11400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724114 ????????????????????????????????????????????????????????????\n              11460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724174 ????????????????????????????????????????????????????????????\n              11520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724234 ????????????????????????????????????????????????????????????\n              11580 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724294 ????????????????????????????????????????????????????????????\n              11640 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724354 ????????????????????????????????????????????????????????????\n              11700 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724414 ????????????????????????????????????????????????????????????\n              11760 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724474 ????????????????????????????????????????????????????????????\n              11820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724534 ????????????????????????????????????????????????????????????\n              11880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724594 ????????????????????????????????????????????????????????????\n              11940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724654 ????????????????????????????????????????????????????????????\n              12000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724714 ????????????????????????????????????????????????????????????\n              12060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724774 ????????????????????????????????????????????????????????????\n              12120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724834 ????????????????????????????????????????????????????????????\n              12180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724894 ????????????????????????????????????????????????????????????\n              12240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9724954 ????????????????????????????????????????????????????????????\n              12300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725014 ????????????????????????????????????????????????????????????\n              12360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725074 ????????????????????????????????????????????????????????????\n              12420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725134 ????????????????????????????????????????????????????????????\n              12480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725194 ????????????????????????????????????????????????????????????\n              12540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725254 ????????????????????????????????????????????????????????????\n              12600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725314 ????????????????????????????????????????????????????????????\n              12660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725374 ????????????????????????????????????????????????????????????\n              12720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725434 ????????????????????????????????????????????????????????????\n              12780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725494 ????????????????????????????????????????????????????????????\n              12840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725554 ????????????????????????????????????????????????????????????\n              12900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725614 ????????????????????????????????????????????????????????????\n              12960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725674 ????????????????????????????????????????????????????????????\n              13020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725734 ????????????????????????????????????????????????????????????\n              13080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725794 ????????????????????????????????????????????????????????????\n              13140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725854 ????????????????????????????????????????????????????????????\n              13200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725914 ????????????????????????????????????????????????????????????\n              13260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9725974 ????????????????????????????????????????????????????????????\n              13320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726034 ????????????????????????????????????????????????????????????\n              13380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726094 ????????????????????????????????????????????????????????????\n              13440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726154 ????????????????????????????????????????????????????????????\n              13500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726214 ????????????????????????????????????????????????????????????\n              13560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726274 ????????????????????????????????????????????????????????????\n              13620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726334 ????????????????????????????????????????????????????????????\n              13680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726394 ????????????????????????????????????????????????????????????\n              13740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726454 ????????????????????????????????????????????????????????????\n              13800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726514 ????????????????????????????????????????????????????????????\n              13860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726574 ????????????????????????????????????????????????????????????\n              13920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726634 ????????????????????????????????????????????????????????????\n              13980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726694 ????????????????????????????????????????????????????????????\n              14040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726754 ????????????????????????????????????????????????????????????\n              14100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726814 ????????????????????????????????????????????????????????????\n              14160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726874 ????????????????????????????????????????????????????????????\n              14220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726934 ????????????????????????????????????????????????????????????\n              14280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9726994 ????????????????????????????????????????????????????????????\n              14340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727054 ????????????????????????????????????????????????????????????\n              14400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727114 ????????????????????????????????????????????????????????????\n              14460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727174 ????????????????????????????????????????????????????????????\n              14520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727234 ????????????????????????????????????????????????????????????\n              14580 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727294 ????????????????????????????????????????????????????????????\n              14640 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727354 ????????????????????????????????????????????????????????????\n              14700 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727414 ????????????????????????????????????????????????????????????\n              14760 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727474 ????????????????????????????????????????????????????????????\n              14820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727534 ????????????????????????????????????????????????????????????\n              14880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727594 ????????????????????????????????????????????????????????????\n              14940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727654 ????????????????????????????????????????????????????????????\n              15000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727714 ????????????????????????????????????????????????????????????\n              15060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727774 ????????????????????????????????????????????????????????????\n              15120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727834 ????????????????????????????????????????????????????????????\n              15180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727894 ????????????????????????????????????????????????????????????\n              15240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9727954 ????????????????????????????????????????????????????????????\n              15300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728014 ????????????????????????????????????????????????????????????\n              15360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728074 ????????????????????????????????????????????????????????????\n              15420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728134 ????????????????????????????????????????????????????????????\n              15480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728194 ????????????????????????????????????????????????????????????\n              15540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728254 ????????????????????????????????????????????????????????????\n              15600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728314 ????????????????????????????????????????????????????????????\n              15660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728374 ????????????????????????????????????????????????????????????\n              15720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728434 ????????????????????????????????????????????????????????????\n              15780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728494 ????????????????????????????????????????????????????????????\n              15840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728554 ????????????????????????????????????????????????????????????\n              15900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728614 ????????????????????????????????????????????????????????????\n              15960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728674 ????????????????????????????????????????????????????????????\n              16020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728734 ????????????????????????????????????????????????????????????\n              16080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728794 ????????????????????????????????????????????????????????????\n              16140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728854 ????????????????????????????????????????????????????????????\n              16200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728914 ????????????????????????????????????????????????????????????\n              16260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9728974 ????????????????????????????????????????????????????????????\n              16320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729034 ????????????????????????????????????????????????????????????\n              16380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729094 ????????????????????????????????????????????????????????????\n              16440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729154 ????????????????????????????????????????????????????????????\n              16500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729214 ????????????????????????????????????????????????????????????\n              16560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729274 ????????????????????????????????????????????????????????????\n              16620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729334 ????????????????????????????????????????????????????????????\n              16680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729394 ????????????????????????????????????????????????????????????\n              16740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729454 ????????????????????????????????????????????????????????????\n              16800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729514 ????????????????????????????????????????????????????????????\n              16860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729574 ????????????????????????????????????????????????????????????\n              16920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729634 ????????????????????????????????????????????????????????????\n              16980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729694 ????????????????????????????????????????????????????????????\n              17040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729754 ????????????????????????????????????????????????????????????\n              17100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729814 ????????????????????????????????????????????????????????????\n              17160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729874 ????????????????????????????????????????????????????????????\n              17220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729934 ????????????????????????????????????????????????????????????\n              17280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9729994 ????????????????????????????????????????????????????????????\n              17340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730054 ????????????????????????????????????????????????????????????\n              17400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730114 ????????????????????????????????????????????????????????????\n              17460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730174 ????????????????????????????????????????????????????????????\n              17520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730234 ????????????????????????????????????????????????????????????\n              17580 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730294 ????????????????????????????????????????????????????????????\n              17640 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730354 ????????????????????????????????????????????????????????????\n              17700 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730414 ????????????????????????????????????????????????????????????\n              17760 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730474 ????????????????????????????????????????????????????????????\n              17820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730534 ????????????????????????????????????????????????????????????\n              17880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730594 ????????????????????????????????????????????????????????????\n              17940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730654 ????????????????????????????????????????????????????????????\n              18000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730714 ????????????????????????????????????????????????????????????\n              18060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730774 ????????????????????????????????????????????????????????????\n              18120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730834 ????????????????????????????????????????????????????????????\n              18180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730894 ????????????????????????????????????????????????????????????\n              18240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9730954 ????????????????????????????????????????????????????????????\n              18300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731014 ????????????????????????????????????????????????????????????\n              18360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731074 ????????????????????????????????????????????????????????????\n              18420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731134 ????????????????????????????????????????????????????????????\n              18480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731194 ????????????????????????????????????????????????????????????\n              18540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731254 ????????????????????????????????????????????????????????????\n              18600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731314 ????????????????????????????????????????????????????????????\n              18660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731374 ????????????????????????????????????????????????????????????\n              18720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731434 ????????????????????????????????????????????????????????????\n              18780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731494 ????????????????????????????????????????????????????????????\n              18840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731554 ????????????????????????????????????????????????????????????\n              18900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731614 ????????????????????????????????????????????????????????????\n              18960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731674 ????????????????????????????????????????????????????????????\n              19020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731734 ????????????????????????????????????????????????????????????\n              19080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731794 ????????????????????????????????????????????????????????????\n              19140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731854 ????????????????????????????????????????????????????????????\n              19200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731914 ????????????????????????????????????????????????????????????\n              19260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9731974 ????????????????????????????????????????????????????????????\n              19320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732034 ????????????????????????????????????????????????????????????\n              19380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732094 ????????????????????????????????????????????????????????????\n              19440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732154 ????????????????????????????????????????????????????????????\n              19500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732214 ????????????????????????????????????????????????????????????\n              19560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732274 ????????????????????????????????????????????????????????????\n              19620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732334 ????????????????????????????????????????????????????????????\n              19680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732394 ????????????????????????????????????????????????????????????\n              19740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732454 ????????????????????????????????????????????????????????????\n              19800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732514 ????????????????????????????????????????????????????????????\n              19860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732574 ????????????????????????????????????????????????????????????\n              19920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732634 ????????????????????????????????????????????????????????????\n              19980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732694 ????????????????????????????????????????????????????????????\n              20040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732754 ????????????????????????????????????????????????????????????\n              20100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732814 ????????????????????????????????????????????????????????????\n              20160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732874 ????????????????????????????????????????????????????????????\n              20220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732934 ????????????????????????????????????????????????????????????\n              20280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9732994 ????????????????????????????????????????????????????????????\n              20340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733054 ????????????????????????????????????????????????????????????\n              20400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733114 ????????????????????????????????????????????????????????????\n              20460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733174 ????????????????????????????????????????????????????????????\n              20520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733234 ????????????????????????????????????????????????????????????\n              20580 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733294 ????????????????????????????????????????????????????????????\n              20640 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733354 ????????????????????????????????????????????????????????????\n              20700 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733414 ????????????????????????????????????????????????????????????\n              20760 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733474 ????????????????????????????????????????????????????????????\n              20820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733534 ????????????????????????????????????????????????????????????\n              20880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733594 ????????????????????????????????????????????????????????????\n              20940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733654 ????????????????????????????????????????????????????????????\n              21000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733714 ????????????????????????????????????????????????????????????\n              21060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733774 ????????????????????????????????????????????????????????????\n              21120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733834 ????????????????????????????????????????????????????????????\n              21180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733894 ????????????????????????????????????????????????????????????\n              21240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9733954 ????????????????????????????????????????????????????????????\n              21300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734014 ????????????????????????????????????????????????????????????\n              21360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734074 ????????????????????????????????????????????????????????????\n              21420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734134 ????????????????????????????????????????????????????????????\n              21480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734194 ????????????????????????????????????????????????????????????\n              21540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734254 ????????????????????????????????????????????????????????????\n              21600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734314 ????????????????????????????????????????????????????????????\n              21660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734374 ????????????????????????????????????????????????????????????\n              21720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734434 ????????????????????????????????????????????????????????????\n              21780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734494 ????????????????????????????????????????????????????????????\n              21840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734554 ????????????????????????????????????????????????????????????\n              21900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734614 ????????????????????????????????????????????????????????????\n              21960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734674 ????????????????????????????????????????????????????????????\n              22020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734734 ????????????????????????????????????????????????????????????\n              22080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734794 ????????????????????????????????????????????????????????????\n              22140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734854 ????????????????????????????????????????????????????????????\n              22200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734914 ????????????????????????????????????????????????????????????\n              22260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9734974 ????????????????????????????????????????????????????????????\n              22320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735034 ????????????????????????????????????????????????????????????\n              22380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735094 ????????????????????????????????????????????????????????????\n              22440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735154 ????????????????????????????????????????????????????????????\n              22500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735214 ????????????????????????????????????????????????????????????\n              22560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735274 ????????????????????????????????????????????????????????????\n              22620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735334 ????????????????????????????????????????????????????????????\n              22680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735394 ????????????????????????????????????????????????????????????\n              22740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735454 ????????????????????????????????????????????????????????????\n              22800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735514 ????????????????????????????????????????????????????????????\n              22860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735574 ????????????????????????????????????????????????????????????\n              22920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735634 ????????????????????????????????????????????????????????????\n              22980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735694 ????????????????????????????????????????????????????????????\n              23040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735754 ????????????????????????????????????????????????????????????\n              23100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735814 ????????????????????????????????????????????????????????????\n              23160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735874 ????????????????????????????????????????????????????????????\n              23220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735934 ????????????????????????????????????????????????????????????\n              23280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9735994 ????????????????????????????????????????????????????????????\n              23340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736054 ????????????????????????????????????????????????????????????\n              23400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736114 ????????????????????????????????????????????????????????????\n              23460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736174 ????????????????????????????????????????????????????????????\n              23520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736234 ????????????????????????????????????????????????????????????\n              23580 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736294 ????????????????????????????????????????????????????????????\n              23640 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736354 ????????????????????????????????????????????????????????????\n              23700 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736414 ????????????????????????????????????????????????????????????\n              23760 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736474 ????????????????????????????????????????????????????????????\n              23820 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736534 ????????????????????????????????????????????????????????????\n              23880 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736594 ????????????????????????????????????????????????????????????\n              23940 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736654 ????????????????????????????????????????????????????????????\n              24000 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736714 ????????????????????????????????????????????????????????????\n              24060 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736774 ????????????????????????????????????????????????????????????\n              24120 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736834 ????????????????????????????????????????????????????????????\n              24180 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736894 ????????????????????????????????????????????????????????????\n              24240 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9736954 ????????????????????????????????????????????????????????????\n              24300 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737014 ????????????????????????????????????????????????????????????\n              24360 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737074 ????????????????????????????????????????????????????????????\n              24420 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737134 ????????????????????????????????????????????????????????????\n              24480 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737194 ????????????????????????????????????????????????????????????\n              24540 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737254 ????????????????????????????????????????????????????????????\n              24600 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737314 ????????????????????????????????????????????????????????????\n              24660 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737374 ????????????????????????????????????????????????????????????\n              24720 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737434 ????????????????????????????????????????????????????????????\n              24780 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737494 ????????????????????????????????????????????????????????????\n              24840 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737554 ????????????????????????????????????????????????????????????\n              24900 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737614 ????????????????????????????????????????????????????????????\n              24960 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737674 ????????????????????????????????????????????????????????????\n              25020 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737734 ????????????????????????????????????????????????????????????\n              25080 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737794 ????????????????????????????????????????????????????????????\n              25140 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737854 ????????????????????????????????????????????????????????????\n              25200 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737914 ????????????????????????????????????????????????????????????\n              25260 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9737974 ????????????????????????????????????????????????????????????\n              25320 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738034 ????????????????????????????????????????????????????????????\n              25380 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738094 ????????????????????????????????????????????????????????????\n              25440 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738154 ????????????????????????????????????????????????????????????\n              25500 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738214 ????????????????????????????????????????????????????????????\n              25560 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738274 ????????????????????????????????????????????????????????????\n              25620 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738334 ????????????????????????????????????????????????????????????\n              25680 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738394 ????????????????????????????????????????????????????????????\n              25740 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738454 ????????????????????????????????????????????????????????????\n              25800 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738514 ????????????????????????????????????????????????????????????\n              25860 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738574 ????????????????????????????????????????????????????????????\n              25920 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738634 ????????????????????????????????????????????????????????????\n              25980 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738694 ????????????????????????????????????????????????????????????\n              26040 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738754 ????????????????????????????????????????????????????????????\n              26100 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738814 ????????????????????????????????????????????????????????????\n              26160 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738874 ????????????????????????????????????????????????????????????\n              26220 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738934 ????????????????????????????????????????????????????????????\n              26280 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9738994 ????????????????????????????????????????????????????????????\n              26340 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9739054 ????????????????????????????????????????????????????????????\n              26400 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9739114 ????????????????????????????????????????????????????????????\n              26460 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9739174 ????????????????????????????????????????????????????????????\n              26520 ------------------------------------------------------------\nCAG33136.       423 ------------------------------------------------------------\n\nKI537979    9739234 ????????????????????????????????????????????????????????????\n              26580 ------------------------------||||||||||||||||||||||||||||||\nCAG33136.       423 ------------------------------??????????????????????????????\n\nKI537979    9739294 ????????????????????????????????????????????????????????????\n              26640 |||||||||||||||||||||||||||||||||||||||||||||---------------\nCAG33136.       453 ?????????????????????????????????????????????---------------\n\nKI537979    9739354 ????????????????????????????????????????????????????????????\n              26700 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739414 ????????????????????????????????????????????????????????????\n              26760 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739474 ????????????????????????????????????????????????????????????\n              26820 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739534 ????????????????????????????????????????????????????????????\n              26880 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739594 ????????????????????????????????????????????????????????????\n              26940 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739654 ????????????????????????????????????????????????????????????\n              27000 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739714 ????????????????????????????????????????????????????????????\n              27060 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739774 ????????????????????????????????????????????????????????????\n              27120 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739834 ????????????????????????????????????????????????????????????\n              27180 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739894 ????????????????????????????????????????????????????????????\n              27240 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9739954 ????????????????????????????????????????????????????????????\n              27300 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740014 ????????????????????????????????????????????????????????????\n              27360 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740074 ????????????????????????????????????????????????????????????\n              27420 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740134 ????????????????????????????????????????????????????????????\n              27480 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740194 ????????????????????????????????????????????????????????????\n              27540 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740254 ????????????????????????????????????????????????????????????\n              27600 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740314 ????????????????????????????????????????????????????????????\n              27660 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740374 ????????????????????????????????????????????????????????????\n              27720 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740434 ????????????????????????????????????????????????????????????\n              27780 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740494 ????????????????????????????????????????????????????????????\n              27840 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740554 ????????????????????????????????????????????????????????????\n              27900 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740614 ????????????????????????????????????????????????????????????\n              27960 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740674 ????????????????????????????????????????????????????????????\n              28020 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740734 ????????????????????????????????????????????????????????????\n              28080 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740794 ????????????????????????????????????????????????????????????\n              28140 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740854 ????????????????????????????????????????????????????????????\n              28200 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740914 ????????????????????????????????????????????????????????????\n              28260 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9740974 ????????????????????????????????????????????????????????????\n              28320 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741034 ????????????????????????????????????????????????????????????\n              28380 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741094 ????????????????????????????????????????????????????????????\n              28440 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741154 ????????????????????????????????????????????????????????????\n              28500 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741214 ????????????????????????????????????????????????????????????\n              28560 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741274 ????????????????????????????????????????????????????????????\n              28620 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741334 ????????????????????????????????????????????????????????????\n              28680 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741394 ????????????????????????????????????????????????????????????\n              28740 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741454 ????????????????????????????????????????????????????????????\n              28800 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741514 ????????????????????????????????????????????????????????????\n              28860 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741574 ????????????????????????????????????????????????????????????\n              28920 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741634 ????????????????????????????????????????????????????????????\n              28980 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741694 ????????????????????????????????????????????????????????????\n              29040 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741754 ????????????????????????????????????????????????????????????\n              29100 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741814 ????????????????????????????????????????????????????????????\n              29160 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741874 ????????????????????????????????????????????????????????????\n              29220 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741934 ????????????????????????????????????????????????????????????\n              29280 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9741994 ????????????????????????????????????????????????????????????\n              29340 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742054 ????????????????????????????????????????????????????????????\n              29400 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742114 ????????????????????????????????????????????????????????????\n              29460 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742174 ????????????????????????????????????????????????????????????\n              29520 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742234 ????????????????????????????????????????????????????????????\n              29580 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742294 ????????????????????????????????????????????????????????????\n              29640 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742354 ????????????????????????????????????????????????????????????\n              29700 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742414 ????????????????????????????????????????????????????????????\n              29760 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742474 ????????????????????????????????????????????????????????????\n              29820 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742534 ????????????????????????????????????????????????????????????\n              29880 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742594 ????????????????????????????????????????????????????????????\n              29940 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742654 ????????????????????????????????????????????????????????????\n              30000 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742714 ????????????????????????????????????????????????????????????\n              30060 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742774 ????????????????????????????????????????????????????????????\n              30120 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742834 ????????????????????????????????????????????????????????????\n              30180 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742894 ????????????????????????????????????????????????????????????\n              30240 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9742954 ????????????????????????????????????????????????????????????\n              30300 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743014 ????????????????????????????????????????????????????????????\n              30360 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743074 ????????????????????????????????????????????????????????????\n              30420 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743134 ????????????????????????????????????????????????????????????\n              30480 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743194 ????????????????????????????????????????????????????????????\n              30540 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743254 ????????????????????????????????????????????????????????????\n              30600 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743314 ????????????????????????????????????????????????????????????\n              30660 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743374 ????????????????????????????????????????????????????????????\n              30720 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743434 ????????????????????????????????????????????????????????????\n              30780 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743494 ????????????????????????????????????????????????????????????\n              30840 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743554 ????????????????????????????????????????????????????????????\n              30900 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743614 ????????????????????????????????????????????????????????????\n              30960 ------------------------------------------------------------\nCAG33136.       498 ------------------------------------------------------------\n\nKI537979    9743674 ????????????????????????????????????????????????????????????\n              31020 --------------------------------||||||||||||||||||||||||||||\nCAG33136.       498 --------------------------------????????????????????????????\n\nKI537979    9743734 ????????????????????????????????????????????????????????????\n              31080 ||||||||||||||||||||||||||||||||----------------------------\nCAG33136.       526 ????????????????????????????????----------------------------\n\nKI537979    9743794 ????????????????????????????????????????????????????????????\n              31140 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9743854 ????????????????????????????????????????????????????????????\n              31200 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9743914 ????????????????????????????????????????????????????????????\n              31260 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9743974 ????????????????????????????????????????????????????????????\n              31320 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744034 ????????????????????????????????????????????????????????????\n              31380 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744094 ????????????????????????????????????????????????????????????\n              31440 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744154 ????????????????????????????????????????????????????????????\n              31500 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744214 ????????????????????????????????????????????????????????????\n              31560 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744274 ????????????????????????????????????????????????????????????\n              31620 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744334 ????????????????????????????????????????????????????????????\n              31680 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744394 ????????????????????????????????????????????????????????????\n              31740 ------------------------------------------------------------\nCAG33136.       558 ------------------------------------------------------------\n\nKI537979    9744454 ????????????????????????????????????????????????????????????\n              31800 ---------------------------------------------------------|||\nCAG33136.       558 ---------------------------------------------------------???\n\nKI537979    9744514 ????????????????????????????????????????????????????????????\n              31860 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       561 ????????????????????????????????????????????????????????????\n\nKI537979    9744574 ?????????????????? 9744592\n              31920 ||||||||||||||||||   31938\nCAG33136.       621 ??????????????????     639\n')
        self.assertEqual(format(alignment, 'bed'), 'KI537979\t9712654\t9744592\tCAG33136.1\t972\t+\t9712654\t9744592\t0\t7\t132,156,87,48,75,60,81,\t0,3287,3791,5720,26610,31052,31857,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 792)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'KI538594')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[2103463, 2103523, 2103522, 2104149], [0, 60, 60, 687]])))
        self.assertEqual(str(alignment), 'KI538594    2103463 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.         0 ????????????????????????????????????????????????????????????\n\nKI538594    2103523 \n                 60 \nCAG33136.        60 \n\nKI538594    2103522 ????????????????????????????????????????????????????????????\n                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        60 ????????????????????????????????????????????????????????????\n\nKI538594    2103582 ????????????????????????????????????????????????????????????\n                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       120 ????????????????????????????????????????????????????????????\n\nKI538594    2103642 ????????????????????????????????????????????????????????????\n                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       180 ????????????????????????????????????????????????????????????\n\nKI538594    2103702 ????????????????????????????????????????????????????????????\n                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       240 ????????????????????????????????????????????????????????????\n\nKI538594    2103762 ????????????????????????????????????????????????????????????\n                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       300 ????????????????????????????????????????????????????????????\n\nKI538594    2103822 ????????????????????????????????????????????????????????????\n                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       360 ????????????????????????????????????????????????????????????\n\nKI538594    2103882 ????????????????????????????????????????????????????????????\n                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       420 ????????????????????????????????????????????????????????????\n\nKI538594    2103942 ????????????????????????????????????????????????????????????\n                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       480 ????????????????????????????????????????????????????????????\n\nKI538594    2104002 ????????????????????????????????????????????????????????????\n                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       540 ????????????????????????????????????????????????????????????\n\nKI538594    2104062 ????????????????????????????????????????????????????????????\n                600 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       600 ????????????????????????????????????????????????????????????\n\nKI538594    2104122 ??????????????????????????? 2104149\n                660 |||||||||||||||||||||||||||     687\nCAG33136.       660 ???????????????????????????     687\n')
        self.assertEqual(format(alignment, 'bed'), 'KI538594\t2103463\t2104149\tCAG33136.1\t792\t+\t2103463\t2104149\t0\t2\t60,627,\t0,59,\n')
        alignment = next(alignments)
        self.assertEqual(alignment.score, 902)
        self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1])
        self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1])
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'KI537194')
        self.assertEqual(alignment.query.id, 'CAG33136.1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[20872390, 20872471, 20872472, 20873021], [630, 549, 549, 0]])))
        self.assertEqual(str(alignment), 'KI537194   20872390 ????????????????????????????????????????????????????????????\n                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       630 ????????????????????????????????????????????????????????????\n\nKI537194   20872450 ????????????????????????????????????????????????????????????\n                 60 |||||||||||||||||||||-||||||||||||||||||||||||||||||||||||||\nCAG33136.       570 ?????????????????????-??????????????????????????????????????\n\nKI537194   20872510 ????????????????????????????????????????????????????????????\n                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       511 ????????????????????????????????????????????????????????????\n\nKI537194   20872570 ????????????????????????????????????????????????????????????\n                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       451 ????????????????????????????????????????????????????????????\n\nKI537194   20872630 ????????????????????????????????????????????????????????????\n                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       391 ????????????????????????????????????????????????????????????\n\nKI537194   20872690 ????????????????????????????????????????????????????????????\n                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       331 ????????????????????????????????????????????????????????????\n\nKI537194   20872750 ????????????????????????????????????????????????????????????\n                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       271 ????????????????????????????????????????????????????????????\n\nKI537194   20872810 ????????????????????????????????????????????????????????????\n                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       211 ????????????????????????????????????????????????????????????\n\nKI537194   20872870 ????????????????????????????????????????????????????????????\n                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.       151 ????????????????????????????????????????????????????????????\n\nKI537194   20872930 ????????????????????????????????????????????????????????????\n                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAG33136.        91 ????????????????????????????????????????????????????????????\n\nKI537194   20872990 ??????????????????????????????? 20873021\n                600 |||||||||||||||||||||||||||||||      631\nCAG33136.        31 ???????????????????????????????        0\n')
        self.assertEqual(format(alignment, 'bed'), 'KI537194\t20872390\t20873021\tCAG33136.1\t902\t-\t20872390\t20873021\t0\t2\t81,549,\t0,82,\n')
        self.assertRaises(StopIteration, next, alignments)

    def test_writing_psl_35_002(self):
        if False:
            print('Hello World!')
        'Test writing the alignments in psl_35_002.bed.'
        path = 'Blat/psl_35_002.bed'
        with open(path) as stream:
            original_data = stream.read()
        alignments = Align.parse(path, 'bed')
        stream = StringIO()
        n = Align.write(alignments, stream, 'bed')
        self.assertEqual(n, 3)
        stream.seek(0)
        written_data = stream.read()
        stream.close()
        self.assertEqual(original_data, written_data)

class TestAlign_bed12(unittest.TestCase):

    def test_reading(self):
        if False:
            print('Hello World!')
        'Test parsing alignments in file formats BED3 through BED12.'
        for bedN in (3, 4, 5, 6, 7, 8, 9, 12):
            filename = 'bed%d.bed' % bedN
            path = os.path.join('Blat', filename)
            alignments = Align.parse(path, 'bed')
            alignment = next(alignments)
            if bedN >= 5:
                self.assertEqual(alignment.score, 960, msg=filename)
            self.assertEqual(alignment.shape, (2, 4000), msg=filename)
            self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1], msg=filename)
            self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1], msg=filename)
            self.assertEqual(len(alignment), 2, msg=filename)
            self.assertIs(alignment.sequences[0], alignment.target, msg=filename)
            self.assertIs(alignment.sequences[1], alignment.query, msg=filename)
            self.assertEqual(alignment.target.id, 'chr22', msg=filename)
            if bedN >= 4:
                self.assertEqual(alignment.query.id, 'mRNA1', msg=filename)
            else:
                self.assertIsNone(alignment.query.id, msg=filename)
            if bedN == 12:
                self.assertTrue(np.array_equal(alignment.coordinates, np.array([[1000, 1567, 4512, 5000], [0, 567, 567, 1055]])), msg=filename)
            else:
                self.assertTrue(np.array_equal(alignment.coordinates, np.array([[1000, 5000], [0, 4000]])), msg=filename)
            if bedN >= 7:
                self.assertEqual(alignment.thickStart, 1200, msg=filename)
            if bedN >= 8:
                self.assertEqual(alignment.thickEnd, 4900, msg=filename)
            if bedN >= 9:
                self.assertEqual(alignment.itemRgb, '255,0,0', msg=filename)
            words = ['chr22', '1000', '5000', 'mRNA1', '960', '+', '1200', '4900', '255,0,0', '2', '567,488,', '0,3512,']
            self.assertEqual(alignment.format('bed', bedN), '\t'.join(words[:bedN]) + '\n')
            alignment = next(alignments)
            if bedN >= 5:
                self.assertEqual(alignment.score, 900, msg=filename)
            self.assertEqual(alignment.shape, (2, 4000), msg=filename)
            self.assertLess(alignment.coordinates[0, 0], alignment.coordinates[0, -1], msg=filename)
            if bedN >= 6:
                self.assertGreater(alignment.coordinates[1, 0], alignment.coordinates[1, -1], msg=filename)
            else:
                self.assertLess(alignment.coordinates[1, 0], alignment.coordinates[1, -1], msg=filename)
            self.assertEqual(len(alignment), 2, msg=filename)
            self.assertIs(alignment.sequences[0], alignment.target, msg=filename)
            self.assertIs(alignment.sequences[1], alignment.query, msg=filename)
            self.assertEqual(alignment.target.id, 'chr22', msg=filename)
            if bedN >= 4:
                self.assertEqual(alignment.query.id, 'mRNA2', msg=filename)
            else:
                self.assertIsNone(alignment.query.id, msg=filename)
            if bedN == 12:
                self.assertTrue(np.array_equal(alignment.coordinates, np.array([[2000, 2433, 5601, 6000], [832, 399, 399, 0]])), msg=filename)
            elif bedN >= 6:
                self.assertTrue(np.array_equal(alignment.coordinates, np.array([[2000, 6000], [4000, 0]])), msg=filename)
            else:
                self.assertTrue(np.array_equal(alignment.coordinates, np.array([[2000, 6000], [0, 4000]])), msg=filename)
            if bedN >= 7:
                self.assertEqual(alignment.thickStart, 2300, msg=filename)
            if bedN >= 8:
                self.assertEqual(alignment.thickEnd, 5960, msg=filename)
            if bedN >= 9:
                self.assertEqual(alignment.itemRgb, '0,255,0', msg=filename)
            words = ['chr22', '2000', '6000', 'mRNA2', '900', '-', '2300', '5960', '0,255,0', '2', '433,399,', '0,3601,']
            self.assertEqual(alignment.format('bed', bedN), '\t'.join(words[:bedN]) + '\n')
            with self.assertRaises(StopIteration) as cm:
                next(alignments)
                self.fail(f'More than two alignments reported in {filename}')

    def test_writing(self):
        if False:
            for i in range(10):
                print('nop')
        'Test writing the alignments in bed12.bed as BED3 through BED12.'
        for bedN in (3, 4, 5, 6, 7, 8, 9, 12):
            filename = 'bed%d.bed' % bedN
            path = os.path.join('Blat', filename)
            with open(path) as stream:
                original_data = stream.read()
            alignments = Align.parse(path, 'bed')
            stream = StringIO()
            n = Align.write(alignments, stream, 'bed', bedN=bedN)
            self.assertEqual(n, 2, msg=filename)
            stream.seek(0)
            written_data = stream.read()
            stream.close()
            self.assertEqual(original_data, written_data, msg=filename)

class TestAlign_searching(unittest.TestCase):
    path = 'Blat/bigbedtest.bed'

    def check_alignments(self, alignments):
        if False:
            i = 10
            return i + 15
        alignment = next(alignments)
        self.assertEqual(alignment.score, 1)
        self.assertEqual(alignment.shape, (2, 90))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'name1')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[10, 100], [0, 90]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 2)
        self.assertEqual(alignment.shape, (2, 10))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'name2')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[29, 39], [10, 0]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 3)
        self.assertEqual(alignment.shape, (2, 100))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr1')
        self.assertEqual(alignment.query.id, 'name3')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[200, 300], [0, 100]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 6)
        self.assertEqual(alignment.shape, (2, 0))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'name4')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[50, 50], [0, 0]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 4)
        self.assertEqual(alignment.shape, (2, 10))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'name5')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[100, 110], [0, 10]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 5)
        self.assertEqual(alignment.shape, (2, 10))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'name6')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[200, 210], [0, 10]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 6)
        self.assertEqual(alignment.shape, (2, 0))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr2')
        self.assertEqual(alignment.query.id, 'name7')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[220, 220], [0, 0]])))
        alignment = next(alignments)
        self.assertEqual(alignment.score, 7)
        self.assertEqual(alignment.shape, (2, 0))
        self.assertEqual(len(alignment), 2)
        self.assertIs(alignment.sequences[0], alignment.target)
        self.assertIs(alignment.sequences[1], alignment.query)
        self.assertEqual(alignment.target.id, 'chr3')
        self.assertEqual(alignment.query.id, 'name8')
        self.assertTrue(np.array_equal(alignment.coordinates, np.array([[0, 0], [0, 0]])))

    def test_reading(self):
        if False:
            while True:
                i = 10
        'Test reading bigbedtest.bed.'
        alignments = Align.parse(self.path, 'bed')
        self.check_alignments(alignments)

    def test_writing(self):
        if False:
            return 10
        'Test writing bigbedtest.bed.'
        alignments = Align.parse(self.path, 'bed')
        with tempfile.TemporaryFile('w+t') as output:
            Align.write(alignments, output, 'bed', bedN=6)
            output.seek(0)
            alignments = Align.parse(output, 'bed')
            self.check_alignments(alignments)
if __name__ == '__main__':
    runner = unittest.TextTestRunner(verbosity=2)
    unittest.main(testRunner=runner)