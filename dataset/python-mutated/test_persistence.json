[
    {
        "func_name": "test_enter_exit_side",
        "original": "@pytest.mark.parametrize('is_short', [False, True])\n@pytest.mark.usefixtures('init_persistence')\ndef test_enter_exit_side(fee, is_short):\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=0.001, open_rate=0.01, amount=5, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=2.0, trading_mode=margin)\n    assert trade.entry_side == entry_side\n    assert trade.exit_side == exit_side\n    assert trade.trade_direction == 'short' if is_short else 'long'",
        "mutated": [
            "@pytest.mark.parametrize('is_short', [False, True])\n@pytest.mark.usefixtures('init_persistence')\ndef test_enter_exit_side(fee, is_short):\n    if False:\n        i = 10\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=0.001, open_rate=0.01, amount=5, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=2.0, trading_mode=margin)\n    assert trade.entry_side == entry_side\n    assert trade.exit_side == exit_side\n    assert trade.trade_direction == 'short' if is_short else 'long'",
            "@pytest.mark.parametrize('is_short', [False, True])\n@pytest.mark.usefixtures('init_persistence')\ndef test_enter_exit_side(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=0.001, open_rate=0.01, amount=5, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=2.0, trading_mode=margin)\n    assert trade.entry_side == entry_side\n    assert trade.exit_side == exit_side\n    assert trade.trade_direction == 'short' if is_short else 'long'",
            "@pytest.mark.parametrize('is_short', [False, True])\n@pytest.mark.usefixtures('init_persistence')\ndef test_enter_exit_side(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=0.001, open_rate=0.01, amount=5, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=2.0, trading_mode=margin)\n    assert trade.entry_side == entry_side\n    assert trade.exit_side == exit_side\n    assert trade.trade_direction == 'short' if is_short else 'long'",
            "@pytest.mark.parametrize('is_short', [False, True])\n@pytest.mark.usefixtures('init_persistence')\ndef test_enter_exit_side(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=0.001, open_rate=0.01, amount=5, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=2.0, trading_mode=margin)\n    assert trade.entry_side == entry_side\n    assert trade.exit_side == exit_side\n    assert trade.trade_direction == 'short' if is_short else 'long'",
            "@pytest.mark.parametrize('is_short', [False, True])\n@pytest.mark.usefixtures('init_persistence')\ndef test_enter_exit_side(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=0.001, open_rate=0.01, amount=5, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=2.0, trading_mode=margin)\n    assert trade.entry_side == entry_side\n    assert trade.exit_side == exit_side\n    assert trade.trade_direction == 'short' if is_short else 'long'"
        ]
    },
    {
        "func_name": "test_set_stop_loss_liquidation",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_set_stop_loss_liquidation(fee):\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=False, leverage=2.0, trading_mode=margin)\n    trade.set_liquidation_price(0.09)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2, True)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.08)\n    assert trade.liquidation_price == 0.08\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.11)\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.22, allow_refresh=True)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.602\n    assert trade.stop_loss_pct == -0.22\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(2.1, 0.1)\n    assert trade.liquidation_price == 0.11\n    assert pytest.approx(trade.stop_loss) == 1.994999\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.8\n    assert trade.stoploss_or_liquidation == trade.stop_loss\n    trade.stop_loss = None\n    trade.liquidation_price = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.adjust_stop_loss(2.0, 0.1, True)\n    assert trade.liquidation_price is None\n    assert trade.stop_loss == 1.9\n    assert trade.initial_stop_loss == 1.9\n    assert trade.stoploss_or_liquidation == 1.9\n    trade.is_short = True\n    trade.recalc_open_trade_value()\n    trade.stop_loss = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.set_liquidation_price(3.09)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.1)\n    assert trade.liquidation_price == 3.1\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.8)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3, allow_refresh=True)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.3\n    assert trade.stop_loss_pct == -0.3\n    assert trade.initial_stop_loss == 2.2\n    trade.set_liquidation_price(1.5)\n    trade.adjust_stop_loss(1.8, 0.1)\n    assert trade.liquidation_price == 1.5\n    assert pytest.approx(trade.stop_loss) == 1.89\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 1.5",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_set_stop_loss_liquidation(fee):\n    if False:\n        i = 10\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=False, leverage=2.0, trading_mode=margin)\n    trade.set_liquidation_price(0.09)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2, True)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.08)\n    assert trade.liquidation_price == 0.08\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.11)\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.22, allow_refresh=True)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.602\n    assert trade.stop_loss_pct == -0.22\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(2.1, 0.1)\n    assert trade.liquidation_price == 0.11\n    assert pytest.approx(trade.stop_loss) == 1.994999\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.8\n    assert trade.stoploss_or_liquidation == trade.stop_loss\n    trade.stop_loss = None\n    trade.liquidation_price = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.adjust_stop_loss(2.0, 0.1, True)\n    assert trade.liquidation_price is None\n    assert trade.stop_loss == 1.9\n    assert trade.initial_stop_loss == 1.9\n    assert trade.stoploss_or_liquidation == 1.9\n    trade.is_short = True\n    trade.recalc_open_trade_value()\n    trade.stop_loss = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.set_liquidation_price(3.09)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.1)\n    assert trade.liquidation_price == 3.1\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.8)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3, allow_refresh=True)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.3\n    assert trade.stop_loss_pct == -0.3\n    assert trade.initial_stop_loss == 2.2\n    trade.set_liquidation_price(1.5)\n    trade.adjust_stop_loss(1.8, 0.1)\n    assert trade.liquidation_price == 1.5\n    assert pytest.approx(trade.stop_loss) == 1.89\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 1.5",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_set_stop_loss_liquidation(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=False, leverage=2.0, trading_mode=margin)\n    trade.set_liquidation_price(0.09)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2, True)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.08)\n    assert trade.liquidation_price == 0.08\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.11)\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.22, allow_refresh=True)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.602\n    assert trade.stop_loss_pct == -0.22\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(2.1, 0.1)\n    assert trade.liquidation_price == 0.11\n    assert pytest.approx(trade.stop_loss) == 1.994999\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.8\n    assert trade.stoploss_or_liquidation == trade.stop_loss\n    trade.stop_loss = None\n    trade.liquidation_price = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.adjust_stop_loss(2.0, 0.1, True)\n    assert trade.liquidation_price is None\n    assert trade.stop_loss == 1.9\n    assert trade.initial_stop_loss == 1.9\n    assert trade.stoploss_or_liquidation == 1.9\n    trade.is_short = True\n    trade.recalc_open_trade_value()\n    trade.stop_loss = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.set_liquidation_price(3.09)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.1)\n    assert trade.liquidation_price == 3.1\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.8)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3, allow_refresh=True)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.3\n    assert trade.stop_loss_pct == -0.3\n    assert trade.initial_stop_loss == 2.2\n    trade.set_liquidation_price(1.5)\n    trade.adjust_stop_loss(1.8, 0.1)\n    assert trade.liquidation_price == 1.5\n    assert pytest.approx(trade.stop_loss) == 1.89\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 1.5",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_set_stop_loss_liquidation(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=False, leverage=2.0, trading_mode=margin)\n    trade.set_liquidation_price(0.09)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2, True)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.08)\n    assert trade.liquidation_price == 0.08\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.11)\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.22, allow_refresh=True)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.602\n    assert trade.stop_loss_pct == -0.22\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(2.1, 0.1)\n    assert trade.liquidation_price == 0.11\n    assert pytest.approx(trade.stop_loss) == 1.994999\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.8\n    assert trade.stoploss_or_liquidation == trade.stop_loss\n    trade.stop_loss = None\n    trade.liquidation_price = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.adjust_stop_loss(2.0, 0.1, True)\n    assert trade.liquidation_price is None\n    assert trade.stop_loss == 1.9\n    assert trade.initial_stop_loss == 1.9\n    assert trade.stoploss_or_liquidation == 1.9\n    trade.is_short = True\n    trade.recalc_open_trade_value()\n    trade.stop_loss = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.set_liquidation_price(3.09)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.1)\n    assert trade.liquidation_price == 3.1\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.8)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3, allow_refresh=True)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.3\n    assert trade.stop_loss_pct == -0.3\n    assert trade.initial_stop_loss == 2.2\n    trade.set_liquidation_price(1.5)\n    trade.adjust_stop_loss(1.8, 0.1)\n    assert trade.liquidation_price == 1.5\n    assert pytest.approx(trade.stop_loss) == 1.89\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 1.5",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_set_stop_loss_liquidation(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=False, leverage=2.0, trading_mode=margin)\n    trade.set_liquidation_price(0.09)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2, True)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.08)\n    assert trade.liquidation_price == 0.08\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.11)\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.22, allow_refresh=True)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.602\n    assert trade.stop_loss_pct == -0.22\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(2.1, 0.1)\n    assert trade.liquidation_price == 0.11\n    assert pytest.approx(trade.stop_loss) == 1.994999\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.8\n    assert trade.stoploss_or_liquidation == trade.stop_loss\n    trade.stop_loss = None\n    trade.liquidation_price = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.adjust_stop_loss(2.0, 0.1, True)\n    assert trade.liquidation_price is None\n    assert trade.stop_loss == 1.9\n    assert trade.initial_stop_loss == 1.9\n    assert trade.stoploss_or_liquidation == 1.9\n    trade.is_short = True\n    trade.recalc_open_trade_value()\n    trade.stop_loss = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.set_liquidation_price(3.09)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.1)\n    assert trade.liquidation_price == 3.1\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.8)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3, allow_refresh=True)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.3\n    assert trade.stop_loss_pct == -0.3\n    assert trade.initial_stop_loss == 2.2\n    trade.set_liquidation_price(1.5)\n    trade.adjust_stop_loss(1.8, 0.1)\n    assert trade.liquidation_price == 1.5\n    assert pytest.approx(trade.stop_loss) == 1.89\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 1.5",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_set_stop_loss_liquidation(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=False, leverage=2.0, trading_mode=margin)\n    trade.set_liquidation_price(0.09)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2, True)\n    assert trade.liquidation_price == 0.09\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.08)\n    assert trade.liquidation_price == 0.08\n    assert trade.stop_loss == 1.8\n    assert trade.initial_stop_loss == 1.8\n    trade.set_liquidation_price(0.11)\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.2)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.8\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(1.8, 0.22, allow_refresh=True)\n    assert trade.liquidation_price == 0.11\n    assert trade.stop_loss == 1.602\n    assert trade.stop_loss_pct == -0.22\n    assert trade.initial_stop_loss == 1.8\n    trade.adjust_stop_loss(2.1, 0.1)\n    assert trade.liquidation_price == 0.11\n    assert pytest.approx(trade.stop_loss) == 1.994999\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.8\n    assert trade.stoploss_or_liquidation == trade.stop_loss\n    trade.stop_loss = None\n    trade.liquidation_price = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.adjust_stop_loss(2.0, 0.1, True)\n    assert trade.liquidation_price is None\n    assert trade.stop_loss == 1.9\n    assert trade.initial_stop_loss == 1.9\n    assert trade.stoploss_or_liquidation == 1.9\n    trade.is_short = True\n    trade.recalc_open_trade_value()\n    trade.stop_loss = None\n    trade.initial_stop_loss = None\n    trade.initial_stop_loss_pct = None\n    trade.set_liquidation_price(3.09)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss is None\n    assert trade.initial_stop_loss is None\n    trade.adjust_stop_loss(2.0, 0.2)\n    assert trade.liquidation_price == 3.09\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.1)\n    assert trade.liquidation_price == 3.1\n    assert trade.stop_loss == 2.2\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 2.2\n    trade.set_liquidation_price(3.8)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.2\n    assert trade.stop_loss_pct == -0.2\n    assert trade.initial_stop_loss == 2.2\n    trade.adjust_stop_loss(2.0, 0.3, allow_refresh=True)\n    assert trade.liquidation_price == 3.8\n    assert trade.stop_loss == 2.3\n    assert trade.stop_loss_pct == -0.3\n    assert trade.initial_stop_loss == 2.2\n    trade.set_liquidation_price(1.5)\n    trade.adjust_stop_loss(1.8, 0.1)\n    assert trade.liquidation_price == 1.5\n    assert pytest.approx(trade.stop_loss) == 1.89\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 2.2\n    assert trade.stoploss_or_liquidation == 1.5"
        ]
    },
    {
        "func_name": "test_interest",
        "original": "@pytest.mark.parametrize('exchange,is_short,lev,minutes,rate,interest,trading_mode', [('binance', False, 3, 10, 0.0005, round(0.0008333333333333334, 8), margin), ('binance', True, 3, 10, 0.0005, 0.000625, margin), ('binance', False, 3, 295, 0.0005, round(0.004166666666666667, 8), margin), ('binance', True, 3, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 3, 295, 0.00025, round(0.0020833333333333333, 8), margin), ('binance', True, 3, 295, 0.00025, round(0.0015624999999999999, 8), margin), ('binance', False, 5, 295, 0.0005, 0.005, margin), ('binance', True, 5, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 1, 295, 0.0005, 0.0, spot), ('binance', True, 1, 295, 0.0005, 0.003125, margin), ('binance', False, 3, 10, 0.0005, 0.0, futures), ('binance', True, 3, 295, 0.0005, 0.0, futures), ('binance', False, 5, 295, 0.0005, 0.0, futures), ('binance', True, 5, 295, 0.0005, 0.0, futures), ('binance', False, 1, 295, 0.0005, 0.0, futures), ('binance', True, 1, 295, 0.0005, 0.0, futures), ('kraken', False, 3, 10, 0.0005, 0.04, margin), ('kraken', True, 3, 10, 0.0005, 0.03, margin), ('kraken', False, 3, 295, 0.0005, 0.06, margin), ('kraken', True, 3, 295, 0.0005, 0.045, margin), ('kraken', False, 3, 295, 0.00025, 0.03, margin), ('kraken', True, 3, 295, 0.00025, 0.0225, margin), ('kraken', False, 5, 295, 0.0005, round(0.07200000000000001, 8), margin), ('kraken', True, 5, 295, 0.0005, 0.045, margin), ('kraken', False, 1, 295, 0.0005, 0.0, spot), ('kraken', True, 1, 295, 0.0005, 0.045, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_interest(fee, exchange, is_short, lev, minutes, rate, interest, trading_mode):\n    \"\"\"\n        10min, 5hr limit trade on Binance/Kraken at 3x,5x leverage\n        fee: 0.25 % quote\n        interest_rate: 0.05 % per 4 hrs\n        open_rate: 2.00 quote\n        close_rate: 2.20 quote\n        amount: = 30.0 crypto\n        stake_amount\n            3x, -3x: 20.0  quote\n            5x, -5x: 12.0  quote\n        borrowed\n          10min\n             3x: 40 quote\n            -3x: 30 crypto\n             5x: 48 quote\n            -5x: 30 crypto\n             1x: 0\n            -1x: 30 crypto\n        hours: 1/6 (10 minutes)\n        time-periods:\n            10min\n                kraken: (1 + 1) 4hr_periods = 2 4hr_periods\n                binance: 1/24 24hr_periods\n            4.95hr\n                kraken: ceil(1 + 4.95/4) 4hr_periods = 3 4hr_periods\n                binance: ceil(4.95)/24 24hr_periods = 5/24 24hr_periods\n        interest: borrowed * interest_rate * time-periods\n          10min\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\n            binace     -3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\n            kraken     -3x: 30 * 0.0005 * 2    = 0.030 crypto\n          5hr\n            binance     3x: 40 * 0.0005 * 5/24 = 0.004166666666666667 quote\n            kraken      3x: 40 * 0.0005 * 3    = 0.06 quote\n            binace     -3x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\n            kraken     -3x: 30 * 0.0005 * 3    = 0.045 crypto\n          0.00025 interest\n            binance     3x: 40 * 0.00025 * 5/24 = 0.0020833333333333333 quote\n            kraken      3x: 40 * 0.00025 * 3    = 0.03 quote\n            binace     -3x: 30 * 0.00025 * 5/24 = 0.0015624999999999999 crypto\n            kraken     -3x: 30 * 0.00025 * 3    = 0.0225 crypto\n          5x leverage, 0.0005 interest, 5hr\n            binance     5x: 48 * 0.0005 * 5/24 = 0.005 quote\n            kraken      5x: 48 * 0.0005 * 3    = 0.07200000000000001 quote\n            binace     -5x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\n            kraken     -5x: 30 * 0.0005 * 3    = 0.045 crypto\n          1x leverage, 0.0005 interest, 5hr\n            binance,kraken 1x: 0.0 quote\n            binace        -1x: 30 * 0.0005 * 5/24 = 0.003125 crypto\n            kraken        -1x: 30 * 0.0005 * 3    = 0.045 crypto\n    \"\"\"\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=minutes), fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, leverage=lev, interest_rate=rate, is_short=is_short, trading_mode=trading_mode)\n    assert round(float(trade.calculate_interest()), 8) == interest",
        "mutated": [
            "@pytest.mark.parametrize('exchange,is_short,lev,minutes,rate,interest,trading_mode', [('binance', False, 3, 10, 0.0005, round(0.0008333333333333334, 8), margin), ('binance', True, 3, 10, 0.0005, 0.000625, margin), ('binance', False, 3, 295, 0.0005, round(0.004166666666666667, 8), margin), ('binance', True, 3, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 3, 295, 0.00025, round(0.0020833333333333333, 8), margin), ('binance', True, 3, 295, 0.00025, round(0.0015624999999999999, 8), margin), ('binance', False, 5, 295, 0.0005, 0.005, margin), ('binance', True, 5, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 1, 295, 0.0005, 0.0, spot), ('binance', True, 1, 295, 0.0005, 0.003125, margin), ('binance', False, 3, 10, 0.0005, 0.0, futures), ('binance', True, 3, 295, 0.0005, 0.0, futures), ('binance', False, 5, 295, 0.0005, 0.0, futures), ('binance', True, 5, 295, 0.0005, 0.0, futures), ('binance', False, 1, 295, 0.0005, 0.0, futures), ('binance', True, 1, 295, 0.0005, 0.0, futures), ('kraken', False, 3, 10, 0.0005, 0.04, margin), ('kraken', True, 3, 10, 0.0005, 0.03, margin), ('kraken', False, 3, 295, 0.0005, 0.06, margin), ('kraken', True, 3, 295, 0.0005, 0.045, margin), ('kraken', False, 3, 295, 0.00025, 0.03, margin), ('kraken', True, 3, 295, 0.00025, 0.0225, margin), ('kraken', False, 5, 295, 0.0005, round(0.07200000000000001, 8), margin), ('kraken', True, 5, 295, 0.0005, 0.045, margin), ('kraken', False, 1, 295, 0.0005, 0.0, spot), ('kraken', True, 1, 295, 0.0005, 0.045, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_interest(fee, exchange, is_short, lev, minutes, rate, interest, trading_mode):\n    if False:\n        i = 10\n    '\\n        10min, 5hr limit trade on Binance/Kraken at 3x,5x leverage\\n        fee: 0.25 % quote\\n        interest_rate: 0.05 % per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            3x, -3x: 20.0  quote\\n            5x, -5x: 12.0  quote\\n        borrowed\\n          10min\\n             3x: 40 quote\\n            -3x: 30 crypto\\n             5x: 48 quote\\n            -5x: 30 crypto\\n             1x: 0\\n            -1x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            10min\\n                kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n                binance: 1/24 24hr_periods\\n            4.95hr\\n                kraken: ceil(1 + 4.95/4) 4hr_periods = 3 4hr_periods\\n                binance: ceil(4.95)/24 24hr_periods = 5/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n          10min\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace     -3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken     -3x: 30 * 0.0005 * 2    = 0.030 crypto\\n          5hr\\n            binance     3x: 40 * 0.0005 * 5/24 = 0.004166666666666667 quote\\n            kraken      3x: 40 * 0.0005 * 3    = 0.06 quote\\n            binace     -3x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -3x: 30 * 0.0005 * 3    = 0.045 crypto\\n          0.00025 interest\\n            binance     3x: 40 * 0.00025 * 5/24 = 0.0020833333333333333 quote\\n            kraken      3x: 40 * 0.00025 * 3    = 0.03 quote\\n            binace     -3x: 30 * 0.00025 * 5/24 = 0.0015624999999999999 crypto\\n            kraken     -3x: 30 * 0.00025 * 3    = 0.0225 crypto\\n          5x leverage, 0.0005 interest, 5hr\\n            binance     5x: 48 * 0.0005 * 5/24 = 0.005 quote\\n            kraken      5x: 48 * 0.0005 * 3    = 0.07200000000000001 quote\\n            binace     -5x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -5x: 30 * 0.0005 * 3    = 0.045 crypto\\n          1x leverage, 0.0005 interest, 5hr\\n            binance,kraken 1x: 0.0 quote\\n            binace        -1x: 30 * 0.0005 * 5/24 = 0.003125 crypto\\n            kraken        -1x: 30 * 0.0005 * 3    = 0.045 crypto\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=minutes), fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, leverage=lev, interest_rate=rate, is_short=is_short, trading_mode=trading_mode)\n    assert round(float(trade.calculate_interest()), 8) == interest",
            "@pytest.mark.parametrize('exchange,is_short,lev,minutes,rate,interest,trading_mode', [('binance', False, 3, 10, 0.0005, round(0.0008333333333333334, 8), margin), ('binance', True, 3, 10, 0.0005, 0.000625, margin), ('binance', False, 3, 295, 0.0005, round(0.004166666666666667, 8), margin), ('binance', True, 3, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 3, 295, 0.00025, round(0.0020833333333333333, 8), margin), ('binance', True, 3, 295, 0.00025, round(0.0015624999999999999, 8), margin), ('binance', False, 5, 295, 0.0005, 0.005, margin), ('binance', True, 5, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 1, 295, 0.0005, 0.0, spot), ('binance', True, 1, 295, 0.0005, 0.003125, margin), ('binance', False, 3, 10, 0.0005, 0.0, futures), ('binance', True, 3, 295, 0.0005, 0.0, futures), ('binance', False, 5, 295, 0.0005, 0.0, futures), ('binance', True, 5, 295, 0.0005, 0.0, futures), ('binance', False, 1, 295, 0.0005, 0.0, futures), ('binance', True, 1, 295, 0.0005, 0.0, futures), ('kraken', False, 3, 10, 0.0005, 0.04, margin), ('kraken', True, 3, 10, 0.0005, 0.03, margin), ('kraken', False, 3, 295, 0.0005, 0.06, margin), ('kraken', True, 3, 295, 0.0005, 0.045, margin), ('kraken', False, 3, 295, 0.00025, 0.03, margin), ('kraken', True, 3, 295, 0.00025, 0.0225, margin), ('kraken', False, 5, 295, 0.0005, round(0.07200000000000001, 8), margin), ('kraken', True, 5, 295, 0.0005, 0.045, margin), ('kraken', False, 1, 295, 0.0005, 0.0, spot), ('kraken', True, 1, 295, 0.0005, 0.045, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_interest(fee, exchange, is_short, lev, minutes, rate, interest, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    '\\n        10min, 5hr limit trade on Binance/Kraken at 3x,5x leverage\\n        fee: 0.25 % quote\\n        interest_rate: 0.05 % per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            3x, -3x: 20.0  quote\\n            5x, -5x: 12.0  quote\\n        borrowed\\n          10min\\n             3x: 40 quote\\n            -3x: 30 crypto\\n             5x: 48 quote\\n            -5x: 30 crypto\\n             1x: 0\\n            -1x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            10min\\n                kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n                binance: 1/24 24hr_periods\\n            4.95hr\\n                kraken: ceil(1 + 4.95/4) 4hr_periods = 3 4hr_periods\\n                binance: ceil(4.95)/24 24hr_periods = 5/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n          10min\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace     -3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken     -3x: 30 * 0.0005 * 2    = 0.030 crypto\\n          5hr\\n            binance     3x: 40 * 0.0005 * 5/24 = 0.004166666666666667 quote\\n            kraken      3x: 40 * 0.0005 * 3    = 0.06 quote\\n            binace     -3x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -3x: 30 * 0.0005 * 3    = 0.045 crypto\\n          0.00025 interest\\n            binance     3x: 40 * 0.00025 * 5/24 = 0.0020833333333333333 quote\\n            kraken      3x: 40 * 0.00025 * 3    = 0.03 quote\\n            binace     -3x: 30 * 0.00025 * 5/24 = 0.0015624999999999999 crypto\\n            kraken     -3x: 30 * 0.00025 * 3    = 0.0225 crypto\\n          5x leverage, 0.0005 interest, 5hr\\n            binance     5x: 48 * 0.0005 * 5/24 = 0.005 quote\\n            kraken      5x: 48 * 0.0005 * 3    = 0.07200000000000001 quote\\n            binace     -5x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -5x: 30 * 0.0005 * 3    = 0.045 crypto\\n          1x leverage, 0.0005 interest, 5hr\\n            binance,kraken 1x: 0.0 quote\\n            binace        -1x: 30 * 0.0005 * 5/24 = 0.003125 crypto\\n            kraken        -1x: 30 * 0.0005 * 3    = 0.045 crypto\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=minutes), fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, leverage=lev, interest_rate=rate, is_short=is_short, trading_mode=trading_mode)\n    assert round(float(trade.calculate_interest()), 8) == interest",
            "@pytest.mark.parametrize('exchange,is_short,lev,minutes,rate,interest,trading_mode', [('binance', False, 3, 10, 0.0005, round(0.0008333333333333334, 8), margin), ('binance', True, 3, 10, 0.0005, 0.000625, margin), ('binance', False, 3, 295, 0.0005, round(0.004166666666666667, 8), margin), ('binance', True, 3, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 3, 295, 0.00025, round(0.0020833333333333333, 8), margin), ('binance', True, 3, 295, 0.00025, round(0.0015624999999999999, 8), margin), ('binance', False, 5, 295, 0.0005, 0.005, margin), ('binance', True, 5, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 1, 295, 0.0005, 0.0, spot), ('binance', True, 1, 295, 0.0005, 0.003125, margin), ('binance', False, 3, 10, 0.0005, 0.0, futures), ('binance', True, 3, 295, 0.0005, 0.0, futures), ('binance', False, 5, 295, 0.0005, 0.0, futures), ('binance', True, 5, 295, 0.0005, 0.0, futures), ('binance', False, 1, 295, 0.0005, 0.0, futures), ('binance', True, 1, 295, 0.0005, 0.0, futures), ('kraken', False, 3, 10, 0.0005, 0.04, margin), ('kraken', True, 3, 10, 0.0005, 0.03, margin), ('kraken', False, 3, 295, 0.0005, 0.06, margin), ('kraken', True, 3, 295, 0.0005, 0.045, margin), ('kraken', False, 3, 295, 0.00025, 0.03, margin), ('kraken', True, 3, 295, 0.00025, 0.0225, margin), ('kraken', False, 5, 295, 0.0005, round(0.07200000000000001, 8), margin), ('kraken', True, 5, 295, 0.0005, 0.045, margin), ('kraken', False, 1, 295, 0.0005, 0.0, spot), ('kraken', True, 1, 295, 0.0005, 0.045, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_interest(fee, exchange, is_short, lev, minutes, rate, interest, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    '\\n        10min, 5hr limit trade on Binance/Kraken at 3x,5x leverage\\n        fee: 0.25 % quote\\n        interest_rate: 0.05 % per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            3x, -3x: 20.0  quote\\n            5x, -5x: 12.0  quote\\n        borrowed\\n          10min\\n             3x: 40 quote\\n            -3x: 30 crypto\\n             5x: 48 quote\\n            -5x: 30 crypto\\n             1x: 0\\n            -1x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            10min\\n                kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n                binance: 1/24 24hr_periods\\n            4.95hr\\n                kraken: ceil(1 + 4.95/4) 4hr_periods = 3 4hr_periods\\n                binance: ceil(4.95)/24 24hr_periods = 5/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n          10min\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace     -3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken     -3x: 30 * 0.0005 * 2    = 0.030 crypto\\n          5hr\\n            binance     3x: 40 * 0.0005 * 5/24 = 0.004166666666666667 quote\\n            kraken      3x: 40 * 0.0005 * 3    = 0.06 quote\\n            binace     -3x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -3x: 30 * 0.0005 * 3    = 0.045 crypto\\n          0.00025 interest\\n            binance     3x: 40 * 0.00025 * 5/24 = 0.0020833333333333333 quote\\n            kraken      3x: 40 * 0.00025 * 3    = 0.03 quote\\n            binace     -3x: 30 * 0.00025 * 5/24 = 0.0015624999999999999 crypto\\n            kraken     -3x: 30 * 0.00025 * 3    = 0.0225 crypto\\n          5x leverage, 0.0005 interest, 5hr\\n            binance     5x: 48 * 0.0005 * 5/24 = 0.005 quote\\n            kraken      5x: 48 * 0.0005 * 3    = 0.07200000000000001 quote\\n            binace     -5x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -5x: 30 * 0.0005 * 3    = 0.045 crypto\\n          1x leverage, 0.0005 interest, 5hr\\n            binance,kraken 1x: 0.0 quote\\n            binace        -1x: 30 * 0.0005 * 5/24 = 0.003125 crypto\\n            kraken        -1x: 30 * 0.0005 * 3    = 0.045 crypto\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=minutes), fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, leverage=lev, interest_rate=rate, is_short=is_short, trading_mode=trading_mode)\n    assert round(float(trade.calculate_interest()), 8) == interest",
            "@pytest.mark.parametrize('exchange,is_short,lev,minutes,rate,interest,trading_mode', [('binance', False, 3, 10, 0.0005, round(0.0008333333333333334, 8), margin), ('binance', True, 3, 10, 0.0005, 0.000625, margin), ('binance', False, 3, 295, 0.0005, round(0.004166666666666667, 8), margin), ('binance', True, 3, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 3, 295, 0.00025, round(0.0020833333333333333, 8), margin), ('binance', True, 3, 295, 0.00025, round(0.0015624999999999999, 8), margin), ('binance', False, 5, 295, 0.0005, 0.005, margin), ('binance', True, 5, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 1, 295, 0.0005, 0.0, spot), ('binance', True, 1, 295, 0.0005, 0.003125, margin), ('binance', False, 3, 10, 0.0005, 0.0, futures), ('binance', True, 3, 295, 0.0005, 0.0, futures), ('binance', False, 5, 295, 0.0005, 0.0, futures), ('binance', True, 5, 295, 0.0005, 0.0, futures), ('binance', False, 1, 295, 0.0005, 0.0, futures), ('binance', True, 1, 295, 0.0005, 0.0, futures), ('kraken', False, 3, 10, 0.0005, 0.04, margin), ('kraken', True, 3, 10, 0.0005, 0.03, margin), ('kraken', False, 3, 295, 0.0005, 0.06, margin), ('kraken', True, 3, 295, 0.0005, 0.045, margin), ('kraken', False, 3, 295, 0.00025, 0.03, margin), ('kraken', True, 3, 295, 0.00025, 0.0225, margin), ('kraken', False, 5, 295, 0.0005, round(0.07200000000000001, 8), margin), ('kraken', True, 5, 295, 0.0005, 0.045, margin), ('kraken', False, 1, 295, 0.0005, 0.0, spot), ('kraken', True, 1, 295, 0.0005, 0.045, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_interest(fee, exchange, is_short, lev, minutes, rate, interest, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    '\\n        10min, 5hr limit trade on Binance/Kraken at 3x,5x leverage\\n        fee: 0.25 % quote\\n        interest_rate: 0.05 % per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            3x, -3x: 20.0  quote\\n            5x, -5x: 12.0  quote\\n        borrowed\\n          10min\\n             3x: 40 quote\\n            -3x: 30 crypto\\n             5x: 48 quote\\n            -5x: 30 crypto\\n             1x: 0\\n            -1x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            10min\\n                kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n                binance: 1/24 24hr_periods\\n            4.95hr\\n                kraken: ceil(1 + 4.95/4) 4hr_periods = 3 4hr_periods\\n                binance: ceil(4.95)/24 24hr_periods = 5/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n          10min\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace     -3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken     -3x: 30 * 0.0005 * 2    = 0.030 crypto\\n          5hr\\n            binance     3x: 40 * 0.0005 * 5/24 = 0.004166666666666667 quote\\n            kraken      3x: 40 * 0.0005 * 3    = 0.06 quote\\n            binace     -3x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -3x: 30 * 0.0005 * 3    = 0.045 crypto\\n          0.00025 interest\\n            binance     3x: 40 * 0.00025 * 5/24 = 0.0020833333333333333 quote\\n            kraken      3x: 40 * 0.00025 * 3    = 0.03 quote\\n            binace     -3x: 30 * 0.00025 * 5/24 = 0.0015624999999999999 crypto\\n            kraken     -3x: 30 * 0.00025 * 3    = 0.0225 crypto\\n          5x leverage, 0.0005 interest, 5hr\\n            binance     5x: 48 * 0.0005 * 5/24 = 0.005 quote\\n            kraken      5x: 48 * 0.0005 * 3    = 0.07200000000000001 quote\\n            binace     -5x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -5x: 30 * 0.0005 * 3    = 0.045 crypto\\n          1x leverage, 0.0005 interest, 5hr\\n            binance,kraken 1x: 0.0 quote\\n            binace        -1x: 30 * 0.0005 * 5/24 = 0.003125 crypto\\n            kraken        -1x: 30 * 0.0005 * 3    = 0.045 crypto\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=minutes), fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, leverage=lev, interest_rate=rate, is_short=is_short, trading_mode=trading_mode)\n    assert round(float(trade.calculate_interest()), 8) == interest",
            "@pytest.mark.parametrize('exchange,is_short,lev,minutes,rate,interest,trading_mode', [('binance', False, 3, 10, 0.0005, round(0.0008333333333333334, 8), margin), ('binance', True, 3, 10, 0.0005, 0.000625, margin), ('binance', False, 3, 295, 0.0005, round(0.004166666666666667, 8), margin), ('binance', True, 3, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 3, 295, 0.00025, round(0.0020833333333333333, 8), margin), ('binance', True, 3, 295, 0.00025, round(0.0015624999999999999, 8), margin), ('binance', False, 5, 295, 0.0005, 0.005, margin), ('binance', True, 5, 295, 0.0005, round(0.0031249999999999997, 8), margin), ('binance', False, 1, 295, 0.0005, 0.0, spot), ('binance', True, 1, 295, 0.0005, 0.003125, margin), ('binance', False, 3, 10, 0.0005, 0.0, futures), ('binance', True, 3, 295, 0.0005, 0.0, futures), ('binance', False, 5, 295, 0.0005, 0.0, futures), ('binance', True, 5, 295, 0.0005, 0.0, futures), ('binance', False, 1, 295, 0.0005, 0.0, futures), ('binance', True, 1, 295, 0.0005, 0.0, futures), ('kraken', False, 3, 10, 0.0005, 0.04, margin), ('kraken', True, 3, 10, 0.0005, 0.03, margin), ('kraken', False, 3, 295, 0.0005, 0.06, margin), ('kraken', True, 3, 295, 0.0005, 0.045, margin), ('kraken', False, 3, 295, 0.00025, 0.03, margin), ('kraken', True, 3, 295, 0.00025, 0.0225, margin), ('kraken', False, 5, 295, 0.0005, round(0.07200000000000001, 8), margin), ('kraken', True, 5, 295, 0.0005, 0.045, margin), ('kraken', False, 1, 295, 0.0005, 0.0, spot), ('kraken', True, 1, 295, 0.0005, 0.045, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_interest(fee, exchange, is_short, lev, minutes, rate, interest, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    '\\n        10min, 5hr limit trade on Binance/Kraken at 3x,5x leverage\\n        fee: 0.25 % quote\\n        interest_rate: 0.05 % per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            3x, -3x: 20.0  quote\\n            5x, -5x: 12.0  quote\\n        borrowed\\n          10min\\n             3x: 40 quote\\n            -3x: 30 crypto\\n             5x: 48 quote\\n            -5x: 30 crypto\\n             1x: 0\\n            -1x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            10min\\n                kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n                binance: 1/24 24hr_periods\\n            4.95hr\\n                kraken: ceil(1 + 4.95/4) 4hr_periods = 3 4hr_periods\\n                binance: ceil(4.95)/24 24hr_periods = 5/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n          10min\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace     -3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken     -3x: 30 * 0.0005 * 2    = 0.030 crypto\\n          5hr\\n            binance     3x: 40 * 0.0005 * 5/24 = 0.004166666666666667 quote\\n            kraken      3x: 40 * 0.0005 * 3    = 0.06 quote\\n            binace     -3x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -3x: 30 * 0.0005 * 3    = 0.045 crypto\\n          0.00025 interest\\n            binance     3x: 40 * 0.00025 * 5/24 = 0.0020833333333333333 quote\\n            kraken      3x: 40 * 0.00025 * 3    = 0.03 quote\\n            binace     -3x: 30 * 0.00025 * 5/24 = 0.0015624999999999999 crypto\\n            kraken     -3x: 30 * 0.00025 * 3    = 0.0225 crypto\\n          5x leverage, 0.0005 interest, 5hr\\n            binance     5x: 48 * 0.0005 * 5/24 = 0.005 quote\\n            kraken      5x: 48 * 0.0005 * 3    = 0.07200000000000001 quote\\n            binace     -5x: 30 * 0.0005 * 5/24 = 0.0031249999999999997 crypto\\n            kraken     -5x: 30 * 0.0005 * 3    = 0.045 crypto\\n          1x leverage, 0.0005 interest, 5hr\\n            binance,kraken 1x: 0.0 quote\\n            binace        -1x: 30 * 0.0005 * 5/24 = 0.003125 crypto\\n            kraken        -1x: 30 * 0.0005 * 3    = 0.045 crypto\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=minutes), fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, leverage=lev, interest_rate=rate, is_short=is_short, trading_mode=trading_mode)\n    assert round(float(trade.calculate_interest()), 8) == interest"
        ]
    },
    {
        "func_name": "test_borrowed",
        "original": "@pytest.mark.parametrize('is_short,lev,borrowed,trading_mode', [(False, 1.0, 0.0, spot), (True, 1.0, 30.0, margin), (False, 3.0, 40.0, margin), (True, 3.0, 30.0, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_borrowed(fee, is_short, lev, borrowed, trading_mode):\n    \"\"\"\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\n        fee: 0.25% quote\n        interest_rate: 0.05% per 4 hrs\n        open_rate: 2.00 quote\n        close_rate: 2.20 quote\n        amount: = 30.0 crypto\n        stake_amount\n            1x,-1x: 60.0  quote\n            3x,-3x: 20.0  quote\n        borrowed\n             1x:  0 quote\n             3x: 40 quote\n            -1x: 30 crypto\n            -3x: 30 crypto\n        hours: 1/6 (10 minutes)\n        time-periods:\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\n            binance: 1/24 24hr_periods\n        interest: borrowed * interest_rate * time-periods\n            1x            :  /\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\n        amount_closed:\n            1x, 3x         : amount\n            -1x, -3x       : amount + interest\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\n        close_value:\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\n        total_profit:\n            1x, 3x : close_value - open_value\n            -1x,-3x: open_value  - close_value\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\n            kraken         3x: 65.795 - 60.15             = 5.645\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\n        total_profit_ratio:\n            1x, 3x : ((close_value/open_value) - 1) * leverage\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\n    \"\"\"\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    assert trade.borrowed == borrowed",
        "mutated": [
            "@pytest.mark.parametrize('is_short,lev,borrowed,trading_mode', [(False, 1.0, 0.0, spot), (True, 1.0, 30.0, margin), (False, 3.0, 40.0, margin), (True, 3.0, 30.0, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_borrowed(fee, is_short, lev, borrowed, trading_mode):\n    if False:\n        i = 10\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n    '\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    assert trade.borrowed == borrowed",
            "@pytest.mark.parametrize('is_short,lev,borrowed,trading_mode', [(False, 1.0, 0.0, spot), (True, 1.0, 30.0, margin), (False, 3.0, 40.0, margin), (True, 3.0, 30.0, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_borrowed(fee, is_short, lev, borrowed, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n    '\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    assert trade.borrowed == borrowed",
            "@pytest.mark.parametrize('is_short,lev,borrowed,trading_mode', [(False, 1.0, 0.0, spot), (True, 1.0, 30.0, margin), (False, 3.0, 40.0, margin), (True, 3.0, 30.0, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_borrowed(fee, is_short, lev, borrowed, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n    '\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    assert trade.borrowed == borrowed",
            "@pytest.mark.parametrize('is_short,lev,borrowed,trading_mode', [(False, 1.0, 0.0, spot), (True, 1.0, 30.0, margin), (False, 3.0, 40.0, margin), (True, 3.0, 30.0, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_borrowed(fee, is_short, lev, borrowed, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n    '\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    assert trade.borrowed == borrowed",
            "@pytest.mark.parametrize('is_short,lev,borrowed,trading_mode', [(False, 1.0, 0.0, spot), (True, 1.0, 30.0, margin), (False, 3.0, 40.0, margin), (True, 3.0, 30.0, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_borrowed(fee, is_short, lev, borrowed, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n    '\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    assert trade.borrowed == borrowed"
        ]
    },
    {
        "func_name": "test_update_limit_order",
        "original": "@pytest.mark.parametrize('is_short,open_rate,close_rate,lev,profit,trading_mode', [(False, 2.0, 2.2, 1.0, 0.09451372, spot), (True, 2.2, 2.0, 3.0, 0.25894253, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_update_limit_order(fee, caplog, limit_buy_order_usdt, limit_sell_order_usdt, time_machine, is_short, open_rate, close_rate, lev, profit, trading_mode):\n    \"\"\"\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\n        fee: 0.25% quote\n        interest_rate: 0.05% per 4 hrs\n        open_rate: 2.00 quote\n        close_rate: 2.20 quote\n        amount: = 30.0 crypto\n        stake_amount\n            1x,-1x: 60.0  quote\n            3x,-3x: 20.0  quote\n        borrowed\n             1x:  0 quote\n             3x: 40 quote\n            -1x: 30 crypto\n            -3x: 30 crypto\n        hours: 1/6 (10 minutes)\n        time-periods:\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\n            binance: 1/24 24hr_periods\n        interest: borrowed * interest_rate * time-periods\n            1x            :  /\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\n        amount_closed:\n            1x, 3x         : amount\n            -1x, -3x       : amount + interest\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\n        close_value:\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\n        total_profit:\n            1x, 3x : close_value - open_value\n            -1x,-3x: open_value  - close_value\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\n            kraken         3x: 65.795 - 60.15             = 5.645\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\n        total_profit_ratio:\n            1x, 3x : ((close_value/open_value) - 1) * leverage\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\n        open_rate: 2.2, close_rate: 2.0, -3x, binance, short\n            open_value: 30 * 2.2 - 30 * 2.2 * 0.0025 = 65.835 quote\n            amount_closed: 30 + 0.000625 = 30.000625 crypto\n            close_value: (30.000625 * 2.0) + (30.000625 * 2.0 * 0.0025) = 60.151253125\n            total_profit: 65.835 - 60.151253125 = 5.683746874999997\n            total_profit_ratio: (1-(60.151253125/65.835)) * 3 = 0.2589996297562085\n\n    \"\"\"\n    time_machine.move_to('2022-03-31 20:45:00 +00:00')\n    enter_order = limit_sell_order_usdt if is_short else limit_buy_order_usdt\n    exit_order = limit_buy_order_usdt if is_short else limit_sell_order_usdt\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=open_rate, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, interest_rate=0.0005, leverage=lev, trading_mode=trading_mode)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    oobj = Order.parse_from_ccxt_object(enter_order, 'ADA/USDT', entry_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == open_rate\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re(f'LIMIT_{entry_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    time_machine.move_to('2022-03-31 21:45:05 +00:00')\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', exit_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == close_rate\n    assert pytest.approx(trade.close_profit) == profit\n    assert trade.close_date is not None\n    assert log_has_re(f'LIMIT_{exit_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()",
        "mutated": [
            "@pytest.mark.parametrize('is_short,open_rate,close_rate,lev,profit,trading_mode', [(False, 2.0, 2.2, 1.0, 0.09451372, spot), (True, 2.2, 2.0, 3.0, 0.25894253, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_update_limit_order(fee, caplog, limit_buy_order_usdt, limit_sell_order_usdt, time_machine, is_short, open_rate, close_rate, lev, profit, trading_mode):\n    if False:\n        i = 10\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n        open_rate: 2.2, close_rate: 2.0, -3x, binance, short\\n            open_value: 30 * 2.2 - 30 * 2.2 * 0.0025 = 65.835 quote\\n            amount_closed: 30 + 0.000625 = 30.000625 crypto\\n            close_value: (30.000625 * 2.0) + (30.000625 * 2.0 * 0.0025) = 60.151253125\\n            total_profit: 65.835 - 60.151253125 = 5.683746874999997\\n            total_profit_ratio: (1-(60.151253125/65.835)) * 3 = 0.2589996297562085\\n\\n    '\n    time_machine.move_to('2022-03-31 20:45:00 +00:00')\n    enter_order = limit_sell_order_usdt if is_short else limit_buy_order_usdt\n    exit_order = limit_buy_order_usdt if is_short else limit_sell_order_usdt\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=open_rate, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, interest_rate=0.0005, leverage=lev, trading_mode=trading_mode)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    oobj = Order.parse_from_ccxt_object(enter_order, 'ADA/USDT', entry_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == open_rate\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re(f'LIMIT_{entry_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    time_machine.move_to('2022-03-31 21:45:05 +00:00')\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', exit_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == close_rate\n    assert pytest.approx(trade.close_profit) == profit\n    assert trade.close_date is not None\n    assert log_has_re(f'LIMIT_{exit_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()",
            "@pytest.mark.parametrize('is_short,open_rate,close_rate,lev,profit,trading_mode', [(False, 2.0, 2.2, 1.0, 0.09451372, spot), (True, 2.2, 2.0, 3.0, 0.25894253, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_update_limit_order(fee, caplog, limit_buy_order_usdt, limit_sell_order_usdt, time_machine, is_short, open_rate, close_rate, lev, profit, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n        open_rate: 2.2, close_rate: 2.0, -3x, binance, short\\n            open_value: 30 * 2.2 - 30 * 2.2 * 0.0025 = 65.835 quote\\n            amount_closed: 30 + 0.000625 = 30.000625 crypto\\n            close_value: (30.000625 * 2.0) + (30.000625 * 2.0 * 0.0025) = 60.151253125\\n            total_profit: 65.835 - 60.151253125 = 5.683746874999997\\n            total_profit_ratio: (1-(60.151253125/65.835)) * 3 = 0.2589996297562085\\n\\n    '\n    time_machine.move_to('2022-03-31 20:45:00 +00:00')\n    enter_order = limit_sell_order_usdt if is_short else limit_buy_order_usdt\n    exit_order = limit_buy_order_usdt if is_short else limit_sell_order_usdt\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=open_rate, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, interest_rate=0.0005, leverage=lev, trading_mode=trading_mode)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    oobj = Order.parse_from_ccxt_object(enter_order, 'ADA/USDT', entry_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == open_rate\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re(f'LIMIT_{entry_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    time_machine.move_to('2022-03-31 21:45:05 +00:00')\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', exit_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == close_rate\n    assert pytest.approx(trade.close_profit) == profit\n    assert trade.close_date is not None\n    assert log_has_re(f'LIMIT_{exit_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()",
            "@pytest.mark.parametrize('is_short,open_rate,close_rate,lev,profit,trading_mode', [(False, 2.0, 2.2, 1.0, 0.09451372, spot), (True, 2.2, 2.0, 3.0, 0.25894253, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_update_limit_order(fee, caplog, limit_buy_order_usdt, limit_sell_order_usdt, time_machine, is_short, open_rate, close_rate, lev, profit, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n        open_rate: 2.2, close_rate: 2.0, -3x, binance, short\\n            open_value: 30 * 2.2 - 30 * 2.2 * 0.0025 = 65.835 quote\\n            amount_closed: 30 + 0.000625 = 30.000625 crypto\\n            close_value: (30.000625 * 2.0) + (30.000625 * 2.0 * 0.0025) = 60.151253125\\n            total_profit: 65.835 - 60.151253125 = 5.683746874999997\\n            total_profit_ratio: (1-(60.151253125/65.835)) * 3 = 0.2589996297562085\\n\\n    '\n    time_machine.move_to('2022-03-31 20:45:00 +00:00')\n    enter_order = limit_sell_order_usdt if is_short else limit_buy_order_usdt\n    exit_order = limit_buy_order_usdt if is_short else limit_sell_order_usdt\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=open_rate, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, interest_rate=0.0005, leverage=lev, trading_mode=trading_mode)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    oobj = Order.parse_from_ccxt_object(enter_order, 'ADA/USDT', entry_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == open_rate\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re(f'LIMIT_{entry_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    time_machine.move_to('2022-03-31 21:45:05 +00:00')\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', exit_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == close_rate\n    assert pytest.approx(trade.close_profit) == profit\n    assert trade.close_date is not None\n    assert log_has_re(f'LIMIT_{exit_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()",
            "@pytest.mark.parametrize('is_short,open_rate,close_rate,lev,profit,trading_mode', [(False, 2.0, 2.2, 1.0, 0.09451372, spot), (True, 2.2, 2.0, 3.0, 0.25894253, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_update_limit_order(fee, caplog, limit_buy_order_usdt, limit_sell_order_usdt, time_machine, is_short, open_rate, close_rate, lev, profit, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n        open_rate: 2.2, close_rate: 2.0, -3x, binance, short\\n            open_value: 30 * 2.2 - 30 * 2.2 * 0.0025 = 65.835 quote\\n            amount_closed: 30 + 0.000625 = 30.000625 crypto\\n            close_value: (30.000625 * 2.0) + (30.000625 * 2.0 * 0.0025) = 60.151253125\\n            total_profit: 65.835 - 60.151253125 = 5.683746874999997\\n            total_profit_ratio: (1-(60.151253125/65.835)) * 3 = 0.2589996297562085\\n\\n    '\n    time_machine.move_to('2022-03-31 20:45:00 +00:00')\n    enter_order = limit_sell_order_usdt if is_short else limit_buy_order_usdt\n    exit_order = limit_buy_order_usdt if is_short else limit_sell_order_usdt\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=open_rate, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, interest_rate=0.0005, leverage=lev, trading_mode=trading_mode)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    oobj = Order.parse_from_ccxt_object(enter_order, 'ADA/USDT', entry_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == open_rate\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re(f'LIMIT_{entry_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    time_machine.move_to('2022-03-31 21:45:05 +00:00')\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', exit_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == close_rate\n    assert pytest.approx(trade.close_profit) == profit\n    assert trade.close_date is not None\n    assert log_has_re(f'LIMIT_{exit_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()",
            "@pytest.mark.parametrize('is_short,open_rate,close_rate,lev,profit,trading_mode', [(False, 2.0, 2.2, 1.0, 0.09451372, spot), (True, 2.2, 2.0, 3.0, 0.25894253, margin)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_update_limit_order(fee, caplog, limit_buy_order_usdt, limit_sell_order_usdt, time_machine, is_short, open_rate, close_rate, lev, profit, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        fee: 0.25% quote\\n        interest_rate: 0.05% per 4 hrs\\n        open_rate: 2.00 quote\\n        close_rate: 2.20 quote\\n        amount: = 30.0 crypto\\n        stake_amount\\n            1x,-1x: 60.0  quote\\n            3x,-3x: 20.0  quote\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        hours: 1/6 (10 minutes)\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2 = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2 = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.850 quote\\n        amount_closed:\\n            1x, 3x         : amount\\n            -1x, -3x       : amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03 = 30.03 crypto\\n        close_value:\\n             1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n            -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            binance,kraken 1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)         = 65.835\\n            binance        3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n            kraken         3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040 = 65.795\\n            binance   -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025) = 66.16637843750001\\n            kraken    -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)         = 66.231165\\n        total_profit:\\n            1x, 3x : close_value - open_value\\n            -1x,-3x: open_value  - close_value\\n            binance,kraken 1x: 65.835 - 60.15             = 5.685\\n            binance        3x: 65.83416667 - 60.15        = 5.684166670000003\\n            kraken         3x: 65.795 - 60.15             = 5.645\\n            binance   -1x,-3x: 59.850 - 66.16637843750001 = -6.316378437500013\\n            kraken    -1x,-3x: 59.850 - 66.231165          = -6.381165\\n        total_profit_ratio:\\n            1x, 3x : ((close_value/open_value) - 1) * leverage\\n            -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            binance  1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            binance  3x: ((65.83416667 / 60.15) - 1)  * 3 = 0.2834995845386534\\n            kraken   1x: ((65.835 / 60.15) - 1)  * 1 = 0.0945137157107232\\n            kraken   3x: ((65.795 / 60.15) - 1)  * 3 = 0.2815461346633419\\n            binance -1x: (1-(66.1663784375 / 59.85)) * 1 = -0.1055368159983292\\n            binance -3x: (1-(66.1663784375 / 59.85)) * 3 = -0.3166104479949876\\n            kraken  -1x: (1-(66.2311650 / 59.85)) * 1    = -0.106619298245614\\n            kraken  -3x: (1-(66.2311650 / 59.85)) * 3    = -0.319857894736842\\n        open_rate: 2.2, close_rate: 2.0, -3x, binance, short\\n            open_value: 30 * 2.2 - 30 * 2.2 * 0.0025 = 65.835 quote\\n            amount_closed: 30 + 0.000625 = 30.000625 crypto\\n            close_value: (30.000625 * 2.0) + (30.000625 * 2.0 * 0.0025) = 60.151253125\\n            total_profit: 65.835 - 60.151253125 = 5.683746874999997\\n            total_profit_ratio: (1-(60.151253125/65.835)) * 3 = 0.2589996297562085\\n\\n    '\n    time_machine.move_to('2022-03-31 20:45:00 +00:00')\n    enter_order = limit_sell_order_usdt if is_short else limit_buy_order_usdt\n    exit_order = limit_buy_order_usdt if is_short else limit_sell_order_usdt\n    (entry_side, exit_side) = ('sell', 'buy') if is_short else ('buy', 'sell')\n    trade = Trade(id=2, pair='ADA/USDT', stake_amount=60.0, open_rate=open_rate, amount=30.0, is_open=True, open_date=dt_now(), fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', is_short=is_short, interest_rate=0.0005, leverage=lev, trading_mode=trading_mode)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    oobj = Order.parse_from_ccxt_object(enter_order, 'ADA/USDT', entry_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == open_rate\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re(f'LIMIT_{entry_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    time_machine.move_to('2022-03-31 21:45:05 +00:00')\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', exit_side)\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == close_rate\n    assert pytest.approx(trade.close_profit) == profit\n    assert trade.close_date is not None\n    assert log_has_re(f'LIMIT_{exit_side.upper()} has been fulfilled for Trade\\\\(id=2, pair=ADA/USDT, amount=30.00000000, is_short={is_short}, leverage={lev}, open_rate={open_rate}0000000, open_since=.*\\\\).', caplog)\n    caplog.clear()"
        ]
    },
    {
        "func_name": "test_update_market_order",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_update_market_order(market_buy_order_usdt, market_sell_order_usdt, fee, caplog):\n    trade = Trade(id=1, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now(), exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(market_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == 2.0\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re('MARKET_BUY has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    trade.is_open = True\n    oobj = Order.parse_from_ccxt_object(market_sell_order_usdt, 'ADA/USDT', 'sell')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == 2.2\n    assert pytest.approx(trade.close_profit) == 0.094513715710723\n    assert trade.close_date is not None\n    assert log_has_re('MARKET_SELL has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_market_order(market_buy_order_usdt, market_sell_order_usdt, fee, caplog):\n    if False:\n        i = 10\n    trade = Trade(id=1, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now(), exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(market_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == 2.0\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re('MARKET_BUY has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    trade.is_open = True\n    oobj = Order.parse_from_ccxt_object(market_sell_order_usdt, 'ADA/USDT', 'sell')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == 2.2\n    assert pytest.approx(trade.close_profit) == 0.094513715710723\n    assert trade.close_date is not None\n    assert log_has_re('MARKET_SELL has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_market_order(market_buy_order_usdt, market_sell_order_usdt, fee, caplog):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(id=1, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now(), exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(market_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == 2.0\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re('MARKET_BUY has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    trade.is_open = True\n    oobj = Order.parse_from_ccxt_object(market_sell_order_usdt, 'ADA/USDT', 'sell')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == 2.2\n    assert pytest.approx(trade.close_profit) == 0.094513715710723\n    assert trade.close_date is not None\n    assert log_has_re('MARKET_SELL has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_market_order(market_buy_order_usdt, market_sell_order_usdt, fee, caplog):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(id=1, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now(), exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(market_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == 2.0\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re('MARKET_BUY has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    trade.is_open = True\n    oobj = Order.parse_from_ccxt_object(market_sell_order_usdt, 'ADA/USDT', 'sell')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == 2.2\n    assert pytest.approx(trade.close_profit) == 0.094513715710723\n    assert trade.close_date is not None\n    assert log_has_re('MARKET_SELL has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_market_order(market_buy_order_usdt, market_sell_order_usdt, fee, caplog):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(id=1, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now(), exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(market_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == 2.0\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re('MARKET_BUY has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    trade.is_open = True\n    oobj = Order.parse_from_ccxt_object(market_sell_order_usdt, 'ADA/USDT', 'sell')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == 2.2\n    assert pytest.approx(trade.close_profit) == 0.094513715710723\n    assert trade.close_date is not None\n    assert log_has_re('MARKET_SELL has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_market_order(market_buy_order_usdt, market_sell_order_usdt, fee, caplog):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(id=1, pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now(), exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(market_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.open_rate == 2.0\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert log_has_re('MARKET_BUY has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)\n    caplog.clear()\n    trade.is_open = True\n    oobj = Order.parse_from_ccxt_object(market_sell_order_usdt, 'ADA/USDT', 'sell')\n    trade.orders.append(oobj)\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_rate == 2.2\n    assert pytest.approx(trade.close_profit) == 0.094513715710723\n    assert trade.close_date is not None\n    assert log_has_re('MARKET_SELL has been fulfilled for Trade\\\\(id=1, pair=ADA/USDT, amount=30.00000000, is_short=False, leverage=1.0, open_rate=2.00000000, open_since=.*\\\\).', caplog)"
        ]
    },
    {
        "func_name": "test_calc_open_close_trade_price",
        "original": "@pytest.mark.parametrize('exchange,is_short,lev,open_value,close_value,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('binance', True, 1, 65.835, 60.151253125, 5.68374687, 0.08633321, margin, 0.0), ('binance', False, 3, 60.15, 65.83416667, 5.68416667, 0.28349958, margin, 0.0), ('binance', True, 3, 65.835, 60.151253125, 5.68374687, 0.25899963, margin, 0.0), ('kraken', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('kraken', True, 1, 65.835, 60.21015, 5.62485, 0.0854386, margin, 0.0), ('kraken', False, 3, 60.15, 65.795, 5.645, 0.28154613, margin, 0.0), ('kraken', True, 3, 65.835, 60.21015, 5.62485, 0.25631579, margin, 0.0), ('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, futures, 0.0), ('binance', False, 1, 60.15, 66.835, 6.685, 0.11113881, futures, 1.0), ('binance', True, 1, 65.835, 60.15, 5.685, 0.08635224, futures, 0.0), ('binance', True, 1, 65.835, 61.15, 4.685, 0.07116276, futures, -1.0), ('binance', True, 3, 65.835, 59.15, 6.685, 0.3046252, futures, 1.0), ('binance', False, 3, 60.15, 64.835, 4.685, 0.23366583, futures, -1.0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_close_trade_price(limit_order, fee, exchange, is_short, lev, open_value, close_value, profit, profit_ratio, trading_mode, funding_fees):\n    trade: Trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    entry_order = limit_order[trade.entry_side]\n    exit_order = limit_order[trade.exit_side]\n    oobj = Order.parse_from_ccxt_object(entry_order, 'ADA/USDT', trade.entry_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(entry_order)\n    trade.update_trade(oobj)\n    trade.funding_fee_running = funding_fees\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', trade.exit_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(exit_order)\n    trade.update_trade(oobj)\n    assert trade.is_open is False\n    assert trade.funding_fees == funding_fees\n    assert trade.orders[-1].funding_fee == funding_fees\n    assert pytest.approx(trade._calc_open_trade_value(trade.amount, trade.open_rate)) == open_value\n    assert pytest.approx(trade.calc_close_trade_value(trade.close_rate)) == close_value\n    assert pytest.approx(trade.close_profit_abs) == profit\n    assert pytest.approx(trade.close_profit) == profit_ratio",
        "mutated": [
            "@pytest.mark.parametrize('exchange,is_short,lev,open_value,close_value,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('binance', True, 1, 65.835, 60.151253125, 5.68374687, 0.08633321, margin, 0.0), ('binance', False, 3, 60.15, 65.83416667, 5.68416667, 0.28349958, margin, 0.0), ('binance', True, 3, 65.835, 60.151253125, 5.68374687, 0.25899963, margin, 0.0), ('kraken', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('kraken', True, 1, 65.835, 60.21015, 5.62485, 0.0854386, margin, 0.0), ('kraken', False, 3, 60.15, 65.795, 5.645, 0.28154613, margin, 0.0), ('kraken', True, 3, 65.835, 60.21015, 5.62485, 0.25631579, margin, 0.0), ('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, futures, 0.0), ('binance', False, 1, 60.15, 66.835, 6.685, 0.11113881, futures, 1.0), ('binance', True, 1, 65.835, 60.15, 5.685, 0.08635224, futures, 0.0), ('binance', True, 1, 65.835, 61.15, 4.685, 0.07116276, futures, -1.0), ('binance', True, 3, 65.835, 59.15, 6.685, 0.3046252, futures, 1.0), ('binance', False, 3, 60.15, 64.835, 4.685, 0.23366583, futures, -1.0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_close_trade_price(limit_order, fee, exchange, is_short, lev, open_value, close_value, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n    trade: Trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    entry_order = limit_order[trade.entry_side]\n    exit_order = limit_order[trade.exit_side]\n    oobj = Order.parse_from_ccxt_object(entry_order, 'ADA/USDT', trade.entry_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(entry_order)\n    trade.update_trade(oobj)\n    trade.funding_fee_running = funding_fees\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', trade.exit_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(exit_order)\n    trade.update_trade(oobj)\n    assert trade.is_open is False\n    assert trade.funding_fees == funding_fees\n    assert trade.orders[-1].funding_fee == funding_fees\n    assert pytest.approx(trade._calc_open_trade_value(trade.amount, trade.open_rate)) == open_value\n    assert pytest.approx(trade.calc_close_trade_value(trade.close_rate)) == close_value\n    assert pytest.approx(trade.close_profit_abs) == profit\n    assert pytest.approx(trade.close_profit) == profit_ratio",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_value,close_value,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('binance', True, 1, 65.835, 60.151253125, 5.68374687, 0.08633321, margin, 0.0), ('binance', False, 3, 60.15, 65.83416667, 5.68416667, 0.28349958, margin, 0.0), ('binance', True, 3, 65.835, 60.151253125, 5.68374687, 0.25899963, margin, 0.0), ('kraken', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('kraken', True, 1, 65.835, 60.21015, 5.62485, 0.0854386, margin, 0.0), ('kraken', False, 3, 60.15, 65.795, 5.645, 0.28154613, margin, 0.0), ('kraken', True, 3, 65.835, 60.21015, 5.62485, 0.25631579, margin, 0.0), ('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, futures, 0.0), ('binance', False, 1, 60.15, 66.835, 6.685, 0.11113881, futures, 1.0), ('binance', True, 1, 65.835, 60.15, 5.685, 0.08635224, futures, 0.0), ('binance', True, 1, 65.835, 61.15, 4.685, 0.07116276, futures, -1.0), ('binance', True, 3, 65.835, 59.15, 6.685, 0.3046252, futures, 1.0), ('binance', False, 3, 60.15, 64.835, 4.685, 0.23366583, futures, -1.0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_close_trade_price(limit_order, fee, exchange, is_short, lev, open_value, close_value, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade: Trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    entry_order = limit_order[trade.entry_side]\n    exit_order = limit_order[trade.exit_side]\n    oobj = Order.parse_from_ccxt_object(entry_order, 'ADA/USDT', trade.entry_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(entry_order)\n    trade.update_trade(oobj)\n    trade.funding_fee_running = funding_fees\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', trade.exit_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(exit_order)\n    trade.update_trade(oobj)\n    assert trade.is_open is False\n    assert trade.funding_fees == funding_fees\n    assert trade.orders[-1].funding_fee == funding_fees\n    assert pytest.approx(trade._calc_open_trade_value(trade.amount, trade.open_rate)) == open_value\n    assert pytest.approx(trade.calc_close_trade_value(trade.close_rate)) == close_value\n    assert pytest.approx(trade.close_profit_abs) == profit\n    assert pytest.approx(trade.close_profit) == profit_ratio",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_value,close_value,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('binance', True, 1, 65.835, 60.151253125, 5.68374687, 0.08633321, margin, 0.0), ('binance', False, 3, 60.15, 65.83416667, 5.68416667, 0.28349958, margin, 0.0), ('binance', True, 3, 65.835, 60.151253125, 5.68374687, 0.25899963, margin, 0.0), ('kraken', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('kraken', True, 1, 65.835, 60.21015, 5.62485, 0.0854386, margin, 0.0), ('kraken', False, 3, 60.15, 65.795, 5.645, 0.28154613, margin, 0.0), ('kraken', True, 3, 65.835, 60.21015, 5.62485, 0.25631579, margin, 0.0), ('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, futures, 0.0), ('binance', False, 1, 60.15, 66.835, 6.685, 0.11113881, futures, 1.0), ('binance', True, 1, 65.835, 60.15, 5.685, 0.08635224, futures, 0.0), ('binance', True, 1, 65.835, 61.15, 4.685, 0.07116276, futures, -1.0), ('binance', True, 3, 65.835, 59.15, 6.685, 0.3046252, futures, 1.0), ('binance', False, 3, 60.15, 64.835, 4.685, 0.23366583, futures, -1.0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_close_trade_price(limit_order, fee, exchange, is_short, lev, open_value, close_value, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade: Trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    entry_order = limit_order[trade.entry_side]\n    exit_order = limit_order[trade.exit_side]\n    oobj = Order.parse_from_ccxt_object(entry_order, 'ADA/USDT', trade.entry_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(entry_order)\n    trade.update_trade(oobj)\n    trade.funding_fee_running = funding_fees\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', trade.exit_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(exit_order)\n    trade.update_trade(oobj)\n    assert trade.is_open is False\n    assert trade.funding_fees == funding_fees\n    assert trade.orders[-1].funding_fee == funding_fees\n    assert pytest.approx(trade._calc_open_trade_value(trade.amount, trade.open_rate)) == open_value\n    assert pytest.approx(trade.calc_close_trade_value(trade.close_rate)) == close_value\n    assert pytest.approx(trade.close_profit_abs) == profit\n    assert pytest.approx(trade.close_profit) == profit_ratio",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_value,close_value,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('binance', True, 1, 65.835, 60.151253125, 5.68374687, 0.08633321, margin, 0.0), ('binance', False, 3, 60.15, 65.83416667, 5.68416667, 0.28349958, margin, 0.0), ('binance', True, 3, 65.835, 60.151253125, 5.68374687, 0.25899963, margin, 0.0), ('kraken', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('kraken', True, 1, 65.835, 60.21015, 5.62485, 0.0854386, margin, 0.0), ('kraken', False, 3, 60.15, 65.795, 5.645, 0.28154613, margin, 0.0), ('kraken', True, 3, 65.835, 60.21015, 5.62485, 0.25631579, margin, 0.0), ('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, futures, 0.0), ('binance', False, 1, 60.15, 66.835, 6.685, 0.11113881, futures, 1.0), ('binance', True, 1, 65.835, 60.15, 5.685, 0.08635224, futures, 0.0), ('binance', True, 1, 65.835, 61.15, 4.685, 0.07116276, futures, -1.0), ('binance', True, 3, 65.835, 59.15, 6.685, 0.3046252, futures, 1.0), ('binance', False, 3, 60.15, 64.835, 4.685, 0.23366583, futures, -1.0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_close_trade_price(limit_order, fee, exchange, is_short, lev, open_value, close_value, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade: Trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    entry_order = limit_order[trade.entry_side]\n    exit_order = limit_order[trade.exit_side]\n    oobj = Order.parse_from_ccxt_object(entry_order, 'ADA/USDT', trade.entry_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(entry_order)\n    trade.update_trade(oobj)\n    trade.funding_fee_running = funding_fees\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', trade.exit_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(exit_order)\n    trade.update_trade(oobj)\n    assert trade.is_open is False\n    assert trade.funding_fees == funding_fees\n    assert trade.orders[-1].funding_fee == funding_fees\n    assert pytest.approx(trade._calc_open_trade_value(trade.amount, trade.open_rate)) == open_value\n    assert pytest.approx(trade.calc_close_trade_value(trade.close_rate)) == close_value\n    assert pytest.approx(trade.close_profit_abs) == profit\n    assert pytest.approx(trade.close_profit) == profit_ratio",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_value,close_value,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('binance', True, 1, 65.835, 60.151253125, 5.68374687, 0.08633321, margin, 0.0), ('binance', False, 3, 60.15, 65.83416667, 5.68416667, 0.28349958, margin, 0.0), ('binance', True, 3, 65.835, 60.151253125, 5.68374687, 0.25899963, margin, 0.0), ('kraken', False, 1, 60.15, 65.835, 5.685, 0.09451371, spot, 0.0), ('kraken', True, 1, 65.835, 60.21015, 5.62485, 0.0854386, margin, 0.0), ('kraken', False, 3, 60.15, 65.795, 5.645, 0.28154613, margin, 0.0), ('kraken', True, 3, 65.835, 60.21015, 5.62485, 0.25631579, margin, 0.0), ('binance', False, 1, 60.15, 65.835, 5.685, 0.09451371, futures, 0.0), ('binance', False, 1, 60.15, 66.835, 6.685, 0.11113881, futures, 1.0), ('binance', True, 1, 65.835, 60.15, 5.685, 0.08635224, futures, 0.0), ('binance', True, 1, 65.835, 61.15, 4.685, 0.07116276, futures, -1.0), ('binance', True, 3, 65.835, 59.15, 6.685, 0.3046252, futures, 1.0), ('binance', False, 3, 60.15, 64.835, 4.685, 0.23366583, futures, -1.0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_close_trade_price(limit_order, fee, exchange, is_short, lev, open_value, close_value, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade: Trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, fee_open=fee.return_value, fee_close=fee.return_value, exchange=exchange, is_short=is_short, leverage=lev, trading_mode=trading_mode)\n    entry_order = limit_order[trade.entry_side]\n    exit_order = limit_order[trade.exit_side]\n    oobj = Order.parse_from_ccxt_object(entry_order, 'ADA/USDT', trade.entry_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(entry_order)\n    trade.update_trade(oobj)\n    trade.funding_fee_running = funding_fees\n    oobj = Order.parse_from_ccxt_object(exit_order, 'ADA/USDT', trade.exit_side)\n    oobj._trade_live = trade\n    oobj.update_from_ccxt_object(exit_order)\n    trade.update_trade(oobj)\n    assert trade.is_open is False\n    assert trade.funding_fees == funding_fees\n    assert trade.orders[-1].funding_fee == funding_fees\n    assert pytest.approx(trade._calc_open_trade_value(trade.amount, trade.open_rate)) == open_value\n    assert pytest.approx(trade.calc_close_trade_value(trade.close_rate)) == close_value\n    assert pytest.approx(trade.close_profit_abs) == profit\n    assert pytest.approx(trade.close_profit) == profit_ratio"
        ]
    },
    {
        "func_name": "test_trade_close",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_close(fee, time_machine):\n    time_machine.move_to('2022-09-01 05:00:00 +00:00', tick=False)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(minutes=10), interest_rate=0.0005, exchange='binance', trading_mode=margin, leverage=1.0)\n    trade.orders.append(Order(ft_order_side=trade.entry_side, order_id=f'{trade.pair}-{trade.entry_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=trade.open_rate, average=trade.open_rate, status='closed', order_type='limit', side=trade.entry_side, order_filled_date=trade.open_date))\n    trade.orders.append(Order(ft_order_side=trade.exit_side, order_id=f'{trade.pair}-{trade.exit_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=2.2, average=2.2, status='closed', order_type='limit', side=trade.exit_side, order_filled_date=dt_now()))\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert trade.is_open is True\n    trade.close(2.2)\n    assert trade.is_open is False\n    assert pytest.approx(trade.close_profit) == 0.094513715\n    assert trade.close_date is not None\n    assert trade.close_date_utc == dt_now()\n    new_date = dt_now() + timedelta(minutes=5)\n    assert trade.close_date_utc != new_date\n    assert trade.is_open is False\n    trade.close_date = new_date\n    trade.close(2.2)\n    assert trade.close_date_utc == new_date",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_close(fee, time_machine):\n    if False:\n        i = 10\n    time_machine.move_to('2022-09-01 05:00:00 +00:00', tick=False)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(minutes=10), interest_rate=0.0005, exchange='binance', trading_mode=margin, leverage=1.0)\n    trade.orders.append(Order(ft_order_side=trade.entry_side, order_id=f'{trade.pair}-{trade.entry_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=trade.open_rate, average=trade.open_rate, status='closed', order_type='limit', side=trade.entry_side, order_filled_date=trade.open_date))\n    trade.orders.append(Order(ft_order_side=trade.exit_side, order_id=f'{trade.pair}-{trade.exit_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=2.2, average=2.2, status='closed', order_type='limit', side=trade.exit_side, order_filled_date=dt_now()))\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert trade.is_open is True\n    trade.close(2.2)\n    assert trade.is_open is False\n    assert pytest.approx(trade.close_profit) == 0.094513715\n    assert trade.close_date is not None\n    assert trade.close_date_utc == dt_now()\n    new_date = dt_now() + timedelta(minutes=5)\n    assert trade.close_date_utc != new_date\n    assert trade.is_open is False\n    trade.close_date = new_date\n    trade.close(2.2)\n    assert trade.close_date_utc == new_date",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_close(fee, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    time_machine.move_to('2022-09-01 05:00:00 +00:00', tick=False)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(minutes=10), interest_rate=0.0005, exchange='binance', trading_mode=margin, leverage=1.0)\n    trade.orders.append(Order(ft_order_side=trade.entry_side, order_id=f'{trade.pair}-{trade.entry_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=trade.open_rate, average=trade.open_rate, status='closed', order_type='limit', side=trade.entry_side, order_filled_date=trade.open_date))\n    trade.orders.append(Order(ft_order_side=trade.exit_side, order_id=f'{trade.pair}-{trade.exit_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=2.2, average=2.2, status='closed', order_type='limit', side=trade.exit_side, order_filled_date=dt_now()))\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert trade.is_open is True\n    trade.close(2.2)\n    assert trade.is_open is False\n    assert pytest.approx(trade.close_profit) == 0.094513715\n    assert trade.close_date is not None\n    assert trade.close_date_utc == dt_now()\n    new_date = dt_now() + timedelta(minutes=5)\n    assert trade.close_date_utc != new_date\n    assert trade.is_open is False\n    trade.close_date = new_date\n    trade.close(2.2)\n    assert trade.close_date_utc == new_date",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_close(fee, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    time_machine.move_to('2022-09-01 05:00:00 +00:00', tick=False)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(minutes=10), interest_rate=0.0005, exchange='binance', trading_mode=margin, leverage=1.0)\n    trade.orders.append(Order(ft_order_side=trade.entry_side, order_id=f'{trade.pair}-{trade.entry_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=trade.open_rate, average=trade.open_rate, status='closed', order_type='limit', side=trade.entry_side, order_filled_date=trade.open_date))\n    trade.orders.append(Order(ft_order_side=trade.exit_side, order_id=f'{trade.pair}-{trade.exit_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=2.2, average=2.2, status='closed', order_type='limit', side=trade.exit_side, order_filled_date=dt_now()))\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert trade.is_open is True\n    trade.close(2.2)\n    assert trade.is_open is False\n    assert pytest.approx(trade.close_profit) == 0.094513715\n    assert trade.close_date is not None\n    assert trade.close_date_utc == dt_now()\n    new_date = dt_now() + timedelta(minutes=5)\n    assert trade.close_date_utc != new_date\n    assert trade.is_open is False\n    trade.close_date = new_date\n    trade.close(2.2)\n    assert trade.close_date_utc == new_date",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_close(fee, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    time_machine.move_to('2022-09-01 05:00:00 +00:00', tick=False)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(minutes=10), interest_rate=0.0005, exchange='binance', trading_mode=margin, leverage=1.0)\n    trade.orders.append(Order(ft_order_side=trade.entry_side, order_id=f'{trade.pair}-{trade.entry_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=trade.open_rate, average=trade.open_rate, status='closed', order_type='limit', side=trade.entry_side, order_filled_date=trade.open_date))\n    trade.orders.append(Order(ft_order_side=trade.exit_side, order_id=f'{trade.pair}-{trade.exit_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=2.2, average=2.2, status='closed', order_type='limit', side=trade.exit_side, order_filled_date=dt_now()))\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert trade.is_open is True\n    trade.close(2.2)\n    assert trade.is_open is False\n    assert pytest.approx(trade.close_profit) == 0.094513715\n    assert trade.close_date is not None\n    assert trade.close_date_utc == dt_now()\n    new_date = dt_now() + timedelta(minutes=5)\n    assert trade.close_date_utc != new_date\n    assert trade.is_open is False\n    trade.close_date = new_date\n    trade.close(2.2)\n    assert trade.close_date_utc == new_date",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_close(fee, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    time_machine.move_to('2022-09-01 05:00:00 +00:00', tick=False)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, is_open=True, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(minutes=10), interest_rate=0.0005, exchange='binance', trading_mode=margin, leverage=1.0)\n    trade.orders.append(Order(ft_order_side=trade.entry_side, order_id=f'{trade.pair}-{trade.entry_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=trade.open_rate, average=trade.open_rate, status='closed', order_type='limit', side=trade.entry_side, order_filled_date=trade.open_date))\n    trade.orders.append(Order(ft_order_side=trade.exit_side, order_id=f'{trade.pair}-{trade.exit_side}-{trade.open_date}', ft_is_open=False, ft_pair=trade.pair, amount=trade.amount, filled=trade.amount, remaining=0, price=2.2, average=2.2, status='closed', order_type='limit', side=trade.exit_side, order_filled_date=dt_now()))\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    assert trade.is_open is True\n    trade.close(2.2)\n    assert trade.is_open is False\n    assert pytest.approx(trade.close_profit) == 0.094513715\n    assert trade.close_date is not None\n    assert trade.close_date_utc == dt_now()\n    new_date = dt_now() + timedelta(minutes=5)\n    assert trade.close_date_utc != new_date\n    assert trade.is_open is False\n    trade.close_date = new_date\n    trade.close(2.2)\n    assert trade.close_date_utc == new_date"
        ]
    },
    {
        "func_name": "test_calc_close_trade_price_exception",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price_exception(limit_buy_order_usdt, fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert trade.calc_close_trade_value(trade.close_rate) == 0.0",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price_exception(limit_buy_order_usdt, fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert trade.calc_close_trade_value(trade.close_rate) == 0.0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price_exception(limit_buy_order_usdt, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert trade.calc_close_trade_value(trade.close_rate) == 0.0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price_exception(limit_buy_order_usdt, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert trade.calc_close_trade_value(trade.close_rate) == 0.0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price_exception(limit_buy_order_usdt, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert trade.calc_close_trade_value(trade.close_rate) == 0.0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price_exception(limit_buy_order_usdt, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', trading_mode=margin, leverage=1.0)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert trade.calc_close_trade_value(trade.close_rate) == 0.0"
        ]
    },
    {
        "func_name": "test_update_open_order",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_update_open_order(limit_buy_order_usdt):\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    limit_buy_order_usdt['status'] = 'open'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_open_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    limit_buy_order_usdt['status'] = 'open'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_open_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    limit_buy_order_usdt['status'] = 'open'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_open_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    limit_buy_order_usdt['status'] = 'open'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_open_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    limit_buy_order_usdt['status'] = 'open'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_open_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, open_rate=2.0, amount=30.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None\n    limit_buy_order_usdt['status'] = 'open'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'buy')\n    trade.update_trade(oobj)\n    assert not trade.has_open_orders\n    assert trade.close_profit is None\n    assert trade.close_date is None"
        ]
    },
    {
        "func_name": "test_update_invalid_order",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_update_invalid_order(limit_buy_order_usdt):\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    limit_buy_order_usdt['type'] = 'invalid'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'meep')\n    with pytest.raises(ValueError, match='Unknown order type'):\n        trade.update_trade(oobj)",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_invalid_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    limit_buy_order_usdt['type'] = 'invalid'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'meep')\n    with pytest.raises(ValueError, match='Unknown order type'):\n        trade.update_trade(oobj)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_invalid_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    limit_buy_order_usdt['type'] = 'invalid'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'meep')\n    with pytest.raises(ValueError, match='Unknown order type'):\n        trade.update_trade(oobj)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_invalid_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    limit_buy_order_usdt['type'] = 'invalid'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'meep')\n    with pytest.raises(ValueError, match='Unknown order type'):\n        trade.update_trade(oobj)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_invalid_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    limit_buy_order_usdt['type'] = 'invalid'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'meep')\n    with pytest.raises(ValueError, match='Unknown order type'):\n        trade.update_trade(oobj)",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_invalid_order(limit_buy_order_usdt):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, fee_open=0.1, fee_close=0.1, exchange='binance', trading_mode=margin)\n    limit_buy_order_usdt['type'] = 'invalid'\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'meep')\n    with pytest.raises(ValueError, match='Unknown order type'):\n        trade.update_trade(oobj)"
        ]
    },
    {
        "func_name": "test_calc_open_trade_value",
        "original": "@pytest.mark.parametrize('exchange', ['binance', 'kraken'])\n@pytest.mark.parametrize('trading_mode', [spot, margin, futures])\n@pytest.mark.parametrize('lev', [1, 3])\n@pytest.mark.parametrize('is_short,fee_rate,result', [(False, 0.003, 60.18), (False, 0.0025, 60.15), (False, 0.003, 60.18), (False, 0.0025, 60.15), (True, 0.003, 59.82), (True, 0.0025, 59.85), (True, 0.003, 59.82), (True, 0.0025, 59.85)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_trade_value(limit_buy_order_usdt, exchange, lev, is_short, fee_rate, result, trading_mode):\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, leverage=lev, is_short=is_short, trading_mode=trading_mode)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'sell' if is_short else 'buy')\n    trade.update_trade(oobj)\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == result",
        "mutated": [
            "@pytest.mark.parametrize('exchange', ['binance', 'kraken'])\n@pytest.mark.parametrize('trading_mode', [spot, margin, futures])\n@pytest.mark.parametrize('lev', [1, 3])\n@pytest.mark.parametrize('is_short,fee_rate,result', [(False, 0.003, 60.18), (False, 0.0025, 60.15), (False, 0.003, 60.18), (False, 0.0025, 60.15), (True, 0.003, 59.82), (True, 0.0025, 59.85), (True, 0.003, 59.82), (True, 0.0025, 59.85)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_trade_value(limit_buy_order_usdt, exchange, lev, is_short, fee_rate, result, trading_mode):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, leverage=lev, is_short=is_short, trading_mode=trading_mode)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'sell' if is_short else 'buy')\n    trade.update_trade(oobj)\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == result",
            "@pytest.mark.parametrize('exchange', ['binance', 'kraken'])\n@pytest.mark.parametrize('trading_mode', [spot, margin, futures])\n@pytest.mark.parametrize('lev', [1, 3])\n@pytest.mark.parametrize('is_short,fee_rate,result', [(False, 0.003, 60.18), (False, 0.0025, 60.15), (False, 0.003, 60.18), (False, 0.0025, 60.15), (True, 0.003, 59.82), (True, 0.0025, 59.85), (True, 0.003, 59.82), (True, 0.0025, 59.85)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_trade_value(limit_buy_order_usdt, exchange, lev, is_short, fee_rate, result, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, leverage=lev, is_short=is_short, trading_mode=trading_mode)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'sell' if is_short else 'buy')\n    trade.update_trade(oobj)\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == result",
            "@pytest.mark.parametrize('exchange', ['binance', 'kraken'])\n@pytest.mark.parametrize('trading_mode', [spot, margin, futures])\n@pytest.mark.parametrize('lev', [1, 3])\n@pytest.mark.parametrize('is_short,fee_rate,result', [(False, 0.003, 60.18), (False, 0.0025, 60.15), (False, 0.003, 60.18), (False, 0.0025, 60.15), (True, 0.003, 59.82), (True, 0.0025, 59.85), (True, 0.003, 59.82), (True, 0.0025, 59.85)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_trade_value(limit_buy_order_usdt, exchange, lev, is_short, fee_rate, result, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, leverage=lev, is_short=is_short, trading_mode=trading_mode)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'sell' if is_short else 'buy')\n    trade.update_trade(oobj)\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == result",
            "@pytest.mark.parametrize('exchange', ['binance', 'kraken'])\n@pytest.mark.parametrize('trading_mode', [spot, margin, futures])\n@pytest.mark.parametrize('lev', [1, 3])\n@pytest.mark.parametrize('is_short,fee_rate,result', [(False, 0.003, 60.18), (False, 0.0025, 60.15), (False, 0.003, 60.18), (False, 0.0025, 60.15), (True, 0.003, 59.82), (True, 0.0025, 59.85), (True, 0.003, 59.82), (True, 0.0025, 59.85)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_trade_value(limit_buy_order_usdt, exchange, lev, is_short, fee_rate, result, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, leverage=lev, is_short=is_short, trading_mode=trading_mode)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'sell' if is_short else 'buy')\n    trade.update_trade(oobj)\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == result",
            "@pytest.mark.parametrize('exchange', ['binance', 'kraken'])\n@pytest.mark.parametrize('trading_mode', [spot, margin, futures])\n@pytest.mark.parametrize('lev', [1, 3])\n@pytest.mark.parametrize('is_short,fee_rate,result', [(False, 0.003, 60.18), (False, 0.0025, 60.15), (False, 0.003, 60.18), (False, 0.0025, 60.15), (True, 0.003, 59.82), (True, 0.0025, 59.85), (True, 0.003, 59.82), (True, 0.0025, 59.85)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_open_trade_value(limit_buy_order_usdt, exchange, lev, is_short, fee_rate, result, trading_mode):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, leverage=lev, is_short=is_short, trading_mode=trading_mode)\n    oobj = Order.parse_from_ccxt_object(limit_buy_order_usdt, 'ADA/USDT', 'sell' if is_short else 'buy')\n    trade.update_trade(oobj)\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == result"
        ]
    },
    {
        "func_name": "test_calc_close_trade_price",
        "original": "@pytest.mark.parametrize('exchange,is_short,lev,open_rate,close_rate,fee_rate,result,trading_mode,funding_fees', [('binance', False, 1, 2.0, 2.5, 0.0025, 74.8125, spot, 0), ('binance', False, 1, 2.0, 2.5, 0.003, 74.775, spot, 0), ('binance', False, 1, 2.0, 2.2, 0.005, 65.67, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.0025, 74.81166667, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.003, 74.77416667, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.0025, 74.7725, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.003, 74.735, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('binance', False, 1, 2.0, 2.5, 0.0025, 75.8125, futures, 1), ('binance', False, 3, 2.0, 2.5, 0.0025, 73.8125, futures, -1), ('binance', True, 3, 2.0, 2.5, 0.0025, 74.1875, futures, 1), ('binance', True, 1, 2.0, 2.5, 0.0025, 76.1875, futures, -1)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price(open_rate, exchange, is_short, lev, close_rate, fee_rate, result, trading_mode, funding_fees):\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=open_rate, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, interest_rate=0.0005, is_short=is_short, leverage=lev, trading_mode=trading_mode, funding_fees=funding_fees)\n    assert round(trade.calc_close_trade_value(rate=close_rate), 8) == result",
        "mutated": [
            "@pytest.mark.parametrize('exchange,is_short,lev,open_rate,close_rate,fee_rate,result,trading_mode,funding_fees', [('binance', False, 1, 2.0, 2.5, 0.0025, 74.8125, spot, 0), ('binance', False, 1, 2.0, 2.5, 0.003, 74.775, spot, 0), ('binance', False, 1, 2.0, 2.2, 0.005, 65.67, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.0025, 74.81166667, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.003, 74.77416667, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.0025, 74.7725, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.003, 74.735, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('binance', False, 1, 2.0, 2.5, 0.0025, 75.8125, futures, 1), ('binance', False, 3, 2.0, 2.5, 0.0025, 73.8125, futures, -1), ('binance', True, 3, 2.0, 2.5, 0.0025, 74.1875, futures, 1), ('binance', True, 1, 2.0, 2.5, 0.0025, 76.1875, futures, -1)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price(open_rate, exchange, is_short, lev, close_rate, fee_rate, result, trading_mode, funding_fees):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=open_rate, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, interest_rate=0.0005, is_short=is_short, leverage=lev, trading_mode=trading_mode, funding_fees=funding_fees)\n    assert round(trade.calc_close_trade_value(rate=close_rate), 8) == result",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_rate,close_rate,fee_rate,result,trading_mode,funding_fees', [('binance', False, 1, 2.0, 2.5, 0.0025, 74.8125, spot, 0), ('binance', False, 1, 2.0, 2.5, 0.003, 74.775, spot, 0), ('binance', False, 1, 2.0, 2.2, 0.005, 65.67, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.0025, 74.81166667, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.003, 74.77416667, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.0025, 74.7725, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.003, 74.735, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('binance', False, 1, 2.0, 2.5, 0.0025, 75.8125, futures, 1), ('binance', False, 3, 2.0, 2.5, 0.0025, 73.8125, futures, -1), ('binance', True, 3, 2.0, 2.5, 0.0025, 74.1875, futures, 1), ('binance', True, 1, 2.0, 2.5, 0.0025, 76.1875, futures, -1)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price(open_rate, exchange, is_short, lev, close_rate, fee_rate, result, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=open_rate, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, interest_rate=0.0005, is_short=is_short, leverage=lev, trading_mode=trading_mode, funding_fees=funding_fees)\n    assert round(trade.calc_close_trade_value(rate=close_rate), 8) == result",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_rate,close_rate,fee_rate,result,trading_mode,funding_fees', [('binance', False, 1, 2.0, 2.5, 0.0025, 74.8125, spot, 0), ('binance', False, 1, 2.0, 2.5, 0.003, 74.775, spot, 0), ('binance', False, 1, 2.0, 2.2, 0.005, 65.67, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.0025, 74.81166667, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.003, 74.77416667, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.0025, 74.7725, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.003, 74.735, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('binance', False, 1, 2.0, 2.5, 0.0025, 75.8125, futures, 1), ('binance', False, 3, 2.0, 2.5, 0.0025, 73.8125, futures, -1), ('binance', True, 3, 2.0, 2.5, 0.0025, 74.1875, futures, 1), ('binance', True, 1, 2.0, 2.5, 0.0025, 76.1875, futures, -1)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price(open_rate, exchange, is_short, lev, close_rate, fee_rate, result, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=open_rate, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, interest_rate=0.0005, is_short=is_short, leverage=lev, trading_mode=trading_mode, funding_fees=funding_fees)\n    assert round(trade.calc_close_trade_value(rate=close_rate), 8) == result",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_rate,close_rate,fee_rate,result,trading_mode,funding_fees', [('binance', False, 1, 2.0, 2.5, 0.0025, 74.8125, spot, 0), ('binance', False, 1, 2.0, 2.5, 0.003, 74.775, spot, 0), ('binance', False, 1, 2.0, 2.2, 0.005, 65.67, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.0025, 74.81166667, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.003, 74.77416667, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.0025, 74.7725, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.003, 74.735, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('binance', False, 1, 2.0, 2.5, 0.0025, 75.8125, futures, 1), ('binance', False, 3, 2.0, 2.5, 0.0025, 73.8125, futures, -1), ('binance', True, 3, 2.0, 2.5, 0.0025, 74.1875, futures, 1), ('binance', True, 1, 2.0, 2.5, 0.0025, 76.1875, futures, -1)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price(open_rate, exchange, is_short, lev, close_rate, fee_rate, result, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=open_rate, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, interest_rate=0.0005, is_short=is_short, leverage=lev, trading_mode=trading_mode, funding_fees=funding_fees)\n    assert round(trade.calc_close_trade_value(rate=close_rate), 8) == result",
            "@pytest.mark.parametrize('exchange,is_short,lev,open_rate,close_rate,fee_rate,result,trading_mode,funding_fees', [('binance', False, 1, 2.0, 2.5, 0.0025, 74.8125, spot, 0), ('binance', False, 1, 2.0, 2.5, 0.003, 74.775, spot, 0), ('binance', False, 1, 2.0, 2.2, 0.005, 65.67, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.0025, 74.81166667, margin, 0), ('binance', False, 3, 2.0, 2.5, 0.003, 74.77416667, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 3, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.0025, 75.18906641, margin, 0), ('binance', True, 1, 2.2, 2.5, 0.003, 75.22656719, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.0025, 74.7725, margin, 0), ('kraken', False, 3, 2.0, 2.5, 0.003, 74.735, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 3, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.0025, 75.2626875, margin, 0), ('kraken', True, 1, 2.2, 2.5, 0.003, 75.300225, margin, 0), ('binance', False, 1, 2.0, 2.5, 0.0025, 75.8125, futures, 1), ('binance', False, 3, 2.0, 2.5, 0.0025, 73.8125, futures, -1), ('binance', True, 3, 2.0, 2.5, 0.0025, 74.1875, futures, 1), ('binance', True, 1, 2.0, 2.5, 0.0025, 76.1875, futures, -1)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_close_trade_price(open_rate, exchange, is_short, lev, close_rate, fee_rate, result, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=open_rate, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), fee_open=fee_rate, fee_close=fee_rate, exchange=exchange, interest_rate=0.0005, is_short=is_short, leverage=lev, trading_mode=trading_mode, funding_fees=funding_fees)\n    assert round(trade.calc_close_trade_value(rate=close_rate), 8) == result"
        ]
    },
    {
        "func_name": "test_calc_profit",
        "original": "@pytest.mark.parametrize('exchange,is_short,lev,close_rate,fee_close,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('binance', False, 3, 2.1, 0.0025, 2.69166667, 0.134247714, margin, 0), ('binance', True, 1, 2.1, 0.0025, -3.3088157, -0.055285142, margin, 0), ('binance', True, 3, 2.1, 0.0025, -3.3088157, -0.16585542, margin, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('binance', False, 3, 1.9, 0.0025, -3.29333333, -0.164256026, margin, 0), ('binance', True, 1, 1.9, 0.0025, 2.70630953, 0.0452182043, margin, 0), ('binance', True, 3, 1.9, 0.0025, 2.70630953, 0.135654613, margin, 0), ('binance', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('binance', False, 3, 2.2, 0.0025, 5.68416667, 0.28349958, margin, 0), ('binance', True, 1, 2.2, 0.0025, -6.3163784, -0.10553681, margin, 0), ('binance', True, 3, 2.2, 0.0025, -6.3163784, -0.31661044, margin, 0), ('kraken', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('kraken', False, 3, 2.1, 0.0025, 2.6525, 0.132294264, margin, 0), ('kraken', True, 1, 2.1, 0.0025, -3.3706575, -0.056318421, margin, 0), ('kraken', True, 3, 2.1, 0.0025, -3.3706575, -0.168955263, margin, 0), ('kraken', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('kraken', False, 3, 1.9, 0.0025, -3.3325, -0.166209476, margin, 0), ('kraken', True, 1, 1.9, 0.0025, 2.6503575, 0.044283333, margin, 0), ('kraken', True, 3, 1.9, 0.0025, 2.6503575, 0.13285, margin, 0), ('kraken', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('kraken', False, 3, 2.2, 0.0025, 5.645, 0.28154613, margin, 0), ('kraken', True, 1, 2.2, 0.0025, -6.381165, -0.1066192, margin, 0), ('kraken', True, 3, 2.2, 0.0025, -6.381165, -0.3198578, margin, 0), ('binance', False, 1, 2.1, 0.003, 2.661, 0.044239401, spot, 0), ('binance', False, 1, 1.9, 0.003, -3.3209999, -0.05521197, spot, 0), ('binance', False, 1, 2.2, 0.003, 5.652, 0.093965087, spot, 0), ('binance', False, 1, 2.1, 0.0025, 3.6925, 0.06138819, futures, 1), ('binance', False, 3, 2.1, 0.0025, 3.6925, 0.18416458, futures, 1), ('binance', True, 1, 2.1, 0.0025, -2.3074999, -0.03855472, futures, 1), ('binance', True, 3, 2.1, 0.0025, -2.3074999, -0.11566416, futures, 1), ('binance', False, 1, 1.9, 0.0025, -2.2925, -0.03811305, futures, 1), ('binance', False, 3, 1.9, 0.0025, -2.2925, -0.11433915, futures, 1), ('binance', True, 1, 1.9, 0.0025, 3.7075, 0.06194653, futures, 1), ('binance', True, 3, 1.9, 0.0025, 3.7075, 0.18583959, futures, 1), ('binance', False, 1, 2.2, 0.0025, 6.685, 0.11113881, futures, 1), ('binance', False, 3, 2.2, 0.0025, 6.685, 0.33341645, futures, 1), ('binance', True, 1, 2.2, 0.0025, -5.315, -0.08880534, futures, 1), ('binance', True, 3, 2.2, 0.0025, -5.315, -0.26641604, futures, 1), ('binance', False, 1, 2.1, 0.0025, 1.6925, 0.02813798, futures, -1), ('binance', False, 3, 2.1, 0.0025, 1.6925, 0.08441396, futures, -1), ('binance', True, 1, 2.1, 0.0025, -4.307499, -0.07197159, futures, -1), ('binance', True, 3, 2.1, 0.0025, -4.307499, -0.21591478, futures, -1), ('binance', False, 1, 1.9, 0.0025, -4.292499, -0.07136325, futures, -1), ('binance', False, 3, 1.9, 0.0025, -4.292499, -0.21408977, futures, -1), ('binance', True, 1, 1.9, 0.0025, 1.7075, 0.02852965, futures, -1), ('binance', True, 3, 1.9, 0.0025, 1.7075, 0.08558897, futures, -1), ('binance', False, 1, 2.2, 0.0025, 4.684999, 0.07788861, futures, -1), ('binance', False, 3, 2.2, 0.0025, 4.684999, 0.23366583, futures, -1), ('binance', True, 1, 2.2, 0.0025, -7.315, -0.12222222, futures, -1), ('binance', True, 3, 2.2, 0.0025, -7.315, -0.36666666, futures, -1), ('binance', False, 1, 2.1, 0.0025, 2.6925, 0.04476309, futures, 0), ('binance', False, 3, 2.1, 0.0025, 2.6925, 0.13428928, futures, 0), ('binance', True, 1, 2.1, 0.0025, -3.3074999, -0.05526316, futures, 0), ('binance', True, 3, 2.1, 0.0025, -3.3074999, -0.16578947, futures, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.05473815, futures, 0), ('binance', False, 3, 1.9, 0.0025, -3.2925, -0.16421446, futures, 0), ('binance', True, 1, 1.9, 0.0025, 2.7075, 0.0452381, futures, 0), ('binance', True, 3, 1.9, 0.0025, 2.7075, 0.13571429, futures, 0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_profit(exchange, is_short, lev, close_rate, fee_close, profit, profit_ratio, trading_mode, funding_fees):\n    \"\"\"\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\n        arguments:\n            fee:\n                0.25% quote\n                0.30% quote\n            interest_rate: 0.05% per 4 hrs\n            open_rate: 2.0 quote\n            close_rate:\n                1.9 quote\n                2.1 quote\n                2.2 quote\n            amount: = 30.0 crypto\n            stake_amount\n                1x,-1x: 60.0  quote\n                3x,-3x: 20.0  quote\n            hours: 1/6 (10 minutes)\n            funding_fees: 1\n        borrowed\n             1x:  0 quote\n             3x: 40 quote\n            -1x: 30 crypto\n            -3x: 30 crypto\n        time-periods:\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\n            binance: 1/24 24hr_periods\n        interest: borrowed * interest_rate * time-periods\n            1x            :  /\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\n            kraken -1x,-3x: 30 * 0.0005 * 2    = 0.030 crypto\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\n          0.0025 fee\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.85 quote\n          0.003 fee: Is only applied to close rate in this test\n        amount_closed:\n            1x, 3x                         = amount\n            -1x, -3x                       = amount + interest\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\n            kraken  -1x,-3x: 30 + 0.03     = 30.03 crypto\n        close_value:\n            equations:\n                1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\n                -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\n            2.1 quote\n                bin,krak  1x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025)                = 62.8425\n                bin       3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.0008333333 = 62.8416666667\n                krak      3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.040        = 62.8025\n                bin  -1x,-3x: (30.000625 * 2.1) + (30.000625 * 2.1 * 0.0025)        = 63.15881578125\n                krak -1x,-3x: (30.03 * 2.1) + (30.03 * 2.1 * 0.0025)                = 63.2206575\n            1.9 quote\n                bin,krak  1x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025)                = 56.8575\n                bin       3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.0008333333 = 56.85666667\n                krak      3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.040        = 56.8175\n                bin  -1x,-3x: (30.000625 * 1.9) + (30.000625 * 1.9 * 0.0025)        = 57.14369046875\n                krak -1x,-3x: (30.03 * 1.9) + (30.03 * 1.9 * 0.0025)                = 57.1996425\n            2.2 quote\n                bin,krak  1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)              = 65.835\n                bin       3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\n                krak      3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040      = 65.795\n                bin  -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025)      = 66.1663784375\n                krak -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)              = 66.231165\n        total_profit:\n            equations:\n                1x, 3x : close_value - open_value\n                -1x,-3x: open_value - close_value\n            2.1 quote\n                binance,kraken 1x: 62.8425     - 60.15          = 2.6925\n                binance        3x: 62.84166667 - 60.15          = 2.69166667\n                kraken         3x: 62.8025     - 60.15          = 2.6525\n                binance   -1x,-3x: 59.850      - 63.15881578125 = -3.308815781249997\n                kraken    -1x,-3x: 59.850      - 63.2206575     = -3.3706575\n            1.9 quote\n                binance,kraken 1x: 56.8575     - 60.15          = -3.2925\n                binance        3x: 56.85666667 - 60.15          = -3.29333333\n                kraken         3x: 56.8175     - 60.15          = -3.3325\n                binance   -1x,-3x: 59.850      - 57.14369046875 = 2.7063095312499996\n                kraken    -1x,-3x: 59.850      - 57.1996425     = 2.6503575\n            2.2 quote\n                binance,kraken 1x: 65.835      - 60.15          = 5.685\n                binance        3x: 65.83416667 - 60.15          = 5.68416667\n                kraken         3x: 65.795      - 60.15          = 5.645\n                binance   -1x,-3x: 59.850      - 66.1663784375  = -6.316378437499999\n                kraken    -1x,-3x: 59.850      - 66.231165      = -6.381165\n        total_profit_ratio:\n            equations:\n                1x, 3x : ((close_value/open_value) - 1) * leverage\n                -1x,-3x: (1 - (close_value/open_value)) * leverage\n            2.1 quote\n                binance,kraken 1x: (62.8425 / 60.15) - 1             = 0.04476309226932673\n                binance        3x: ((62.84166667 / 60.15) - 1)*3     = 0.13424771421446402\n                kraken         3x: ((62.8025 / 60.15) - 1)*3         = 0.13229426433915248\n                binance       -1x: 1 - (63.15881578125 / 59.850)     = -0.05528514254385963\n                binance       -3x: (1 - (63.15881578125 / 59.850))*3 = -0.1658554276315789\n                kraken        -1x: 1 - (63.2206575 / 59.850)         = -0.05631842105263152\n                kraken        -3x: (1 - (63.2206575 / 59.850))*3     = -0.16895526315789455\n            1.9 quote\n                binance,kraken 1x: (56.8575 / 60.15) - 1             = -0.05473815461346632\n                binance        3x: ((56.85666667 / 60.15) - 1)*3     = -0.16425602643391513\n                kraken         3x: ((56.8175 / 60.15) - 1)*3         = -0.16620947630922667\n                binance       -1x: 1 - (57.14369046875 / 59.850)     = 0.045218204365079395\n                binance       -3x: (1 - (57.14369046875 / 59.850))*3 = 0.13565461309523819\n                kraken        -1x: 1 - (57.1996425 / 59.850)         = 0.04428333333333334\n                kraken        -3x: (1 - (57.1996425 / 59.850))*3     = 0.13285000000000002\n            2.2 quote\n                binance,kraken 1x: (65.835 / 60.15) - 1             = 0.0945137157107232\n                binance        3x: ((65.83416667 / 60.15) - 1)*3     = 0.2834995845386534\n                kraken         3x: ((65.795 / 60.15) - 1)*3         = 0.2815461346633419\n                binance       -1x: 1 - (66.1663784375 / 59.850)     = -0.1055368159983292\n                binance       -3x: (1 - (66.1663784375 / 59.850))*3 = -0.3166104479949876\n                kraken        -1x: 1 - (66.231165 / 59.850)         = -0.106619298245614\n                kraken        -3x: (1 - (66.231165 / 59.850))*3     = -0.319857894736842\n        fee: 0.003, 1x\n            close_value:\n                2.1 quote: (30.00 * 2.1) - (30.00 * 2.1 * 0.003) = 62.811\n                1.9 quote: (30.00 * 1.9) - (30.00 * 1.9 * 0.003) = 56.829\n                2.2 quote: (30.00 * 2.2) - (30.00 * 2.2 * 0.003) = 65.802\n            total_profit\n                fee: 0.003, 1x\n                    2.1 quote: 62.811 - 60.15 = 2.6610000000000014\n                    1.9 quote: 56.829 - 60.15 = -3.320999999999998\n                    2.2 quote: 65.802 - 60.15 = 5.652000000000008\n            total_profit_ratio\n                fee: 0.003, 1x\n                    2.1 quote: (62.811 / 60.15) - 1 = 0.04423940149625927\n                    1.9 quote: (56.829 / 60.15) - 1 = -0.05521197007481293\n                    2.2 quote: (65.802 / 60.15) - 1 = 0.09396508728179565\n        futures (live):\n            funding_fee: 1\n                close_value:\n                    equations:\n                        1x,3x: (amount * close_rate) - (amount * close_rate * fee) + funding_fees\n                        -1x,-3x: (amount * close_rate) + (amount * close_rate * fee) - funding_fees\n                    2.1 quote\n                        1x,3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + 1   = 63.8425\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - 1   = 62.1575\n                    1.9 quote\n                        1x,3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + 1   = 57.8575\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - 1   = 56.1425\n                    2.2 quote:\n                        1x,3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + 1 = 66.835\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - 1 = 65.165\n                total_profit:\n                    2.1 quote\n                        1x,3x:   63.8425     - 60.15          = 3.6925\n                        -1x,-3x: 59.850      - 62.1575        = -2.3074999999999974\n                    1.9 quote\n                        1x,3x:   57.8575     - 60.15          = -2.2925\n                        -1x,-3x: 59.850      - 56.1425        = 3.707500000000003\n                    2.2 quote:\n                        1x,3x:   66.835      - 60.15          = 6.685\n                        -1x,-3x: 59.850      - 65.165         = -5.315000000000005\n                total_profit_ratio:\n                    2.1 quote\n                        1x: (63.8425 / 60.15) - 1             = 0.06138819617622615\n                        3x: ((63.8425 / 60.15) - 1)*3         = 0.18416458852867845\n                        -1x: 1 - (62.1575 / 59.850)           = -0.038554720133667564\n                        -3x: (1 - (62.1575 / 59.850))*3       = -0.11566416040100269\n                    1.9 quote\n                        1x: (57.8575 / 60.15) - 1             = -0.0381130507065669\n                        3x: ((57.8575 / 60.15) - 1)*3         = -0.1143391521197007\n                        -1x: 1 - (56.1425 / 59.850)           = 0.06194653299916464\n                        -3x: (1 - (56.1425 / 59.850))*3       = 0.18583959899749392\n                    2.2 quote\n                        1x: (66.835 / 60.15) - 1             = 0.11113881961762262\n                        3x: ((66.835 / 60.15) - 1)*3         = 0.33341645885286786\n                        -1x: 1 - (65.165 / 59.850)           = -0.08880534670008355\n                        -3x: (1 - (65.165 / 59.850))*3       = -0.26641604010025066\n            funding_fee: -1\n                close_value:\n                    equations:\n                        (amount * close_rate) - (amount * close_rate * fee) + funding_fees\n                        (amount * close_rate) - (amount * close_rate * fee) - funding_fees\n                    2.1 quote\n                        1x,3x:  (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + (-1)   = 61.8425\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - (-1)   = 64.1575\n                    1.9 quote\n                        1x,3x:  (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + (-1)   = 55.8575\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - (-1)   = 58.1425\n                    2.2 quote:\n                        1x,3x:  (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + (-1) = 64.835\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - (-1) = 67.165\n                total_profit:\n                    2.1 quote\n                        1x,3x:   61.8425     - 60.15          = 1.6925000000000026\n                        -1x,-3x: 59.850      - 64.1575        = -4.307499999999997\n                    1.9 quote\n                        1x,3x:   55.8575     - 60.15          = -4.292499999999997\n                        -1x,-3x: 59.850      - 58.1425        = 1.7075000000000031\n                    2.2 quote:\n                        1x,3x:   64.835      - 60.15          = 4.684999999999995\n                        -1x,-3x: 59.850      - 67.165         = -7.315000000000005\n                total_profit_ratio:\n                    2.1 quote\n                        1x: (61.8425 / 60.15) - 1             = 0.028137988362427313\n                        3x: ((61.8425 / 60.15) - 1)*3         = 0.08441396508728194\n                        -1x: 1 - (64.1575 / 59.850)           = -0.07197159565580624\n                        -3x: (1 - (64.1575 / 59.850))*3       = -0.21591478696741873\n                    1.9 quote\n                        1x: (55.8575 / 60.15) - 1             = -0.07136325852036574\n                        3x: ((55.8575 / 60.15) - 1)*3         = -0.2140897755610972\n                        -1x: 1 - (58.1425 / 59.850)           = 0.02852965747702596\n                        -3x: (1 - (58.1425 / 59.850))*3       = 0.08558897243107788\n                    2.2 quote\n                        1x: (64.835 / 60.15) - 1              = 0.07788861180382378\n                        3x: ((64.835 / 60.15) - 1)*3          = 0.23366583541147135\n                        -1x: 1 - (67.165 / 59.850)            = -0.12222222222222223\n                        -3x: (1 - (67.165 / 59.850))*3        = -0.3666666666666667\n    \"\"\"\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, exchange=exchange, is_short=is_short, leverage=lev, fee_open=0.0025, fee_close=fee_close, max_stake_amount=60.0, trading_mode=trading_mode, funding_fees=funding_fees)\n    profit_res = trade.calculate_profit(close_rate)\n    assert pytest.approx(profit_res.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res.profit_ratio) == round(profit_ratio, 8)\n    val = trade.open_trade_value * profit_res.profit_ratio / lev\n    assert pytest.approx(val) == profit_res.profit_abs\n    assert pytest.approx(profit_res.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(rate=close_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(rate=close_rate)) == round(profit_ratio, 8)\n    profit_res2 = trade.calculate_profit(close_rate, trade.amount, trade.open_rate)\n    assert pytest.approx(profit_res2.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res2.profit_ratio) == round(profit_ratio, 8)\n    assert pytest.approx(profit_res2.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(close_rate, trade.amount, trade.open_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(close_rate, trade.amount, trade.open_rate)) == round(profit_ratio, 8)",
        "mutated": [
            "@pytest.mark.parametrize('exchange,is_short,lev,close_rate,fee_close,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('binance', False, 3, 2.1, 0.0025, 2.69166667, 0.134247714, margin, 0), ('binance', True, 1, 2.1, 0.0025, -3.3088157, -0.055285142, margin, 0), ('binance', True, 3, 2.1, 0.0025, -3.3088157, -0.16585542, margin, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('binance', False, 3, 1.9, 0.0025, -3.29333333, -0.164256026, margin, 0), ('binance', True, 1, 1.9, 0.0025, 2.70630953, 0.0452182043, margin, 0), ('binance', True, 3, 1.9, 0.0025, 2.70630953, 0.135654613, margin, 0), ('binance', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('binance', False, 3, 2.2, 0.0025, 5.68416667, 0.28349958, margin, 0), ('binance', True, 1, 2.2, 0.0025, -6.3163784, -0.10553681, margin, 0), ('binance', True, 3, 2.2, 0.0025, -6.3163784, -0.31661044, margin, 0), ('kraken', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('kraken', False, 3, 2.1, 0.0025, 2.6525, 0.132294264, margin, 0), ('kraken', True, 1, 2.1, 0.0025, -3.3706575, -0.056318421, margin, 0), ('kraken', True, 3, 2.1, 0.0025, -3.3706575, -0.168955263, margin, 0), ('kraken', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('kraken', False, 3, 1.9, 0.0025, -3.3325, -0.166209476, margin, 0), ('kraken', True, 1, 1.9, 0.0025, 2.6503575, 0.044283333, margin, 0), ('kraken', True, 3, 1.9, 0.0025, 2.6503575, 0.13285, margin, 0), ('kraken', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('kraken', False, 3, 2.2, 0.0025, 5.645, 0.28154613, margin, 0), ('kraken', True, 1, 2.2, 0.0025, -6.381165, -0.1066192, margin, 0), ('kraken', True, 3, 2.2, 0.0025, -6.381165, -0.3198578, margin, 0), ('binance', False, 1, 2.1, 0.003, 2.661, 0.044239401, spot, 0), ('binance', False, 1, 1.9, 0.003, -3.3209999, -0.05521197, spot, 0), ('binance', False, 1, 2.2, 0.003, 5.652, 0.093965087, spot, 0), ('binance', False, 1, 2.1, 0.0025, 3.6925, 0.06138819, futures, 1), ('binance', False, 3, 2.1, 0.0025, 3.6925, 0.18416458, futures, 1), ('binance', True, 1, 2.1, 0.0025, -2.3074999, -0.03855472, futures, 1), ('binance', True, 3, 2.1, 0.0025, -2.3074999, -0.11566416, futures, 1), ('binance', False, 1, 1.9, 0.0025, -2.2925, -0.03811305, futures, 1), ('binance', False, 3, 1.9, 0.0025, -2.2925, -0.11433915, futures, 1), ('binance', True, 1, 1.9, 0.0025, 3.7075, 0.06194653, futures, 1), ('binance', True, 3, 1.9, 0.0025, 3.7075, 0.18583959, futures, 1), ('binance', False, 1, 2.2, 0.0025, 6.685, 0.11113881, futures, 1), ('binance', False, 3, 2.2, 0.0025, 6.685, 0.33341645, futures, 1), ('binance', True, 1, 2.2, 0.0025, -5.315, -0.08880534, futures, 1), ('binance', True, 3, 2.2, 0.0025, -5.315, -0.26641604, futures, 1), ('binance', False, 1, 2.1, 0.0025, 1.6925, 0.02813798, futures, -1), ('binance', False, 3, 2.1, 0.0025, 1.6925, 0.08441396, futures, -1), ('binance', True, 1, 2.1, 0.0025, -4.307499, -0.07197159, futures, -1), ('binance', True, 3, 2.1, 0.0025, -4.307499, -0.21591478, futures, -1), ('binance', False, 1, 1.9, 0.0025, -4.292499, -0.07136325, futures, -1), ('binance', False, 3, 1.9, 0.0025, -4.292499, -0.21408977, futures, -1), ('binance', True, 1, 1.9, 0.0025, 1.7075, 0.02852965, futures, -1), ('binance', True, 3, 1.9, 0.0025, 1.7075, 0.08558897, futures, -1), ('binance', False, 1, 2.2, 0.0025, 4.684999, 0.07788861, futures, -1), ('binance', False, 3, 2.2, 0.0025, 4.684999, 0.23366583, futures, -1), ('binance', True, 1, 2.2, 0.0025, -7.315, -0.12222222, futures, -1), ('binance', True, 3, 2.2, 0.0025, -7.315, -0.36666666, futures, -1), ('binance', False, 1, 2.1, 0.0025, 2.6925, 0.04476309, futures, 0), ('binance', False, 3, 2.1, 0.0025, 2.6925, 0.13428928, futures, 0), ('binance', True, 1, 2.1, 0.0025, -3.3074999, -0.05526316, futures, 0), ('binance', True, 3, 2.1, 0.0025, -3.3074999, -0.16578947, futures, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.05473815, futures, 0), ('binance', False, 3, 1.9, 0.0025, -3.2925, -0.16421446, futures, 0), ('binance', True, 1, 1.9, 0.0025, 2.7075, 0.0452381, futures, 0), ('binance', True, 3, 1.9, 0.0025, 2.7075, 0.13571429, futures, 0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_profit(exchange, is_short, lev, close_rate, fee_close, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        arguments:\\n            fee:\\n                0.25% quote\\n                0.30% quote\\n            interest_rate: 0.05% per 4 hrs\\n            open_rate: 2.0 quote\\n            close_rate:\\n                1.9 quote\\n                2.1 quote\\n                2.2 quote\\n            amount: = 30.0 crypto\\n            stake_amount\\n                1x,-1x: 60.0  quote\\n                3x,-3x: 20.0  quote\\n            hours: 1/6 (10 minutes)\\n            funding_fees: 1\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2    = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n          0.0025 fee\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.85 quote\\n          0.003 fee: Is only applied to close rate in this test\\n        amount_closed:\\n            1x, 3x                         = amount\\n            -1x, -3x                       = amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03     = 30.03 crypto\\n        close_value:\\n            equations:\\n                1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n                -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            2.1 quote\\n                bin,krak  1x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025)                = 62.8425\\n                bin       3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.0008333333 = 62.8416666667\\n                krak      3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.040        = 62.8025\\n                bin  -1x,-3x: (30.000625 * 2.1) + (30.000625 * 2.1 * 0.0025)        = 63.15881578125\\n                krak -1x,-3x: (30.03 * 2.1) + (30.03 * 2.1 * 0.0025)                = 63.2206575\\n            1.9 quote\\n                bin,krak  1x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025)                = 56.8575\\n                bin       3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.0008333333 = 56.85666667\\n                krak      3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.040        = 56.8175\\n                bin  -1x,-3x: (30.000625 * 1.9) + (30.000625 * 1.9 * 0.0025)        = 57.14369046875\\n                krak -1x,-3x: (30.03 * 1.9) + (30.03 * 1.9 * 0.0025)                = 57.1996425\\n            2.2 quote\\n                bin,krak  1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)              = 65.835\\n                bin       3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n                krak      3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040      = 65.795\\n                bin  -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025)      = 66.1663784375\\n                krak -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)              = 66.231165\\n        total_profit:\\n            equations:\\n                1x, 3x : close_value - open_value\\n                -1x,-3x: open_value - close_value\\n            2.1 quote\\n                binance,kraken 1x: 62.8425     - 60.15          = 2.6925\\n                binance        3x: 62.84166667 - 60.15          = 2.69166667\\n                kraken         3x: 62.8025     - 60.15          = 2.6525\\n                binance   -1x,-3x: 59.850      - 63.15881578125 = -3.308815781249997\\n                kraken    -1x,-3x: 59.850      - 63.2206575     = -3.3706575\\n            1.9 quote\\n                binance,kraken 1x: 56.8575     - 60.15          = -3.2925\\n                binance        3x: 56.85666667 - 60.15          = -3.29333333\\n                kraken         3x: 56.8175     - 60.15          = -3.3325\\n                binance   -1x,-3x: 59.850      - 57.14369046875 = 2.7063095312499996\\n                kraken    -1x,-3x: 59.850      - 57.1996425     = 2.6503575\\n            2.2 quote\\n                binance,kraken 1x: 65.835      - 60.15          = 5.685\\n                binance        3x: 65.83416667 - 60.15          = 5.68416667\\n                kraken         3x: 65.795      - 60.15          = 5.645\\n                binance   -1x,-3x: 59.850      - 66.1663784375  = -6.316378437499999\\n                kraken    -1x,-3x: 59.850      - 66.231165      = -6.381165\\n        total_profit_ratio:\\n            equations:\\n                1x, 3x : ((close_value/open_value) - 1) * leverage\\n                -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            2.1 quote\\n                binance,kraken 1x: (62.8425 / 60.15) - 1             = 0.04476309226932673\\n                binance        3x: ((62.84166667 / 60.15) - 1)*3     = 0.13424771421446402\\n                kraken         3x: ((62.8025 / 60.15) - 1)*3         = 0.13229426433915248\\n                binance       -1x: 1 - (63.15881578125 / 59.850)     = -0.05528514254385963\\n                binance       -3x: (1 - (63.15881578125 / 59.850))*3 = -0.1658554276315789\\n                kraken        -1x: 1 - (63.2206575 / 59.850)         = -0.05631842105263152\\n                kraken        -3x: (1 - (63.2206575 / 59.850))*3     = -0.16895526315789455\\n            1.9 quote\\n                binance,kraken 1x: (56.8575 / 60.15) - 1             = -0.05473815461346632\\n                binance        3x: ((56.85666667 / 60.15) - 1)*3     = -0.16425602643391513\\n                kraken         3x: ((56.8175 / 60.15) - 1)*3         = -0.16620947630922667\\n                binance       -1x: 1 - (57.14369046875 / 59.850)     = 0.045218204365079395\\n                binance       -3x: (1 - (57.14369046875 / 59.850))*3 = 0.13565461309523819\\n                kraken        -1x: 1 - (57.1996425 / 59.850)         = 0.04428333333333334\\n                kraken        -3x: (1 - (57.1996425 / 59.850))*3     = 0.13285000000000002\\n            2.2 quote\\n                binance,kraken 1x: (65.835 / 60.15) - 1             = 0.0945137157107232\\n                binance        3x: ((65.83416667 / 60.15) - 1)*3     = 0.2834995845386534\\n                kraken         3x: ((65.795 / 60.15) - 1)*3         = 0.2815461346633419\\n                binance       -1x: 1 - (66.1663784375 / 59.850)     = -0.1055368159983292\\n                binance       -3x: (1 - (66.1663784375 / 59.850))*3 = -0.3166104479949876\\n                kraken        -1x: 1 - (66.231165 / 59.850)         = -0.106619298245614\\n                kraken        -3x: (1 - (66.231165 / 59.850))*3     = -0.319857894736842\\n        fee: 0.003, 1x\\n            close_value:\\n                2.1 quote: (30.00 * 2.1) - (30.00 * 2.1 * 0.003) = 62.811\\n                1.9 quote: (30.00 * 1.9) - (30.00 * 1.9 * 0.003) = 56.829\\n                2.2 quote: (30.00 * 2.2) - (30.00 * 2.2 * 0.003) = 65.802\\n            total_profit\\n                fee: 0.003, 1x\\n                    2.1 quote: 62.811 - 60.15 = 2.6610000000000014\\n                    1.9 quote: 56.829 - 60.15 = -3.320999999999998\\n                    2.2 quote: 65.802 - 60.15 = 5.652000000000008\\n            total_profit_ratio\\n                fee: 0.003, 1x\\n                    2.1 quote: (62.811 / 60.15) - 1 = 0.04423940149625927\\n                    1.9 quote: (56.829 / 60.15) - 1 = -0.05521197007481293\\n                    2.2 quote: (65.802 / 60.15) - 1 = 0.09396508728179565\\n        futures (live):\\n            funding_fee: 1\\n                close_value:\\n                    equations:\\n                        1x,3x: (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        -1x,-3x: (amount * close_rate) + (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + 1   = 63.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - 1   = 62.1575\\n                    1.9 quote\\n                        1x,3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + 1   = 57.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - 1   = 56.1425\\n                    2.2 quote:\\n                        1x,3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + 1 = 66.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - 1 = 65.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   63.8425     - 60.15          = 3.6925\\n                        -1x,-3x: 59.850      - 62.1575        = -2.3074999999999974\\n                    1.9 quote\\n                        1x,3x:   57.8575     - 60.15          = -2.2925\\n                        -1x,-3x: 59.850      - 56.1425        = 3.707500000000003\\n                    2.2 quote:\\n                        1x,3x:   66.835      - 60.15          = 6.685\\n                        -1x,-3x: 59.850      - 65.165         = -5.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (63.8425 / 60.15) - 1             = 0.06138819617622615\\n                        3x: ((63.8425 / 60.15) - 1)*3         = 0.18416458852867845\\n                        -1x: 1 - (62.1575 / 59.850)           = -0.038554720133667564\\n                        -3x: (1 - (62.1575 / 59.850))*3       = -0.11566416040100269\\n                    1.9 quote\\n                        1x: (57.8575 / 60.15) - 1             = -0.0381130507065669\\n                        3x: ((57.8575 / 60.15) - 1)*3         = -0.1143391521197007\\n                        -1x: 1 - (56.1425 / 59.850)           = 0.06194653299916464\\n                        -3x: (1 - (56.1425 / 59.850))*3       = 0.18583959899749392\\n                    2.2 quote\\n                        1x: (66.835 / 60.15) - 1             = 0.11113881961762262\\n                        3x: ((66.835 / 60.15) - 1)*3         = 0.33341645885286786\\n                        -1x: 1 - (65.165 / 59.850)           = -0.08880534670008355\\n                        -3x: (1 - (65.165 / 59.850))*3       = -0.26641604010025066\\n            funding_fee: -1\\n                close_value:\\n                    equations:\\n                        (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        (amount * close_rate) - (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x:  (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + (-1)   = 61.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - (-1)   = 64.1575\\n                    1.9 quote\\n                        1x,3x:  (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + (-1)   = 55.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - (-1)   = 58.1425\\n                    2.2 quote:\\n                        1x,3x:  (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + (-1) = 64.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - (-1) = 67.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   61.8425     - 60.15          = 1.6925000000000026\\n                        -1x,-3x: 59.850      - 64.1575        = -4.307499999999997\\n                    1.9 quote\\n                        1x,3x:   55.8575     - 60.15          = -4.292499999999997\\n                        -1x,-3x: 59.850      - 58.1425        = 1.7075000000000031\\n                    2.2 quote:\\n                        1x,3x:   64.835      - 60.15          = 4.684999999999995\\n                        -1x,-3x: 59.850      - 67.165         = -7.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (61.8425 / 60.15) - 1             = 0.028137988362427313\\n                        3x: ((61.8425 / 60.15) - 1)*3         = 0.08441396508728194\\n                        -1x: 1 - (64.1575 / 59.850)           = -0.07197159565580624\\n                        -3x: (1 - (64.1575 / 59.850))*3       = -0.21591478696741873\\n                    1.9 quote\\n                        1x: (55.8575 / 60.15) - 1             = -0.07136325852036574\\n                        3x: ((55.8575 / 60.15) - 1)*3         = -0.2140897755610972\\n                        -1x: 1 - (58.1425 / 59.850)           = 0.02852965747702596\\n                        -3x: (1 - (58.1425 / 59.850))*3       = 0.08558897243107788\\n                    2.2 quote\\n                        1x: (64.835 / 60.15) - 1              = 0.07788861180382378\\n                        3x: ((64.835 / 60.15) - 1)*3          = 0.23366583541147135\\n                        -1x: 1 - (67.165 / 59.850)            = -0.12222222222222223\\n                        -3x: (1 - (67.165 / 59.850))*3        = -0.3666666666666667\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, exchange=exchange, is_short=is_short, leverage=lev, fee_open=0.0025, fee_close=fee_close, max_stake_amount=60.0, trading_mode=trading_mode, funding_fees=funding_fees)\n    profit_res = trade.calculate_profit(close_rate)\n    assert pytest.approx(profit_res.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res.profit_ratio) == round(profit_ratio, 8)\n    val = trade.open_trade_value * profit_res.profit_ratio / lev\n    assert pytest.approx(val) == profit_res.profit_abs\n    assert pytest.approx(profit_res.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(rate=close_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(rate=close_rate)) == round(profit_ratio, 8)\n    profit_res2 = trade.calculate_profit(close_rate, trade.amount, trade.open_rate)\n    assert pytest.approx(profit_res2.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res2.profit_ratio) == round(profit_ratio, 8)\n    assert pytest.approx(profit_res2.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(close_rate, trade.amount, trade.open_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(close_rate, trade.amount, trade.open_rate)) == round(profit_ratio, 8)",
            "@pytest.mark.parametrize('exchange,is_short,lev,close_rate,fee_close,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('binance', False, 3, 2.1, 0.0025, 2.69166667, 0.134247714, margin, 0), ('binance', True, 1, 2.1, 0.0025, -3.3088157, -0.055285142, margin, 0), ('binance', True, 3, 2.1, 0.0025, -3.3088157, -0.16585542, margin, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('binance', False, 3, 1.9, 0.0025, -3.29333333, -0.164256026, margin, 0), ('binance', True, 1, 1.9, 0.0025, 2.70630953, 0.0452182043, margin, 0), ('binance', True, 3, 1.9, 0.0025, 2.70630953, 0.135654613, margin, 0), ('binance', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('binance', False, 3, 2.2, 0.0025, 5.68416667, 0.28349958, margin, 0), ('binance', True, 1, 2.2, 0.0025, -6.3163784, -0.10553681, margin, 0), ('binance', True, 3, 2.2, 0.0025, -6.3163784, -0.31661044, margin, 0), ('kraken', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('kraken', False, 3, 2.1, 0.0025, 2.6525, 0.132294264, margin, 0), ('kraken', True, 1, 2.1, 0.0025, -3.3706575, -0.056318421, margin, 0), ('kraken', True, 3, 2.1, 0.0025, -3.3706575, -0.168955263, margin, 0), ('kraken', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('kraken', False, 3, 1.9, 0.0025, -3.3325, -0.166209476, margin, 0), ('kraken', True, 1, 1.9, 0.0025, 2.6503575, 0.044283333, margin, 0), ('kraken', True, 3, 1.9, 0.0025, 2.6503575, 0.13285, margin, 0), ('kraken', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('kraken', False, 3, 2.2, 0.0025, 5.645, 0.28154613, margin, 0), ('kraken', True, 1, 2.2, 0.0025, -6.381165, -0.1066192, margin, 0), ('kraken', True, 3, 2.2, 0.0025, -6.381165, -0.3198578, margin, 0), ('binance', False, 1, 2.1, 0.003, 2.661, 0.044239401, spot, 0), ('binance', False, 1, 1.9, 0.003, -3.3209999, -0.05521197, spot, 0), ('binance', False, 1, 2.2, 0.003, 5.652, 0.093965087, spot, 0), ('binance', False, 1, 2.1, 0.0025, 3.6925, 0.06138819, futures, 1), ('binance', False, 3, 2.1, 0.0025, 3.6925, 0.18416458, futures, 1), ('binance', True, 1, 2.1, 0.0025, -2.3074999, -0.03855472, futures, 1), ('binance', True, 3, 2.1, 0.0025, -2.3074999, -0.11566416, futures, 1), ('binance', False, 1, 1.9, 0.0025, -2.2925, -0.03811305, futures, 1), ('binance', False, 3, 1.9, 0.0025, -2.2925, -0.11433915, futures, 1), ('binance', True, 1, 1.9, 0.0025, 3.7075, 0.06194653, futures, 1), ('binance', True, 3, 1.9, 0.0025, 3.7075, 0.18583959, futures, 1), ('binance', False, 1, 2.2, 0.0025, 6.685, 0.11113881, futures, 1), ('binance', False, 3, 2.2, 0.0025, 6.685, 0.33341645, futures, 1), ('binance', True, 1, 2.2, 0.0025, -5.315, -0.08880534, futures, 1), ('binance', True, 3, 2.2, 0.0025, -5.315, -0.26641604, futures, 1), ('binance', False, 1, 2.1, 0.0025, 1.6925, 0.02813798, futures, -1), ('binance', False, 3, 2.1, 0.0025, 1.6925, 0.08441396, futures, -1), ('binance', True, 1, 2.1, 0.0025, -4.307499, -0.07197159, futures, -1), ('binance', True, 3, 2.1, 0.0025, -4.307499, -0.21591478, futures, -1), ('binance', False, 1, 1.9, 0.0025, -4.292499, -0.07136325, futures, -1), ('binance', False, 3, 1.9, 0.0025, -4.292499, -0.21408977, futures, -1), ('binance', True, 1, 1.9, 0.0025, 1.7075, 0.02852965, futures, -1), ('binance', True, 3, 1.9, 0.0025, 1.7075, 0.08558897, futures, -1), ('binance', False, 1, 2.2, 0.0025, 4.684999, 0.07788861, futures, -1), ('binance', False, 3, 2.2, 0.0025, 4.684999, 0.23366583, futures, -1), ('binance', True, 1, 2.2, 0.0025, -7.315, -0.12222222, futures, -1), ('binance', True, 3, 2.2, 0.0025, -7.315, -0.36666666, futures, -1), ('binance', False, 1, 2.1, 0.0025, 2.6925, 0.04476309, futures, 0), ('binance', False, 3, 2.1, 0.0025, 2.6925, 0.13428928, futures, 0), ('binance', True, 1, 2.1, 0.0025, -3.3074999, -0.05526316, futures, 0), ('binance', True, 3, 2.1, 0.0025, -3.3074999, -0.16578947, futures, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.05473815, futures, 0), ('binance', False, 3, 1.9, 0.0025, -3.2925, -0.16421446, futures, 0), ('binance', True, 1, 1.9, 0.0025, 2.7075, 0.0452381, futures, 0), ('binance', True, 3, 1.9, 0.0025, 2.7075, 0.13571429, futures, 0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_profit(exchange, is_short, lev, close_rate, fee_close, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        arguments:\\n            fee:\\n                0.25% quote\\n                0.30% quote\\n            interest_rate: 0.05% per 4 hrs\\n            open_rate: 2.0 quote\\n            close_rate:\\n                1.9 quote\\n                2.1 quote\\n                2.2 quote\\n            amount: = 30.0 crypto\\n            stake_amount\\n                1x,-1x: 60.0  quote\\n                3x,-3x: 20.0  quote\\n            hours: 1/6 (10 minutes)\\n            funding_fees: 1\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2    = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n          0.0025 fee\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.85 quote\\n          0.003 fee: Is only applied to close rate in this test\\n        amount_closed:\\n            1x, 3x                         = amount\\n            -1x, -3x                       = amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03     = 30.03 crypto\\n        close_value:\\n            equations:\\n                1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n                -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            2.1 quote\\n                bin,krak  1x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025)                = 62.8425\\n                bin       3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.0008333333 = 62.8416666667\\n                krak      3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.040        = 62.8025\\n                bin  -1x,-3x: (30.000625 * 2.1) + (30.000625 * 2.1 * 0.0025)        = 63.15881578125\\n                krak -1x,-3x: (30.03 * 2.1) + (30.03 * 2.1 * 0.0025)                = 63.2206575\\n            1.9 quote\\n                bin,krak  1x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025)                = 56.8575\\n                bin       3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.0008333333 = 56.85666667\\n                krak      3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.040        = 56.8175\\n                bin  -1x,-3x: (30.000625 * 1.9) + (30.000625 * 1.9 * 0.0025)        = 57.14369046875\\n                krak -1x,-3x: (30.03 * 1.9) + (30.03 * 1.9 * 0.0025)                = 57.1996425\\n            2.2 quote\\n                bin,krak  1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)              = 65.835\\n                bin       3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n                krak      3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040      = 65.795\\n                bin  -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025)      = 66.1663784375\\n                krak -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)              = 66.231165\\n        total_profit:\\n            equations:\\n                1x, 3x : close_value - open_value\\n                -1x,-3x: open_value - close_value\\n            2.1 quote\\n                binance,kraken 1x: 62.8425     - 60.15          = 2.6925\\n                binance        3x: 62.84166667 - 60.15          = 2.69166667\\n                kraken         3x: 62.8025     - 60.15          = 2.6525\\n                binance   -1x,-3x: 59.850      - 63.15881578125 = -3.308815781249997\\n                kraken    -1x,-3x: 59.850      - 63.2206575     = -3.3706575\\n            1.9 quote\\n                binance,kraken 1x: 56.8575     - 60.15          = -3.2925\\n                binance        3x: 56.85666667 - 60.15          = -3.29333333\\n                kraken         3x: 56.8175     - 60.15          = -3.3325\\n                binance   -1x,-3x: 59.850      - 57.14369046875 = 2.7063095312499996\\n                kraken    -1x,-3x: 59.850      - 57.1996425     = 2.6503575\\n            2.2 quote\\n                binance,kraken 1x: 65.835      - 60.15          = 5.685\\n                binance        3x: 65.83416667 - 60.15          = 5.68416667\\n                kraken         3x: 65.795      - 60.15          = 5.645\\n                binance   -1x,-3x: 59.850      - 66.1663784375  = -6.316378437499999\\n                kraken    -1x,-3x: 59.850      - 66.231165      = -6.381165\\n        total_profit_ratio:\\n            equations:\\n                1x, 3x : ((close_value/open_value) - 1) * leverage\\n                -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            2.1 quote\\n                binance,kraken 1x: (62.8425 / 60.15) - 1             = 0.04476309226932673\\n                binance        3x: ((62.84166667 / 60.15) - 1)*3     = 0.13424771421446402\\n                kraken         3x: ((62.8025 / 60.15) - 1)*3         = 0.13229426433915248\\n                binance       -1x: 1 - (63.15881578125 / 59.850)     = -0.05528514254385963\\n                binance       -3x: (1 - (63.15881578125 / 59.850))*3 = -0.1658554276315789\\n                kraken        -1x: 1 - (63.2206575 / 59.850)         = -0.05631842105263152\\n                kraken        -3x: (1 - (63.2206575 / 59.850))*3     = -0.16895526315789455\\n            1.9 quote\\n                binance,kraken 1x: (56.8575 / 60.15) - 1             = -0.05473815461346632\\n                binance        3x: ((56.85666667 / 60.15) - 1)*3     = -0.16425602643391513\\n                kraken         3x: ((56.8175 / 60.15) - 1)*3         = -0.16620947630922667\\n                binance       -1x: 1 - (57.14369046875 / 59.850)     = 0.045218204365079395\\n                binance       -3x: (1 - (57.14369046875 / 59.850))*3 = 0.13565461309523819\\n                kraken        -1x: 1 - (57.1996425 / 59.850)         = 0.04428333333333334\\n                kraken        -3x: (1 - (57.1996425 / 59.850))*3     = 0.13285000000000002\\n            2.2 quote\\n                binance,kraken 1x: (65.835 / 60.15) - 1             = 0.0945137157107232\\n                binance        3x: ((65.83416667 / 60.15) - 1)*3     = 0.2834995845386534\\n                kraken         3x: ((65.795 / 60.15) - 1)*3         = 0.2815461346633419\\n                binance       -1x: 1 - (66.1663784375 / 59.850)     = -0.1055368159983292\\n                binance       -3x: (1 - (66.1663784375 / 59.850))*3 = -0.3166104479949876\\n                kraken        -1x: 1 - (66.231165 / 59.850)         = -0.106619298245614\\n                kraken        -3x: (1 - (66.231165 / 59.850))*3     = -0.319857894736842\\n        fee: 0.003, 1x\\n            close_value:\\n                2.1 quote: (30.00 * 2.1) - (30.00 * 2.1 * 0.003) = 62.811\\n                1.9 quote: (30.00 * 1.9) - (30.00 * 1.9 * 0.003) = 56.829\\n                2.2 quote: (30.00 * 2.2) - (30.00 * 2.2 * 0.003) = 65.802\\n            total_profit\\n                fee: 0.003, 1x\\n                    2.1 quote: 62.811 - 60.15 = 2.6610000000000014\\n                    1.9 quote: 56.829 - 60.15 = -3.320999999999998\\n                    2.2 quote: 65.802 - 60.15 = 5.652000000000008\\n            total_profit_ratio\\n                fee: 0.003, 1x\\n                    2.1 quote: (62.811 / 60.15) - 1 = 0.04423940149625927\\n                    1.9 quote: (56.829 / 60.15) - 1 = -0.05521197007481293\\n                    2.2 quote: (65.802 / 60.15) - 1 = 0.09396508728179565\\n        futures (live):\\n            funding_fee: 1\\n                close_value:\\n                    equations:\\n                        1x,3x: (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        -1x,-3x: (amount * close_rate) + (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + 1   = 63.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - 1   = 62.1575\\n                    1.9 quote\\n                        1x,3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + 1   = 57.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - 1   = 56.1425\\n                    2.2 quote:\\n                        1x,3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + 1 = 66.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - 1 = 65.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   63.8425     - 60.15          = 3.6925\\n                        -1x,-3x: 59.850      - 62.1575        = -2.3074999999999974\\n                    1.9 quote\\n                        1x,3x:   57.8575     - 60.15          = -2.2925\\n                        -1x,-3x: 59.850      - 56.1425        = 3.707500000000003\\n                    2.2 quote:\\n                        1x,3x:   66.835      - 60.15          = 6.685\\n                        -1x,-3x: 59.850      - 65.165         = -5.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (63.8425 / 60.15) - 1             = 0.06138819617622615\\n                        3x: ((63.8425 / 60.15) - 1)*3         = 0.18416458852867845\\n                        -1x: 1 - (62.1575 / 59.850)           = -0.038554720133667564\\n                        -3x: (1 - (62.1575 / 59.850))*3       = -0.11566416040100269\\n                    1.9 quote\\n                        1x: (57.8575 / 60.15) - 1             = -0.0381130507065669\\n                        3x: ((57.8575 / 60.15) - 1)*3         = -0.1143391521197007\\n                        -1x: 1 - (56.1425 / 59.850)           = 0.06194653299916464\\n                        -3x: (1 - (56.1425 / 59.850))*3       = 0.18583959899749392\\n                    2.2 quote\\n                        1x: (66.835 / 60.15) - 1             = 0.11113881961762262\\n                        3x: ((66.835 / 60.15) - 1)*3         = 0.33341645885286786\\n                        -1x: 1 - (65.165 / 59.850)           = -0.08880534670008355\\n                        -3x: (1 - (65.165 / 59.850))*3       = -0.26641604010025066\\n            funding_fee: -1\\n                close_value:\\n                    equations:\\n                        (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        (amount * close_rate) - (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x:  (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + (-1)   = 61.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - (-1)   = 64.1575\\n                    1.9 quote\\n                        1x,3x:  (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + (-1)   = 55.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - (-1)   = 58.1425\\n                    2.2 quote:\\n                        1x,3x:  (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + (-1) = 64.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - (-1) = 67.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   61.8425     - 60.15          = 1.6925000000000026\\n                        -1x,-3x: 59.850      - 64.1575        = -4.307499999999997\\n                    1.9 quote\\n                        1x,3x:   55.8575     - 60.15          = -4.292499999999997\\n                        -1x,-3x: 59.850      - 58.1425        = 1.7075000000000031\\n                    2.2 quote:\\n                        1x,3x:   64.835      - 60.15          = 4.684999999999995\\n                        -1x,-3x: 59.850      - 67.165         = -7.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (61.8425 / 60.15) - 1             = 0.028137988362427313\\n                        3x: ((61.8425 / 60.15) - 1)*3         = 0.08441396508728194\\n                        -1x: 1 - (64.1575 / 59.850)           = -0.07197159565580624\\n                        -3x: (1 - (64.1575 / 59.850))*3       = -0.21591478696741873\\n                    1.9 quote\\n                        1x: (55.8575 / 60.15) - 1             = -0.07136325852036574\\n                        3x: ((55.8575 / 60.15) - 1)*3         = -0.2140897755610972\\n                        -1x: 1 - (58.1425 / 59.850)           = 0.02852965747702596\\n                        -3x: (1 - (58.1425 / 59.850))*3       = 0.08558897243107788\\n                    2.2 quote\\n                        1x: (64.835 / 60.15) - 1              = 0.07788861180382378\\n                        3x: ((64.835 / 60.15) - 1)*3          = 0.23366583541147135\\n                        -1x: 1 - (67.165 / 59.850)            = -0.12222222222222223\\n                        -3x: (1 - (67.165 / 59.850))*3        = -0.3666666666666667\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, exchange=exchange, is_short=is_short, leverage=lev, fee_open=0.0025, fee_close=fee_close, max_stake_amount=60.0, trading_mode=trading_mode, funding_fees=funding_fees)\n    profit_res = trade.calculate_profit(close_rate)\n    assert pytest.approx(profit_res.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res.profit_ratio) == round(profit_ratio, 8)\n    val = trade.open_trade_value * profit_res.profit_ratio / lev\n    assert pytest.approx(val) == profit_res.profit_abs\n    assert pytest.approx(profit_res.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(rate=close_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(rate=close_rate)) == round(profit_ratio, 8)\n    profit_res2 = trade.calculate_profit(close_rate, trade.amount, trade.open_rate)\n    assert pytest.approx(profit_res2.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res2.profit_ratio) == round(profit_ratio, 8)\n    assert pytest.approx(profit_res2.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(close_rate, trade.amount, trade.open_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(close_rate, trade.amount, trade.open_rate)) == round(profit_ratio, 8)",
            "@pytest.mark.parametrize('exchange,is_short,lev,close_rate,fee_close,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('binance', False, 3, 2.1, 0.0025, 2.69166667, 0.134247714, margin, 0), ('binance', True, 1, 2.1, 0.0025, -3.3088157, -0.055285142, margin, 0), ('binance', True, 3, 2.1, 0.0025, -3.3088157, -0.16585542, margin, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('binance', False, 3, 1.9, 0.0025, -3.29333333, -0.164256026, margin, 0), ('binance', True, 1, 1.9, 0.0025, 2.70630953, 0.0452182043, margin, 0), ('binance', True, 3, 1.9, 0.0025, 2.70630953, 0.135654613, margin, 0), ('binance', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('binance', False, 3, 2.2, 0.0025, 5.68416667, 0.28349958, margin, 0), ('binance', True, 1, 2.2, 0.0025, -6.3163784, -0.10553681, margin, 0), ('binance', True, 3, 2.2, 0.0025, -6.3163784, -0.31661044, margin, 0), ('kraken', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('kraken', False, 3, 2.1, 0.0025, 2.6525, 0.132294264, margin, 0), ('kraken', True, 1, 2.1, 0.0025, -3.3706575, -0.056318421, margin, 0), ('kraken', True, 3, 2.1, 0.0025, -3.3706575, -0.168955263, margin, 0), ('kraken', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('kraken', False, 3, 1.9, 0.0025, -3.3325, -0.166209476, margin, 0), ('kraken', True, 1, 1.9, 0.0025, 2.6503575, 0.044283333, margin, 0), ('kraken', True, 3, 1.9, 0.0025, 2.6503575, 0.13285, margin, 0), ('kraken', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('kraken', False, 3, 2.2, 0.0025, 5.645, 0.28154613, margin, 0), ('kraken', True, 1, 2.2, 0.0025, -6.381165, -0.1066192, margin, 0), ('kraken', True, 3, 2.2, 0.0025, -6.381165, -0.3198578, margin, 0), ('binance', False, 1, 2.1, 0.003, 2.661, 0.044239401, spot, 0), ('binance', False, 1, 1.9, 0.003, -3.3209999, -0.05521197, spot, 0), ('binance', False, 1, 2.2, 0.003, 5.652, 0.093965087, spot, 0), ('binance', False, 1, 2.1, 0.0025, 3.6925, 0.06138819, futures, 1), ('binance', False, 3, 2.1, 0.0025, 3.6925, 0.18416458, futures, 1), ('binance', True, 1, 2.1, 0.0025, -2.3074999, -0.03855472, futures, 1), ('binance', True, 3, 2.1, 0.0025, -2.3074999, -0.11566416, futures, 1), ('binance', False, 1, 1.9, 0.0025, -2.2925, -0.03811305, futures, 1), ('binance', False, 3, 1.9, 0.0025, -2.2925, -0.11433915, futures, 1), ('binance', True, 1, 1.9, 0.0025, 3.7075, 0.06194653, futures, 1), ('binance', True, 3, 1.9, 0.0025, 3.7075, 0.18583959, futures, 1), ('binance', False, 1, 2.2, 0.0025, 6.685, 0.11113881, futures, 1), ('binance', False, 3, 2.2, 0.0025, 6.685, 0.33341645, futures, 1), ('binance', True, 1, 2.2, 0.0025, -5.315, -0.08880534, futures, 1), ('binance', True, 3, 2.2, 0.0025, -5.315, -0.26641604, futures, 1), ('binance', False, 1, 2.1, 0.0025, 1.6925, 0.02813798, futures, -1), ('binance', False, 3, 2.1, 0.0025, 1.6925, 0.08441396, futures, -1), ('binance', True, 1, 2.1, 0.0025, -4.307499, -0.07197159, futures, -1), ('binance', True, 3, 2.1, 0.0025, -4.307499, -0.21591478, futures, -1), ('binance', False, 1, 1.9, 0.0025, -4.292499, -0.07136325, futures, -1), ('binance', False, 3, 1.9, 0.0025, -4.292499, -0.21408977, futures, -1), ('binance', True, 1, 1.9, 0.0025, 1.7075, 0.02852965, futures, -1), ('binance', True, 3, 1.9, 0.0025, 1.7075, 0.08558897, futures, -1), ('binance', False, 1, 2.2, 0.0025, 4.684999, 0.07788861, futures, -1), ('binance', False, 3, 2.2, 0.0025, 4.684999, 0.23366583, futures, -1), ('binance', True, 1, 2.2, 0.0025, -7.315, -0.12222222, futures, -1), ('binance', True, 3, 2.2, 0.0025, -7.315, -0.36666666, futures, -1), ('binance', False, 1, 2.1, 0.0025, 2.6925, 0.04476309, futures, 0), ('binance', False, 3, 2.1, 0.0025, 2.6925, 0.13428928, futures, 0), ('binance', True, 1, 2.1, 0.0025, -3.3074999, -0.05526316, futures, 0), ('binance', True, 3, 2.1, 0.0025, -3.3074999, -0.16578947, futures, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.05473815, futures, 0), ('binance', False, 3, 1.9, 0.0025, -3.2925, -0.16421446, futures, 0), ('binance', True, 1, 1.9, 0.0025, 2.7075, 0.0452381, futures, 0), ('binance', True, 3, 1.9, 0.0025, 2.7075, 0.13571429, futures, 0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_profit(exchange, is_short, lev, close_rate, fee_close, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        arguments:\\n            fee:\\n                0.25% quote\\n                0.30% quote\\n            interest_rate: 0.05% per 4 hrs\\n            open_rate: 2.0 quote\\n            close_rate:\\n                1.9 quote\\n                2.1 quote\\n                2.2 quote\\n            amount: = 30.0 crypto\\n            stake_amount\\n                1x,-1x: 60.0  quote\\n                3x,-3x: 20.0  quote\\n            hours: 1/6 (10 minutes)\\n            funding_fees: 1\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2    = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n          0.0025 fee\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.85 quote\\n          0.003 fee: Is only applied to close rate in this test\\n        amount_closed:\\n            1x, 3x                         = amount\\n            -1x, -3x                       = amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03     = 30.03 crypto\\n        close_value:\\n            equations:\\n                1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n                -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            2.1 quote\\n                bin,krak  1x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025)                = 62.8425\\n                bin       3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.0008333333 = 62.8416666667\\n                krak      3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.040        = 62.8025\\n                bin  -1x,-3x: (30.000625 * 2.1) + (30.000625 * 2.1 * 0.0025)        = 63.15881578125\\n                krak -1x,-3x: (30.03 * 2.1) + (30.03 * 2.1 * 0.0025)                = 63.2206575\\n            1.9 quote\\n                bin,krak  1x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025)                = 56.8575\\n                bin       3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.0008333333 = 56.85666667\\n                krak      3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.040        = 56.8175\\n                bin  -1x,-3x: (30.000625 * 1.9) + (30.000625 * 1.9 * 0.0025)        = 57.14369046875\\n                krak -1x,-3x: (30.03 * 1.9) + (30.03 * 1.9 * 0.0025)                = 57.1996425\\n            2.2 quote\\n                bin,krak  1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)              = 65.835\\n                bin       3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n                krak      3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040      = 65.795\\n                bin  -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025)      = 66.1663784375\\n                krak -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)              = 66.231165\\n        total_profit:\\n            equations:\\n                1x, 3x : close_value - open_value\\n                -1x,-3x: open_value - close_value\\n            2.1 quote\\n                binance,kraken 1x: 62.8425     - 60.15          = 2.6925\\n                binance        3x: 62.84166667 - 60.15          = 2.69166667\\n                kraken         3x: 62.8025     - 60.15          = 2.6525\\n                binance   -1x,-3x: 59.850      - 63.15881578125 = -3.308815781249997\\n                kraken    -1x,-3x: 59.850      - 63.2206575     = -3.3706575\\n            1.9 quote\\n                binance,kraken 1x: 56.8575     - 60.15          = -3.2925\\n                binance        3x: 56.85666667 - 60.15          = -3.29333333\\n                kraken         3x: 56.8175     - 60.15          = -3.3325\\n                binance   -1x,-3x: 59.850      - 57.14369046875 = 2.7063095312499996\\n                kraken    -1x,-3x: 59.850      - 57.1996425     = 2.6503575\\n            2.2 quote\\n                binance,kraken 1x: 65.835      - 60.15          = 5.685\\n                binance        3x: 65.83416667 - 60.15          = 5.68416667\\n                kraken         3x: 65.795      - 60.15          = 5.645\\n                binance   -1x,-3x: 59.850      - 66.1663784375  = -6.316378437499999\\n                kraken    -1x,-3x: 59.850      - 66.231165      = -6.381165\\n        total_profit_ratio:\\n            equations:\\n                1x, 3x : ((close_value/open_value) - 1) * leverage\\n                -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            2.1 quote\\n                binance,kraken 1x: (62.8425 / 60.15) - 1             = 0.04476309226932673\\n                binance        3x: ((62.84166667 / 60.15) - 1)*3     = 0.13424771421446402\\n                kraken         3x: ((62.8025 / 60.15) - 1)*3         = 0.13229426433915248\\n                binance       -1x: 1 - (63.15881578125 / 59.850)     = -0.05528514254385963\\n                binance       -3x: (1 - (63.15881578125 / 59.850))*3 = -0.1658554276315789\\n                kraken        -1x: 1 - (63.2206575 / 59.850)         = -0.05631842105263152\\n                kraken        -3x: (1 - (63.2206575 / 59.850))*3     = -0.16895526315789455\\n            1.9 quote\\n                binance,kraken 1x: (56.8575 / 60.15) - 1             = -0.05473815461346632\\n                binance        3x: ((56.85666667 / 60.15) - 1)*3     = -0.16425602643391513\\n                kraken         3x: ((56.8175 / 60.15) - 1)*3         = -0.16620947630922667\\n                binance       -1x: 1 - (57.14369046875 / 59.850)     = 0.045218204365079395\\n                binance       -3x: (1 - (57.14369046875 / 59.850))*3 = 0.13565461309523819\\n                kraken        -1x: 1 - (57.1996425 / 59.850)         = 0.04428333333333334\\n                kraken        -3x: (1 - (57.1996425 / 59.850))*3     = 0.13285000000000002\\n            2.2 quote\\n                binance,kraken 1x: (65.835 / 60.15) - 1             = 0.0945137157107232\\n                binance        3x: ((65.83416667 / 60.15) - 1)*3     = 0.2834995845386534\\n                kraken         3x: ((65.795 / 60.15) - 1)*3         = 0.2815461346633419\\n                binance       -1x: 1 - (66.1663784375 / 59.850)     = -0.1055368159983292\\n                binance       -3x: (1 - (66.1663784375 / 59.850))*3 = -0.3166104479949876\\n                kraken        -1x: 1 - (66.231165 / 59.850)         = -0.106619298245614\\n                kraken        -3x: (1 - (66.231165 / 59.850))*3     = -0.319857894736842\\n        fee: 0.003, 1x\\n            close_value:\\n                2.1 quote: (30.00 * 2.1) - (30.00 * 2.1 * 0.003) = 62.811\\n                1.9 quote: (30.00 * 1.9) - (30.00 * 1.9 * 0.003) = 56.829\\n                2.2 quote: (30.00 * 2.2) - (30.00 * 2.2 * 0.003) = 65.802\\n            total_profit\\n                fee: 0.003, 1x\\n                    2.1 quote: 62.811 - 60.15 = 2.6610000000000014\\n                    1.9 quote: 56.829 - 60.15 = -3.320999999999998\\n                    2.2 quote: 65.802 - 60.15 = 5.652000000000008\\n            total_profit_ratio\\n                fee: 0.003, 1x\\n                    2.1 quote: (62.811 / 60.15) - 1 = 0.04423940149625927\\n                    1.9 quote: (56.829 / 60.15) - 1 = -0.05521197007481293\\n                    2.2 quote: (65.802 / 60.15) - 1 = 0.09396508728179565\\n        futures (live):\\n            funding_fee: 1\\n                close_value:\\n                    equations:\\n                        1x,3x: (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        -1x,-3x: (amount * close_rate) + (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + 1   = 63.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - 1   = 62.1575\\n                    1.9 quote\\n                        1x,3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + 1   = 57.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - 1   = 56.1425\\n                    2.2 quote:\\n                        1x,3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + 1 = 66.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - 1 = 65.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   63.8425     - 60.15          = 3.6925\\n                        -1x,-3x: 59.850      - 62.1575        = -2.3074999999999974\\n                    1.9 quote\\n                        1x,3x:   57.8575     - 60.15          = -2.2925\\n                        -1x,-3x: 59.850      - 56.1425        = 3.707500000000003\\n                    2.2 quote:\\n                        1x,3x:   66.835      - 60.15          = 6.685\\n                        -1x,-3x: 59.850      - 65.165         = -5.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (63.8425 / 60.15) - 1             = 0.06138819617622615\\n                        3x: ((63.8425 / 60.15) - 1)*3         = 0.18416458852867845\\n                        -1x: 1 - (62.1575 / 59.850)           = -0.038554720133667564\\n                        -3x: (1 - (62.1575 / 59.850))*3       = -0.11566416040100269\\n                    1.9 quote\\n                        1x: (57.8575 / 60.15) - 1             = -0.0381130507065669\\n                        3x: ((57.8575 / 60.15) - 1)*3         = -0.1143391521197007\\n                        -1x: 1 - (56.1425 / 59.850)           = 0.06194653299916464\\n                        -3x: (1 - (56.1425 / 59.850))*3       = 0.18583959899749392\\n                    2.2 quote\\n                        1x: (66.835 / 60.15) - 1             = 0.11113881961762262\\n                        3x: ((66.835 / 60.15) - 1)*3         = 0.33341645885286786\\n                        -1x: 1 - (65.165 / 59.850)           = -0.08880534670008355\\n                        -3x: (1 - (65.165 / 59.850))*3       = -0.26641604010025066\\n            funding_fee: -1\\n                close_value:\\n                    equations:\\n                        (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        (amount * close_rate) - (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x:  (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + (-1)   = 61.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - (-1)   = 64.1575\\n                    1.9 quote\\n                        1x,3x:  (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + (-1)   = 55.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - (-1)   = 58.1425\\n                    2.2 quote:\\n                        1x,3x:  (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + (-1) = 64.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - (-1) = 67.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   61.8425     - 60.15          = 1.6925000000000026\\n                        -1x,-3x: 59.850      - 64.1575        = -4.307499999999997\\n                    1.9 quote\\n                        1x,3x:   55.8575     - 60.15          = -4.292499999999997\\n                        -1x,-3x: 59.850      - 58.1425        = 1.7075000000000031\\n                    2.2 quote:\\n                        1x,3x:   64.835      - 60.15          = 4.684999999999995\\n                        -1x,-3x: 59.850      - 67.165         = -7.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (61.8425 / 60.15) - 1             = 0.028137988362427313\\n                        3x: ((61.8425 / 60.15) - 1)*3         = 0.08441396508728194\\n                        -1x: 1 - (64.1575 / 59.850)           = -0.07197159565580624\\n                        -3x: (1 - (64.1575 / 59.850))*3       = -0.21591478696741873\\n                    1.9 quote\\n                        1x: (55.8575 / 60.15) - 1             = -0.07136325852036574\\n                        3x: ((55.8575 / 60.15) - 1)*3         = -0.2140897755610972\\n                        -1x: 1 - (58.1425 / 59.850)           = 0.02852965747702596\\n                        -3x: (1 - (58.1425 / 59.850))*3       = 0.08558897243107788\\n                    2.2 quote\\n                        1x: (64.835 / 60.15) - 1              = 0.07788861180382378\\n                        3x: ((64.835 / 60.15) - 1)*3          = 0.23366583541147135\\n                        -1x: 1 - (67.165 / 59.850)            = -0.12222222222222223\\n                        -3x: (1 - (67.165 / 59.850))*3        = -0.3666666666666667\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, exchange=exchange, is_short=is_short, leverage=lev, fee_open=0.0025, fee_close=fee_close, max_stake_amount=60.0, trading_mode=trading_mode, funding_fees=funding_fees)\n    profit_res = trade.calculate_profit(close_rate)\n    assert pytest.approx(profit_res.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res.profit_ratio) == round(profit_ratio, 8)\n    val = trade.open_trade_value * profit_res.profit_ratio / lev\n    assert pytest.approx(val) == profit_res.profit_abs\n    assert pytest.approx(profit_res.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(rate=close_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(rate=close_rate)) == round(profit_ratio, 8)\n    profit_res2 = trade.calculate_profit(close_rate, trade.amount, trade.open_rate)\n    assert pytest.approx(profit_res2.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res2.profit_ratio) == round(profit_ratio, 8)\n    assert pytest.approx(profit_res2.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(close_rate, trade.amount, trade.open_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(close_rate, trade.amount, trade.open_rate)) == round(profit_ratio, 8)",
            "@pytest.mark.parametrize('exchange,is_short,lev,close_rate,fee_close,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('binance', False, 3, 2.1, 0.0025, 2.69166667, 0.134247714, margin, 0), ('binance', True, 1, 2.1, 0.0025, -3.3088157, -0.055285142, margin, 0), ('binance', True, 3, 2.1, 0.0025, -3.3088157, -0.16585542, margin, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('binance', False, 3, 1.9, 0.0025, -3.29333333, -0.164256026, margin, 0), ('binance', True, 1, 1.9, 0.0025, 2.70630953, 0.0452182043, margin, 0), ('binance', True, 3, 1.9, 0.0025, 2.70630953, 0.135654613, margin, 0), ('binance', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('binance', False, 3, 2.2, 0.0025, 5.68416667, 0.28349958, margin, 0), ('binance', True, 1, 2.2, 0.0025, -6.3163784, -0.10553681, margin, 0), ('binance', True, 3, 2.2, 0.0025, -6.3163784, -0.31661044, margin, 0), ('kraken', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('kraken', False, 3, 2.1, 0.0025, 2.6525, 0.132294264, margin, 0), ('kraken', True, 1, 2.1, 0.0025, -3.3706575, -0.056318421, margin, 0), ('kraken', True, 3, 2.1, 0.0025, -3.3706575, -0.168955263, margin, 0), ('kraken', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('kraken', False, 3, 1.9, 0.0025, -3.3325, -0.166209476, margin, 0), ('kraken', True, 1, 1.9, 0.0025, 2.6503575, 0.044283333, margin, 0), ('kraken', True, 3, 1.9, 0.0025, 2.6503575, 0.13285, margin, 0), ('kraken', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('kraken', False, 3, 2.2, 0.0025, 5.645, 0.28154613, margin, 0), ('kraken', True, 1, 2.2, 0.0025, -6.381165, -0.1066192, margin, 0), ('kraken', True, 3, 2.2, 0.0025, -6.381165, -0.3198578, margin, 0), ('binance', False, 1, 2.1, 0.003, 2.661, 0.044239401, spot, 0), ('binance', False, 1, 1.9, 0.003, -3.3209999, -0.05521197, spot, 0), ('binance', False, 1, 2.2, 0.003, 5.652, 0.093965087, spot, 0), ('binance', False, 1, 2.1, 0.0025, 3.6925, 0.06138819, futures, 1), ('binance', False, 3, 2.1, 0.0025, 3.6925, 0.18416458, futures, 1), ('binance', True, 1, 2.1, 0.0025, -2.3074999, -0.03855472, futures, 1), ('binance', True, 3, 2.1, 0.0025, -2.3074999, -0.11566416, futures, 1), ('binance', False, 1, 1.9, 0.0025, -2.2925, -0.03811305, futures, 1), ('binance', False, 3, 1.9, 0.0025, -2.2925, -0.11433915, futures, 1), ('binance', True, 1, 1.9, 0.0025, 3.7075, 0.06194653, futures, 1), ('binance', True, 3, 1.9, 0.0025, 3.7075, 0.18583959, futures, 1), ('binance', False, 1, 2.2, 0.0025, 6.685, 0.11113881, futures, 1), ('binance', False, 3, 2.2, 0.0025, 6.685, 0.33341645, futures, 1), ('binance', True, 1, 2.2, 0.0025, -5.315, -0.08880534, futures, 1), ('binance', True, 3, 2.2, 0.0025, -5.315, -0.26641604, futures, 1), ('binance', False, 1, 2.1, 0.0025, 1.6925, 0.02813798, futures, -1), ('binance', False, 3, 2.1, 0.0025, 1.6925, 0.08441396, futures, -1), ('binance', True, 1, 2.1, 0.0025, -4.307499, -0.07197159, futures, -1), ('binance', True, 3, 2.1, 0.0025, -4.307499, -0.21591478, futures, -1), ('binance', False, 1, 1.9, 0.0025, -4.292499, -0.07136325, futures, -1), ('binance', False, 3, 1.9, 0.0025, -4.292499, -0.21408977, futures, -1), ('binance', True, 1, 1.9, 0.0025, 1.7075, 0.02852965, futures, -1), ('binance', True, 3, 1.9, 0.0025, 1.7075, 0.08558897, futures, -1), ('binance', False, 1, 2.2, 0.0025, 4.684999, 0.07788861, futures, -1), ('binance', False, 3, 2.2, 0.0025, 4.684999, 0.23366583, futures, -1), ('binance', True, 1, 2.2, 0.0025, -7.315, -0.12222222, futures, -1), ('binance', True, 3, 2.2, 0.0025, -7.315, -0.36666666, futures, -1), ('binance', False, 1, 2.1, 0.0025, 2.6925, 0.04476309, futures, 0), ('binance', False, 3, 2.1, 0.0025, 2.6925, 0.13428928, futures, 0), ('binance', True, 1, 2.1, 0.0025, -3.3074999, -0.05526316, futures, 0), ('binance', True, 3, 2.1, 0.0025, -3.3074999, -0.16578947, futures, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.05473815, futures, 0), ('binance', False, 3, 1.9, 0.0025, -3.2925, -0.16421446, futures, 0), ('binance', True, 1, 1.9, 0.0025, 2.7075, 0.0452381, futures, 0), ('binance', True, 3, 1.9, 0.0025, 2.7075, 0.13571429, futures, 0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_profit(exchange, is_short, lev, close_rate, fee_close, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        arguments:\\n            fee:\\n                0.25% quote\\n                0.30% quote\\n            interest_rate: 0.05% per 4 hrs\\n            open_rate: 2.0 quote\\n            close_rate:\\n                1.9 quote\\n                2.1 quote\\n                2.2 quote\\n            amount: = 30.0 crypto\\n            stake_amount\\n                1x,-1x: 60.0  quote\\n                3x,-3x: 20.0  quote\\n            hours: 1/6 (10 minutes)\\n            funding_fees: 1\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2    = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n          0.0025 fee\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.85 quote\\n          0.003 fee: Is only applied to close rate in this test\\n        amount_closed:\\n            1x, 3x                         = amount\\n            -1x, -3x                       = amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03     = 30.03 crypto\\n        close_value:\\n            equations:\\n                1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n                -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            2.1 quote\\n                bin,krak  1x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025)                = 62.8425\\n                bin       3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.0008333333 = 62.8416666667\\n                krak      3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.040        = 62.8025\\n                bin  -1x,-3x: (30.000625 * 2.1) + (30.000625 * 2.1 * 0.0025)        = 63.15881578125\\n                krak -1x,-3x: (30.03 * 2.1) + (30.03 * 2.1 * 0.0025)                = 63.2206575\\n            1.9 quote\\n                bin,krak  1x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025)                = 56.8575\\n                bin       3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.0008333333 = 56.85666667\\n                krak      3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.040        = 56.8175\\n                bin  -1x,-3x: (30.000625 * 1.9) + (30.000625 * 1.9 * 0.0025)        = 57.14369046875\\n                krak -1x,-3x: (30.03 * 1.9) + (30.03 * 1.9 * 0.0025)                = 57.1996425\\n            2.2 quote\\n                bin,krak  1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)              = 65.835\\n                bin       3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n                krak      3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040      = 65.795\\n                bin  -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025)      = 66.1663784375\\n                krak -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)              = 66.231165\\n        total_profit:\\n            equations:\\n                1x, 3x : close_value - open_value\\n                -1x,-3x: open_value - close_value\\n            2.1 quote\\n                binance,kraken 1x: 62.8425     - 60.15          = 2.6925\\n                binance        3x: 62.84166667 - 60.15          = 2.69166667\\n                kraken         3x: 62.8025     - 60.15          = 2.6525\\n                binance   -1x,-3x: 59.850      - 63.15881578125 = -3.308815781249997\\n                kraken    -1x,-3x: 59.850      - 63.2206575     = -3.3706575\\n            1.9 quote\\n                binance,kraken 1x: 56.8575     - 60.15          = -3.2925\\n                binance        3x: 56.85666667 - 60.15          = -3.29333333\\n                kraken         3x: 56.8175     - 60.15          = -3.3325\\n                binance   -1x,-3x: 59.850      - 57.14369046875 = 2.7063095312499996\\n                kraken    -1x,-3x: 59.850      - 57.1996425     = 2.6503575\\n            2.2 quote\\n                binance,kraken 1x: 65.835      - 60.15          = 5.685\\n                binance        3x: 65.83416667 - 60.15          = 5.68416667\\n                kraken         3x: 65.795      - 60.15          = 5.645\\n                binance   -1x,-3x: 59.850      - 66.1663784375  = -6.316378437499999\\n                kraken    -1x,-3x: 59.850      - 66.231165      = -6.381165\\n        total_profit_ratio:\\n            equations:\\n                1x, 3x : ((close_value/open_value) - 1) * leverage\\n                -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            2.1 quote\\n                binance,kraken 1x: (62.8425 / 60.15) - 1             = 0.04476309226932673\\n                binance        3x: ((62.84166667 / 60.15) - 1)*3     = 0.13424771421446402\\n                kraken         3x: ((62.8025 / 60.15) - 1)*3         = 0.13229426433915248\\n                binance       -1x: 1 - (63.15881578125 / 59.850)     = -0.05528514254385963\\n                binance       -3x: (1 - (63.15881578125 / 59.850))*3 = -0.1658554276315789\\n                kraken        -1x: 1 - (63.2206575 / 59.850)         = -0.05631842105263152\\n                kraken        -3x: (1 - (63.2206575 / 59.850))*3     = -0.16895526315789455\\n            1.9 quote\\n                binance,kraken 1x: (56.8575 / 60.15) - 1             = -0.05473815461346632\\n                binance        3x: ((56.85666667 / 60.15) - 1)*3     = -0.16425602643391513\\n                kraken         3x: ((56.8175 / 60.15) - 1)*3         = -0.16620947630922667\\n                binance       -1x: 1 - (57.14369046875 / 59.850)     = 0.045218204365079395\\n                binance       -3x: (1 - (57.14369046875 / 59.850))*3 = 0.13565461309523819\\n                kraken        -1x: 1 - (57.1996425 / 59.850)         = 0.04428333333333334\\n                kraken        -3x: (1 - (57.1996425 / 59.850))*3     = 0.13285000000000002\\n            2.2 quote\\n                binance,kraken 1x: (65.835 / 60.15) - 1             = 0.0945137157107232\\n                binance        3x: ((65.83416667 / 60.15) - 1)*3     = 0.2834995845386534\\n                kraken         3x: ((65.795 / 60.15) - 1)*3         = 0.2815461346633419\\n                binance       -1x: 1 - (66.1663784375 / 59.850)     = -0.1055368159983292\\n                binance       -3x: (1 - (66.1663784375 / 59.850))*3 = -0.3166104479949876\\n                kraken        -1x: 1 - (66.231165 / 59.850)         = -0.106619298245614\\n                kraken        -3x: (1 - (66.231165 / 59.850))*3     = -0.319857894736842\\n        fee: 0.003, 1x\\n            close_value:\\n                2.1 quote: (30.00 * 2.1) - (30.00 * 2.1 * 0.003) = 62.811\\n                1.9 quote: (30.00 * 1.9) - (30.00 * 1.9 * 0.003) = 56.829\\n                2.2 quote: (30.00 * 2.2) - (30.00 * 2.2 * 0.003) = 65.802\\n            total_profit\\n                fee: 0.003, 1x\\n                    2.1 quote: 62.811 - 60.15 = 2.6610000000000014\\n                    1.9 quote: 56.829 - 60.15 = -3.320999999999998\\n                    2.2 quote: 65.802 - 60.15 = 5.652000000000008\\n            total_profit_ratio\\n                fee: 0.003, 1x\\n                    2.1 quote: (62.811 / 60.15) - 1 = 0.04423940149625927\\n                    1.9 quote: (56.829 / 60.15) - 1 = -0.05521197007481293\\n                    2.2 quote: (65.802 / 60.15) - 1 = 0.09396508728179565\\n        futures (live):\\n            funding_fee: 1\\n                close_value:\\n                    equations:\\n                        1x,3x: (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        -1x,-3x: (amount * close_rate) + (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + 1   = 63.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - 1   = 62.1575\\n                    1.9 quote\\n                        1x,3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + 1   = 57.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - 1   = 56.1425\\n                    2.2 quote:\\n                        1x,3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + 1 = 66.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - 1 = 65.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   63.8425     - 60.15          = 3.6925\\n                        -1x,-3x: 59.850      - 62.1575        = -2.3074999999999974\\n                    1.9 quote\\n                        1x,3x:   57.8575     - 60.15          = -2.2925\\n                        -1x,-3x: 59.850      - 56.1425        = 3.707500000000003\\n                    2.2 quote:\\n                        1x,3x:   66.835      - 60.15          = 6.685\\n                        -1x,-3x: 59.850      - 65.165         = -5.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (63.8425 / 60.15) - 1             = 0.06138819617622615\\n                        3x: ((63.8425 / 60.15) - 1)*3         = 0.18416458852867845\\n                        -1x: 1 - (62.1575 / 59.850)           = -0.038554720133667564\\n                        -3x: (1 - (62.1575 / 59.850))*3       = -0.11566416040100269\\n                    1.9 quote\\n                        1x: (57.8575 / 60.15) - 1             = -0.0381130507065669\\n                        3x: ((57.8575 / 60.15) - 1)*3         = -0.1143391521197007\\n                        -1x: 1 - (56.1425 / 59.850)           = 0.06194653299916464\\n                        -3x: (1 - (56.1425 / 59.850))*3       = 0.18583959899749392\\n                    2.2 quote\\n                        1x: (66.835 / 60.15) - 1             = 0.11113881961762262\\n                        3x: ((66.835 / 60.15) - 1)*3         = 0.33341645885286786\\n                        -1x: 1 - (65.165 / 59.850)           = -0.08880534670008355\\n                        -3x: (1 - (65.165 / 59.850))*3       = -0.26641604010025066\\n            funding_fee: -1\\n                close_value:\\n                    equations:\\n                        (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        (amount * close_rate) - (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x:  (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + (-1)   = 61.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - (-1)   = 64.1575\\n                    1.9 quote\\n                        1x,3x:  (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + (-1)   = 55.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - (-1)   = 58.1425\\n                    2.2 quote:\\n                        1x,3x:  (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + (-1) = 64.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - (-1) = 67.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   61.8425     - 60.15          = 1.6925000000000026\\n                        -1x,-3x: 59.850      - 64.1575        = -4.307499999999997\\n                    1.9 quote\\n                        1x,3x:   55.8575     - 60.15          = -4.292499999999997\\n                        -1x,-3x: 59.850      - 58.1425        = 1.7075000000000031\\n                    2.2 quote:\\n                        1x,3x:   64.835      - 60.15          = 4.684999999999995\\n                        -1x,-3x: 59.850      - 67.165         = -7.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (61.8425 / 60.15) - 1             = 0.028137988362427313\\n                        3x: ((61.8425 / 60.15) - 1)*3         = 0.08441396508728194\\n                        -1x: 1 - (64.1575 / 59.850)           = -0.07197159565580624\\n                        -3x: (1 - (64.1575 / 59.850))*3       = -0.21591478696741873\\n                    1.9 quote\\n                        1x: (55.8575 / 60.15) - 1             = -0.07136325852036574\\n                        3x: ((55.8575 / 60.15) - 1)*3         = -0.2140897755610972\\n                        -1x: 1 - (58.1425 / 59.850)           = 0.02852965747702596\\n                        -3x: (1 - (58.1425 / 59.850))*3       = 0.08558897243107788\\n                    2.2 quote\\n                        1x: (64.835 / 60.15) - 1              = 0.07788861180382378\\n                        3x: ((64.835 / 60.15) - 1)*3          = 0.23366583541147135\\n                        -1x: 1 - (67.165 / 59.850)            = -0.12222222222222223\\n                        -3x: (1 - (67.165 / 59.850))*3        = -0.3666666666666667\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, exchange=exchange, is_short=is_short, leverage=lev, fee_open=0.0025, fee_close=fee_close, max_stake_amount=60.0, trading_mode=trading_mode, funding_fees=funding_fees)\n    profit_res = trade.calculate_profit(close_rate)\n    assert pytest.approx(profit_res.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res.profit_ratio) == round(profit_ratio, 8)\n    val = trade.open_trade_value * profit_res.profit_ratio / lev\n    assert pytest.approx(val) == profit_res.profit_abs\n    assert pytest.approx(profit_res.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(rate=close_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(rate=close_rate)) == round(profit_ratio, 8)\n    profit_res2 = trade.calculate_profit(close_rate, trade.amount, trade.open_rate)\n    assert pytest.approx(profit_res2.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res2.profit_ratio) == round(profit_ratio, 8)\n    assert pytest.approx(profit_res2.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(close_rate, trade.amount, trade.open_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(close_rate, trade.amount, trade.open_rate)) == round(profit_ratio, 8)",
            "@pytest.mark.parametrize('exchange,is_short,lev,close_rate,fee_close,profit,profit_ratio,trading_mode,funding_fees', [('binance', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('binance', False, 3, 2.1, 0.0025, 2.69166667, 0.134247714, margin, 0), ('binance', True, 1, 2.1, 0.0025, -3.3088157, -0.055285142, margin, 0), ('binance', True, 3, 2.1, 0.0025, -3.3088157, -0.16585542, margin, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('binance', False, 3, 1.9, 0.0025, -3.29333333, -0.164256026, margin, 0), ('binance', True, 1, 1.9, 0.0025, 2.70630953, 0.0452182043, margin, 0), ('binance', True, 3, 1.9, 0.0025, 2.70630953, 0.135654613, margin, 0), ('binance', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('binance', False, 3, 2.2, 0.0025, 5.68416667, 0.28349958, margin, 0), ('binance', True, 1, 2.2, 0.0025, -6.3163784, -0.10553681, margin, 0), ('binance', True, 3, 2.2, 0.0025, -6.3163784, -0.31661044, margin, 0), ('kraken', False, 1, 2.1, 0.0025, 2.6925, 0.044763092, spot, 0), ('kraken', False, 3, 2.1, 0.0025, 2.6525, 0.132294264, margin, 0), ('kraken', True, 1, 2.1, 0.0025, -3.3706575, -0.056318421, margin, 0), ('kraken', True, 3, 2.1, 0.0025, -3.3706575, -0.168955263, margin, 0), ('kraken', False, 1, 1.9, 0.0025, -3.2925, -0.054738154, margin, 0), ('kraken', False, 3, 1.9, 0.0025, -3.3325, -0.166209476, margin, 0), ('kraken', True, 1, 1.9, 0.0025, 2.6503575, 0.044283333, margin, 0), ('kraken', True, 3, 1.9, 0.0025, 2.6503575, 0.13285, margin, 0), ('kraken', False, 1, 2.2, 0.0025, 5.685, 0.09451371, margin, 0), ('kraken', False, 3, 2.2, 0.0025, 5.645, 0.28154613, margin, 0), ('kraken', True, 1, 2.2, 0.0025, -6.381165, -0.1066192, margin, 0), ('kraken', True, 3, 2.2, 0.0025, -6.381165, -0.3198578, margin, 0), ('binance', False, 1, 2.1, 0.003, 2.661, 0.044239401, spot, 0), ('binance', False, 1, 1.9, 0.003, -3.3209999, -0.05521197, spot, 0), ('binance', False, 1, 2.2, 0.003, 5.652, 0.093965087, spot, 0), ('binance', False, 1, 2.1, 0.0025, 3.6925, 0.06138819, futures, 1), ('binance', False, 3, 2.1, 0.0025, 3.6925, 0.18416458, futures, 1), ('binance', True, 1, 2.1, 0.0025, -2.3074999, -0.03855472, futures, 1), ('binance', True, 3, 2.1, 0.0025, -2.3074999, -0.11566416, futures, 1), ('binance', False, 1, 1.9, 0.0025, -2.2925, -0.03811305, futures, 1), ('binance', False, 3, 1.9, 0.0025, -2.2925, -0.11433915, futures, 1), ('binance', True, 1, 1.9, 0.0025, 3.7075, 0.06194653, futures, 1), ('binance', True, 3, 1.9, 0.0025, 3.7075, 0.18583959, futures, 1), ('binance', False, 1, 2.2, 0.0025, 6.685, 0.11113881, futures, 1), ('binance', False, 3, 2.2, 0.0025, 6.685, 0.33341645, futures, 1), ('binance', True, 1, 2.2, 0.0025, -5.315, -0.08880534, futures, 1), ('binance', True, 3, 2.2, 0.0025, -5.315, -0.26641604, futures, 1), ('binance', False, 1, 2.1, 0.0025, 1.6925, 0.02813798, futures, -1), ('binance', False, 3, 2.1, 0.0025, 1.6925, 0.08441396, futures, -1), ('binance', True, 1, 2.1, 0.0025, -4.307499, -0.07197159, futures, -1), ('binance', True, 3, 2.1, 0.0025, -4.307499, -0.21591478, futures, -1), ('binance', False, 1, 1.9, 0.0025, -4.292499, -0.07136325, futures, -1), ('binance', False, 3, 1.9, 0.0025, -4.292499, -0.21408977, futures, -1), ('binance', True, 1, 1.9, 0.0025, 1.7075, 0.02852965, futures, -1), ('binance', True, 3, 1.9, 0.0025, 1.7075, 0.08558897, futures, -1), ('binance', False, 1, 2.2, 0.0025, 4.684999, 0.07788861, futures, -1), ('binance', False, 3, 2.2, 0.0025, 4.684999, 0.23366583, futures, -1), ('binance', True, 1, 2.2, 0.0025, -7.315, -0.12222222, futures, -1), ('binance', True, 3, 2.2, 0.0025, -7.315, -0.36666666, futures, -1), ('binance', False, 1, 2.1, 0.0025, 2.6925, 0.04476309, futures, 0), ('binance', False, 3, 2.1, 0.0025, 2.6925, 0.13428928, futures, 0), ('binance', True, 1, 2.1, 0.0025, -3.3074999, -0.05526316, futures, 0), ('binance', True, 3, 2.1, 0.0025, -3.3074999, -0.16578947, futures, 0), ('binance', False, 1, 1.9, 0.0025, -3.2925, -0.05473815, futures, 0), ('binance', False, 3, 1.9, 0.0025, -3.2925, -0.16421446, futures, 0), ('binance', True, 1, 1.9, 0.0025, 2.7075, 0.0452381, futures, 0), ('binance', True, 3, 1.9, 0.0025, 2.7075, 0.13571429, futures, 0)])\n@pytest.mark.usefixtures('init_persistence')\ndef test_calc_profit(exchange, is_short, lev, close_rate, fee_close, profit, profit_ratio, trading_mode, funding_fees):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    '\\n        10 minute limit trade on Binance/Kraken at 1x, 3x leverage\\n        arguments:\\n            fee:\\n                0.25% quote\\n                0.30% quote\\n            interest_rate: 0.05% per 4 hrs\\n            open_rate: 2.0 quote\\n            close_rate:\\n                1.9 quote\\n                2.1 quote\\n                2.2 quote\\n            amount: = 30.0 crypto\\n            stake_amount\\n                1x,-1x: 60.0  quote\\n                3x,-3x: 20.0  quote\\n            hours: 1/6 (10 minutes)\\n            funding_fees: 1\\n        borrowed\\n             1x:  0 quote\\n             3x: 40 quote\\n            -1x: 30 crypto\\n            -3x: 30 crypto\\n        time-periods:\\n            kraken: (1 + 1) 4hr_periods = 2 4hr_periods\\n            binance: 1/24 24hr_periods\\n        interest: borrowed * interest_rate * time-periods\\n            1x            :  /\\n            binance     3x: 40 * 0.0005 * 1/24 = 0.0008333333333333334 quote\\n            kraken      3x: 40 * 0.0005 * 2    = 0.040 quote\\n            binace -1x,-3x: 30 * 0.0005 * 1/24 = 0.000625 crypto\\n            kraken -1x,-3x: 30 * 0.0005 * 2    = 0.030 crypto\\n        open_value: (amount * open_rate) \u00b1 (amount * open_rate * fee)\\n          0.0025 fee\\n             1x, 3x: 30 * 2 + 30 * 2 * 0.0025 = 60.15 quote\\n            -1x,-3x: 30 * 2 - 30 * 2 * 0.0025 = 59.85 quote\\n          0.003 fee: Is only applied to close rate in this test\\n        amount_closed:\\n            1x, 3x                         = amount\\n            -1x, -3x                       = amount + interest\\n            binance -1x,-3x: 30 + 0.000625 = 30.000625 crypto\\n            kraken  -1x,-3x: 30 + 0.03     = 30.03 crypto\\n        close_value:\\n            equations:\\n                1x, 3x: (amount_closed * close_rate) - (amount_closed * close_rate * fee) - interest\\n                -1x,-3x: (amount_closed * close_rate) + (amount_closed * close_rate * fee)\\n            2.1 quote\\n                bin,krak  1x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025)                = 62.8425\\n                bin       3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.0008333333 = 62.8416666667\\n                krak      3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) - 0.040        = 62.8025\\n                bin  -1x,-3x: (30.000625 * 2.1) + (30.000625 * 2.1 * 0.0025)        = 63.15881578125\\n                krak -1x,-3x: (30.03 * 2.1) + (30.03 * 2.1 * 0.0025)                = 63.2206575\\n            1.9 quote\\n                bin,krak  1x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025)                = 56.8575\\n                bin       3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.0008333333 = 56.85666667\\n                krak      3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) - 0.040        = 56.8175\\n                bin  -1x,-3x: (30.000625 * 1.9) + (30.000625 * 1.9 * 0.0025)        = 57.14369046875\\n                krak -1x,-3x: (30.03 * 1.9) + (30.03 * 1.9 * 0.0025)                = 57.1996425\\n            2.2 quote\\n                bin,krak  1x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025)              = 65.835\\n                bin       3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.00083333 = 65.83416667\\n                krak      3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) - 0.040      = 65.795\\n                bin  -1x,-3x: (30.000625 * 2.20) + (30.000625 * 2.20 * 0.0025)      = 66.1663784375\\n                krak -1x,-3x: (30.03 * 2.20) + (30.03 * 2.20 * 0.0025)              = 66.231165\\n        total_profit:\\n            equations:\\n                1x, 3x : close_value - open_value\\n                -1x,-3x: open_value - close_value\\n            2.1 quote\\n                binance,kraken 1x: 62.8425     - 60.15          = 2.6925\\n                binance        3x: 62.84166667 - 60.15          = 2.69166667\\n                kraken         3x: 62.8025     - 60.15          = 2.6525\\n                binance   -1x,-3x: 59.850      - 63.15881578125 = -3.308815781249997\\n                kraken    -1x,-3x: 59.850      - 63.2206575     = -3.3706575\\n            1.9 quote\\n                binance,kraken 1x: 56.8575     - 60.15          = -3.2925\\n                binance        3x: 56.85666667 - 60.15          = -3.29333333\\n                kraken         3x: 56.8175     - 60.15          = -3.3325\\n                binance   -1x,-3x: 59.850      - 57.14369046875 = 2.7063095312499996\\n                kraken    -1x,-3x: 59.850      - 57.1996425     = 2.6503575\\n            2.2 quote\\n                binance,kraken 1x: 65.835      - 60.15          = 5.685\\n                binance        3x: 65.83416667 - 60.15          = 5.68416667\\n                kraken         3x: 65.795      - 60.15          = 5.645\\n                binance   -1x,-3x: 59.850      - 66.1663784375  = -6.316378437499999\\n                kraken    -1x,-3x: 59.850      - 66.231165      = -6.381165\\n        total_profit_ratio:\\n            equations:\\n                1x, 3x : ((close_value/open_value) - 1) * leverage\\n                -1x,-3x: (1 - (close_value/open_value)) * leverage\\n            2.1 quote\\n                binance,kraken 1x: (62.8425 / 60.15) - 1             = 0.04476309226932673\\n                binance        3x: ((62.84166667 / 60.15) - 1)*3     = 0.13424771421446402\\n                kraken         3x: ((62.8025 / 60.15) - 1)*3         = 0.13229426433915248\\n                binance       -1x: 1 - (63.15881578125 / 59.850)     = -0.05528514254385963\\n                binance       -3x: (1 - (63.15881578125 / 59.850))*3 = -0.1658554276315789\\n                kraken        -1x: 1 - (63.2206575 / 59.850)         = -0.05631842105263152\\n                kraken        -3x: (1 - (63.2206575 / 59.850))*3     = -0.16895526315789455\\n            1.9 quote\\n                binance,kraken 1x: (56.8575 / 60.15) - 1             = -0.05473815461346632\\n                binance        3x: ((56.85666667 / 60.15) - 1)*3     = -0.16425602643391513\\n                kraken         3x: ((56.8175 / 60.15) - 1)*3         = -0.16620947630922667\\n                binance       -1x: 1 - (57.14369046875 / 59.850)     = 0.045218204365079395\\n                binance       -3x: (1 - (57.14369046875 / 59.850))*3 = 0.13565461309523819\\n                kraken        -1x: 1 - (57.1996425 / 59.850)         = 0.04428333333333334\\n                kraken        -3x: (1 - (57.1996425 / 59.850))*3     = 0.13285000000000002\\n            2.2 quote\\n                binance,kraken 1x: (65.835 / 60.15) - 1             = 0.0945137157107232\\n                binance        3x: ((65.83416667 / 60.15) - 1)*3     = 0.2834995845386534\\n                kraken         3x: ((65.795 / 60.15) - 1)*3         = 0.2815461346633419\\n                binance       -1x: 1 - (66.1663784375 / 59.850)     = -0.1055368159983292\\n                binance       -3x: (1 - (66.1663784375 / 59.850))*3 = -0.3166104479949876\\n                kraken        -1x: 1 - (66.231165 / 59.850)         = -0.106619298245614\\n                kraken        -3x: (1 - (66.231165 / 59.850))*3     = -0.319857894736842\\n        fee: 0.003, 1x\\n            close_value:\\n                2.1 quote: (30.00 * 2.1) - (30.00 * 2.1 * 0.003) = 62.811\\n                1.9 quote: (30.00 * 1.9) - (30.00 * 1.9 * 0.003) = 56.829\\n                2.2 quote: (30.00 * 2.2) - (30.00 * 2.2 * 0.003) = 65.802\\n            total_profit\\n                fee: 0.003, 1x\\n                    2.1 quote: 62.811 - 60.15 = 2.6610000000000014\\n                    1.9 quote: 56.829 - 60.15 = -3.320999999999998\\n                    2.2 quote: 65.802 - 60.15 = 5.652000000000008\\n            total_profit_ratio\\n                fee: 0.003, 1x\\n                    2.1 quote: (62.811 / 60.15) - 1 = 0.04423940149625927\\n                    1.9 quote: (56.829 / 60.15) - 1 = -0.05521197007481293\\n                    2.2 quote: (65.802 / 60.15) - 1 = 0.09396508728179565\\n        futures (live):\\n            funding_fee: 1\\n                close_value:\\n                    equations:\\n                        1x,3x: (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        -1x,-3x: (amount * close_rate) + (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x: (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + 1   = 63.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - 1   = 62.1575\\n                    1.9 quote\\n                        1x,3x: (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + 1   = 57.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - 1   = 56.1425\\n                    2.2 quote:\\n                        1x,3x: (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + 1 = 66.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - 1 = 65.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   63.8425     - 60.15          = 3.6925\\n                        -1x,-3x: 59.850      - 62.1575        = -2.3074999999999974\\n                    1.9 quote\\n                        1x,3x:   57.8575     - 60.15          = -2.2925\\n                        -1x,-3x: 59.850      - 56.1425        = 3.707500000000003\\n                    2.2 quote:\\n                        1x,3x:   66.835      - 60.15          = 6.685\\n                        -1x,-3x: 59.850      - 65.165         = -5.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (63.8425 / 60.15) - 1             = 0.06138819617622615\\n                        3x: ((63.8425 / 60.15) - 1)*3         = 0.18416458852867845\\n                        -1x: 1 - (62.1575 / 59.850)           = -0.038554720133667564\\n                        -3x: (1 - (62.1575 / 59.850))*3       = -0.11566416040100269\\n                    1.9 quote\\n                        1x: (57.8575 / 60.15) - 1             = -0.0381130507065669\\n                        3x: ((57.8575 / 60.15) - 1)*3         = -0.1143391521197007\\n                        -1x: 1 - (56.1425 / 59.850)           = 0.06194653299916464\\n                        -3x: (1 - (56.1425 / 59.850))*3       = 0.18583959899749392\\n                    2.2 quote\\n                        1x: (66.835 / 60.15) - 1             = 0.11113881961762262\\n                        3x: ((66.835 / 60.15) - 1)*3         = 0.33341645885286786\\n                        -1x: 1 - (65.165 / 59.850)           = -0.08880534670008355\\n                        -3x: (1 - (65.165 / 59.850))*3       = -0.26641604010025066\\n            funding_fee: -1\\n                close_value:\\n                    equations:\\n                        (amount * close_rate) - (amount * close_rate * fee) + funding_fees\\n                        (amount * close_rate) - (amount * close_rate * fee) - funding_fees\\n                    2.1 quote\\n                        1x,3x:  (30.00 * 2.1) - (30.00 * 2.1 * 0.0025) + (-1)   = 61.8425\\n                        -1x,-3x: (30.00 * 2.1) + (30.00 * 2.1 * 0.0025) - (-1)   = 64.1575\\n                    1.9 quote\\n                        1x,3x:  (30.00 * 1.9) - (30.00 * 1.9 * 0.0025) + (-1)   = 55.8575\\n                        -1x,-3x: (30.00 * 1.9) + (30.00 * 1.9 * 0.0025) - (-1)   = 58.1425\\n                    2.2 quote:\\n                        1x,3x:  (30.00 * 2.20) - (30.00 * 2.20 * 0.0025) + (-1) = 64.835\\n                        -1x,-3x: (30.00 * 2.20) + (30.00 * 2.20 * 0.0025) - (-1) = 67.165\\n                total_profit:\\n                    2.1 quote\\n                        1x,3x:   61.8425     - 60.15          = 1.6925000000000026\\n                        -1x,-3x: 59.850      - 64.1575        = -4.307499999999997\\n                    1.9 quote\\n                        1x,3x:   55.8575     - 60.15          = -4.292499999999997\\n                        -1x,-3x: 59.850      - 58.1425        = 1.7075000000000031\\n                    2.2 quote:\\n                        1x,3x:   64.835      - 60.15          = 4.684999999999995\\n                        -1x,-3x: 59.850      - 67.165         = -7.315000000000005\\n                total_profit_ratio:\\n                    2.1 quote\\n                        1x: (61.8425 / 60.15) - 1             = 0.028137988362427313\\n                        3x: ((61.8425 / 60.15) - 1)*3         = 0.08441396508728194\\n                        -1x: 1 - (64.1575 / 59.850)           = -0.07197159565580624\\n                        -3x: (1 - (64.1575 / 59.850))*3       = -0.21591478696741873\\n                    1.9 quote\\n                        1x: (55.8575 / 60.15) - 1             = -0.07136325852036574\\n                        3x: ((55.8575 / 60.15) - 1)*3         = -0.2140897755610972\\n                        -1x: 1 - (58.1425 / 59.850)           = 0.02852965747702596\\n                        -3x: (1 - (58.1425 / 59.850))*3       = 0.08558897243107788\\n                    2.2 quote\\n                        1x: (64.835 / 60.15) - 1              = 0.07788861180382378\\n                        3x: ((64.835 / 60.15) - 1)*3          = 0.23366583541147135\\n                        -1x: 1 - (67.165 / 59.850)            = -0.12222222222222223\\n                        -3x: (1 - (67.165 / 59.850))*3        = -0.3666666666666667\\n    '\n    trade = Trade(pair='ADA/USDT', stake_amount=60.0, amount=30.0, open_rate=2.0, open_date=datetime.now(tz=timezone.utc) - timedelta(minutes=10), interest_rate=0.0005, exchange=exchange, is_short=is_short, leverage=lev, fee_open=0.0025, fee_close=fee_close, max_stake_amount=60.0, trading_mode=trading_mode, funding_fees=funding_fees)\n    profit_res = trade.calculate_profit(close_rate)\n    assert pytest.approx(profit_res.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res.profit_ratio) == round(profit_ratio, 8)\n    val = trade.open_trade_value * profit_res.profit_ratio / lev\n    assert pytest.approx(val) == profit_res.profit_abs\n    assert pytest.approx(profit_res.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(rate=close_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(rate=close_rate)) == round(profit_ratio, 8)\n    profit_res2 = trade.calculate_profit(close_rate, trade.amount, trade.open_rate)\n    assert pytest.approx(profit_res2.profit_abs) == round(profit, 8)\n    assert pytest.approx(profit_res2.profit_ratio) == round(profit_ratio, 8)\n    assert pytest.approx(profit_res2.total_profit) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit(close_rate, trade.amount, trade.open_rate)) == round(profit, 8)\n    assert pytest.approx(trade.calc_profit_ratio(close_rate, trade.amount, trade.open_rate)) == round(profit_ratio, 8)"
        ]
    },
    {
        "func_name": "test_adjust_stop_loss",
        "original": "def test_adjust_stop_loss(fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.96, 0.05)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.3, -0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.2, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.4, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.7, 0.1, True)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1",
        "mutated": [
            "def test_adjust_stop_loss(fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.96, 0.05)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.3, -0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.2, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.4, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.7, 0.1, True)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1",
            "def test_adjust_stop_loss(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.96, 0.05)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.3, -0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.2, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.4, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.7, 0.1, True)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1",
            "def test_adjust_stop_loss(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.96, 0.05)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.3, -0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.2, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.4, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.7, 0.1, True)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1",
            "def test_adjust_stop_loss(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.96, 0.05)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.3, -0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.2, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.4, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.7, 0.1, True)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1",
            "def test_adjust_stop_loss(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.96, 0.05)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.3, -0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.2, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.17\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.4, 0.1)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.7, 0.1, True)\n    assert pytest.approx(trade.stop_loss) == 1.26\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1"
        ]
    },
    {
        "func_name": "test_adjust_stop_loss_short",
        "original": "def test_adjust_stop_loss_short(fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=5, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.04, 0.05)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.7, 0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.8, -0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.6, -0.1)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.3, -0.1, True)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1\n    trade.set_liquidation_price(0.63)\n    trade.adjust_stop_loss(0.59, -0.1)\n    assert trade.stop_loss == 0.649\n    assert trade.liquidation_price == 0.63",
        "mutated": [
            "def test_adjust_stop_loss_short(fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=5, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.04, 0.05)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.7, 0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.8, -0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.6, -0.1)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.3, -0.1, True)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1\n    trade.set_liquidation_price(0.63)\n    trade.adjust_stop_loss(0.59, -0.1)\n    assert trade.stop_loss == 0.649\n    assert trade.liquidation_price == 0.63",
            "def test_adjust_stop_loss_short(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=5, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.04, 0.05)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.7, 0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.8, -0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.6, -0.1)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.3, -0.1, True)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1\n    trade.set_liquidation_price(0.63)\n    trade.adjust_stop_loss(0.59, -0.1)\n    assert trade.stop_loss == 0.649\n    assert trade.liquidation_price == 0.63",
            "def test_adjust_stop_loss_short(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=5, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.04, 0.05)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.7, 0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.8, -0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.6, -0.1)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.3, -0.1, True)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1\n    trade.set_liquidation_price(0.63)\n    trade.adjust_stop_loss(0.59, -0.1)\n    assert trade.stop_loss == 0.649\n    assert trade.liquidation_price == 0.63",
            "def test_adjust_stop_loss_short(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=5, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.04, 0.05)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.7, 0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.8, -0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.6, -0.1)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.3, -0.1, True)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1\n    trade.set_liquidation_price(0.63)\n    trade.adjust_stop_loss(0.59, -0.1)\n    assert trade.stop_loss == 0.649\n    assert trade.liquidation_price == 0.63",
            "def test_adjust_stop_loss_short(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=5, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.04, 0.05)\n    assert trade.stop_loss == 1.05\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.7, 0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.8, -0.1)\n    assert round(trade.stop_loss, 8) == 0.77\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.6, -0.1)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.3, -0.1, True)\n    assert round(trade.stop_loss, 8) == 0.66\n    assert trade.initial_stop_loss == 1.05\n    assert trade.initial_stop_loss_pct == -0.05\n    assert trade.stop_loss_pct == -0.1\n    trade.set_liquidation_price(0.63)\n    trade.adjust_stop_loss(0.59, -0.1)\n    assert trade.stop_loss == 0.649\n    assert trade.liquidation_price == 0.63"
        ]
    },
    {
        "func_name": "test_adjust_min_max_rates",
        "original": "def test_adjust_min_max_rates(fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1)\n    trade.adjust_min_max_rates(trade.open_rate, trade.open_rate)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 1\n    trade.adjust_min_max_rates(0.96, 0.96)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.05, 1.05)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.03, 1.03)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.1, 0.91)\n    assert trade.max_rate == 1.1\n    assert trade.min_rate == 0.91",
        "mutated": [
            "def test_adjust_min_max_rates(fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1)\n    trade.adjust_min_max_rates(trade.open_rate, trade.open_rate)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 1\n    trade.adjust_min_max_rates(0.96, 0.96)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.05, 1.05)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.03, 1.03)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.1, 0.91)\n    assert trade.max_rate == 1.1\n    assert trade.min_rate == 0.91",
            "def test_adjust_min_max_rates(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1)\n    trade.adjust_min_max_rates(trade.open_rate, trade.open_rate)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 1\n    trade.adjust_min_max_rates(0.96, 0.96)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.05, 1.05)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.03, 1.03)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.1, 0.91)\n    assert trade.max_rate == 1.1\n    assert trade.min_rate == 0.91",
            "def test_adjust_min_max_rates(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1)\n    trade.adjust_min_max_rates(trade.open_rate, trade.open_rate)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 1\n    trade.adjust_min_max_rates(0.96, 0.96)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.05, 1.05)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.03, 1.03)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.1, 0.91)\n    assert trade.max_rate == 1.1\n    assert trade.min_rate == 0.91",
            "def test_adjust_min_max_rates(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1)\n    trade.adjust_min_max_rates(trade.open_rate, trade.open_rate)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 1\n    trade.adjust_min_max_rates(0.96, 0.96)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.05, 1.05)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.03, 1.03)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.1, 0.91)\n    assert trade.max_rate == 1.1\n    assert trade.min_rate == 0.91",
            "def test_adjust_min_max_rates(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, amount=30.0, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=1)\n    trade.adjust_min_max_rates(trade.open_rate, trade.open_rate)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 1\n    trade.adjust_min_max_rates(0.96, 0.96)\n    assert trade.max_rate == 1\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.05, 1.05)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.03, 1.03)\n    assert trade.max_rate == 1.05\n    assert trade.min_rate == 0.96\n    trade.adjust_min_max_rates(1.1, 0.91)\n    assert trade.max_rate == 1.1\n    assert trade.min_rate == 0.91"
        ]
    },
    {
        "func_name": "test_get_open",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_open(fee, is_short, use_db):\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    assert len(Trade.get_open_trades()) == 4\n    assert Trade.get_open_trade_count() == 4\n    Trade.use_db = True",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_open(fee, is_short, use_db):\n    if False:\n        i = 10\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    assert len(Trade.get_open_trades()) == 4\n    assert Trade.get_open_trade_count() == 4\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_open(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    assert len(Trade.get_open_trades()) == 4\n    assert Trade.get_open_trade_count() == 4\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_open(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    assert len(Trade.get_open_trades()) == 4\n    assert Trade.get_open_trade_count() == 4\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_open(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    assert len(Trade.get_open_trades()) == 4\n    assert Trade.get_open_trade_count() == 4\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_open(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    assert len(Trade.get_open_trades()) == 4\n    assert Trade.get_open_trade_count() == 4\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_get_open_lev",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_open_lev(fee, use_db):\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_with_leverage(fee, use_db)\n    assert len(Trade.get_open_trades()) == 5\n    assert Trade.get_open_trade_count() == 5\n    Trade.use_db = True",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_open_lev(fee, use_db):\n    if False:\n        i = 10\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_with_leverage(fee, use_db)\n    assert len(Trade.get_open_trades()) == 5\n    assert Trade.get_open_trade_count() == 5\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_open_lev(fee, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_with_leverage(fee, use_db)\n    assert len(Trade.get_open_trades()) == 5\n    assert Trade.get_open_trade_count() == 5\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_open_lev(fee, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_with_leverage(fee, use_db)\n    assert len(Trade.get_open_trades()) == 5\n    assert Trade.get_open_trade_count() == 5\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_open_lev(fee, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_with_leverage(fee, use_db)\n    assert len(Trade.get_open_trades()) == 5\n    assert Trade.get_open_trade_count() == 5\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_open_lev(fee, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_with_leverage(fee, use_db)\n    assert len(Trade.get_open_trades()) == 5\n    assert Trade.get_open_trade_count() == 5\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_get_open_orders",
        "original": "@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.usefixtures('init_persistence')\ndef test_get_open_orders(fee, is_short, use_db):\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_usdt(fee, is_short, use_db)\n    trade = Trade.get_trades_proxy(pair='XRP/USDT')[0]\n    assert len(trade.orders) == 2\n    assert len(trade.open_orders) == 0\n    assert not trade.has_open_orders\n    Trade.use_db = True",
        "mutated": [
            "@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.usefixtures('init_persistence')\ndef test_get_open_orders(fee, is_short, use_db):\n    if False:\n        i = 10\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_usdt(fee, is_short, use_db)\n    trade = Trade.get_trades_proxy(pair='XRP/USDT')[0]\n    assert len(trade.orders) == 2\n    assert len(trade.open_orders) == 0\n    assert not trade.has_open_orders\n    Trade.use_db = True",
            "@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.usefixtures('init_persistence')\ndef test_get_open_orders(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_usdt(fee, is_short, use_db)\n    trade = Trade.get_trades_proxy(pair='XRP/USDT')[0]\n    assert len(trade.orders) == 2\n    assert len(trade.open_orders) == 0\n    assert not trade.has_open_orders\n    Trade.use_db = True",
            "@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.usefixtures('init_persistence')\ndef test_get_open_orders(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_usdt(fee, is_short, use_db)\n    trade = Trade.get_trades_proxy(pair='XRP/USDT')[0]\n    assert len(trade.orders) == 2\n    assert len(trade.open_orders) == 0\n    assert not trade.has_open_orders\n    Trade.use_db = True",
            "@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.usefixtures('init_persistence')\ndef test_get_open_orders(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_usdt(fee, is_short, use_db)\n    trade = Trade.get_trades_proxy(pair='XRP/USDT')[0]\n    assert len(trade.orders) == 2\n    assert len(trade.open_orders) == 0\n    assert not trade.has_open_orders\n    Trade.use_db = True",
            "@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\n@pytest.mark.usefixtures('init_persistence')\ndef test_get_open_orders(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades_usdt(fee, is_short, use_db)\n    trade = Trade.get_trades_proxy(pair='XRP/USDT')[0]\n    assert len(trade.orders) == 2\n    assert len(trade.open_orders) == 0\n    assert not trade.has_open_orders\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_to_json",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_to_json(fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=123.0, amount_requested=123.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), open_rate=0.123, exchange='binance', enter_tag=None, precision_mode=1, amount_precision=8.0, price_precision=7.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'ADA/USDT', 'base_currency': 'ADA', 'quote_currency': 'USDT', 'is_open': None, 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': None, 'close_timestamp': None, 'open_rate': 0.123, 'open_rate_requested': None, 'open_trade_value': 15.1668225, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'close_rate': None, 'close_rate_requested': None, 'amount': 123.0, 'amount_requested': 123.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': None, 'trade_duration_s': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'exit_reason': None, 'exit_order_status': None, 'stop_loss_abs': None, 'stop_loss_ratio': None, 'stop_loss_pct': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'min_rate': None, 'max_rate': None, 'strategy': None, 'enter_tag': None, 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 8.0, 'price_precision': 7.0, 'precision_mode': 1, 'contract_size': 1, 'orders': [], 'has_open_orders': False}\n    trade = Trade(pair='XRP/BTC', stake_amount=0.001, amount=100.0, amount_requested=101.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), close_date=dt_now() - timedelta(hours=1), open_rate=0.123, close_rate=0.125, enter_tag='buys_signal_001', exchange='binance', precision_mode=2, amount_precision=7.0, price_precision=8.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'XRP/BTC', 'base_currency': 'XRP', 'quote_currency': 'BTC', 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': trade.close_date.strftime(DATETIME_PRINT_FORMAT), 'close_timestamp': int(trade.close_date.timestamp() * 1000), 'open_rate': 0.123, 'close_rate': 0.125, 'amount': 100.0, 'amount_requested': 101.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': 60, 'trade_duration_s': 3600, 'stop_loss_abs': None, 'stop_loss_pct': None, 'stop_loss_ratio': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'close_rate_requested': None, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'is_open': None, 'max_rate': None, 'min_rate': None, 'open_rate_requested': None, 'open_trade_value': 12.33075, 'exit_reason': None, 'exit_order_status': None, 'strategy': None, 'enter_tag': 'buys_signal_001', 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 7.0, 'price_precision': 8.0, 'precision_mode': 2, 'contract_size': 1, 'orders': [], 'has_open_orders': False}",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_to_json(fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=123.0, amount_requested=123.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), open_rate=0.123, exchange='binance', enter_tag=None, precision_mode=1, amount_precision=8.0, price_precision=7.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'ADA/USDT', 'base_currency': 'ADA', 'quote_currency': 'USDT', 'is_open': None, 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': None, 'close_timestamp': None, 'open_rate': 0.123, 'open_rate_requested': None, 'open_trade_value': 15.1668225, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'close_rate': None, 'close_rate_requested': None, 'amount': 123.0, 'amount_requested': 123.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': None, 'trade_duration_s': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'exit_reason': None, 'exit_order_status': None, 'stop_loss_abs': None, 'stop_loss_ratio': None, 'stop_loss_pct': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'min_rate': None, 'max_rate': None, 'strategy': None, 'enter_tag': None, 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 8.0, 'price_precision': 7.0, 'precision_mode': 1, 'contract_size': 1, 'orders': [], 'has_open_orders': False}\n    trade = Trade(pair='XRP/BTC', stake_amount=0.001, amount=100.0, amount_requested=101.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), close_date=dt_now() - timedelta(hours=1), open_rate=0.123, close_rate=0.125, enter_tag='buys_signal_001', exchange='binance', precision_mode=2, amount_precision=7.0, price_precision=8.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'XRP/BTC', 'base_currency': 'XRP', 'quote_currency': 'BTC', 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': trade.close_date.strftime(DATETIME_PRINT_FORMAT), 'close_timestamp': int(trade.close_date.timestamp() * 1000), 'open_rate': 0.123, 'close_rate': 0.125, 'amount': 100.0, 'amount_requested': 101.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': 60, 'trade_duration_s': 3600, 'stop_loss_abs': None, 'stop_loss_pct': None, 'stop_loss_ratio': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'close_rate_requested': None, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'is_open': None, 'max_rate': None, 'min_rate': None, 'open_rate_requested': None, 'open_trade_value': 12.33075, 'exit_reason': None, 'exit_order_status': None, 'strategy': None, 'enter_tag': 'buys_signal_001', 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 7.0, 'price_precision': 8.0, 'precision_mode': 2, 'contract_size': 1, 'orders': [], 'has_open_orders': False}",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_to_json(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=123.0, amount_requested=123.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), open_rate=0.123, exchange='binance', enter_tag=None, precision_mode=1, amount_precision=8.0, price_precision=7.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'ADA/USDT', 'base_currency': 'ADA', 'quote_currency': 'USDT', 'is_open': None, 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': None, 'close_timestamp': None, 'open_rate': 0.123, 'open_rate_requested': None, 'open_trade_value': 15.1668225, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'close_rate': None, 'close_rate_requested': None, 'amount': 123.0, 'amount_requested': 123.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': None, 'trade_duration_s': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'exit_reason': None, 'exit_order_status': None, 'stop_loss_abs': None, 'stop_loss_ratio': None, 'stop_loss_pct': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'min_rate': None, 'max_rate': None, 'strategy': None, 'enter_tag': None, 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 8.0, 'price_precision': 7.0, 'precision_mode': 1, 'contract_size': 1, 'orders': [], 'has_open_orders': False}\n    trade = Trade(pair='XRP/BTC', stake_amount=0.001, amount=100.0, amount_requested=101.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), close_date=dt_now() - timedelta(hours=1), open_rate=0.123, close_rate=0.125, enter_tag='buys_signal_001', exchange='binance', precision_mode=2, amount_precision=7.0, price_precision=8.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'XRP/BTC', 'base_currency': 'XRP', 'quote_currency': 'BTC', 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': trade.close_date.strftime(DATETIME_PRINT_FORMAT), 'close_timestamp': int(trade.close_date.timestamp() * 1000), 'open_rate': 0.123, 'close_rate': 0.125, 'amount': 100.0, 'amount_requested': 101.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': 60, 'trade_duration_s': 3600, 'stop_loss_abs': None, 'stop_loss_pct': None, 'stop_loss_ratio': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'close_rate_requested': None, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'is_open': None, 'max_rate': None, 'min_rate': None, 'open_rate_requested': None, 'open_trade_value': 12.33075, 'exit_reason': None, 'exit_order_status': None, 'strategy': None, 'enter_tag': 'buys_signal_001', 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 7.0, 'price_precision': 8.0, 'precision_mode': 2, 'contract_size': 1, 'orders': [], 'has_open_orders': False}",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_to_json(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=123.0, amount_requested=123.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), open_rate=0.123, exchange='binance', enter_tag=None, precision_mode=1, amount_precision=8.0, price_precision=7.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'ADA/USDT', 'base_currency': 'ADA', 'quote_currency': 'USDT', 'is_open': None, 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': None, 'close_timestamp': None, 'open_rate': 0.123, 'open_rate_requested': None, 'open_trade_value': 15.1668225, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'close_rate': None, 'close_rate_requested': None, 'amount': 123.0, 'amount_requested': 123.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': None, 'trade_duration_s': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'exit_reason': None, 'exit_order_status': None, 'stop_loss_abs': None, 'stop_loss_ratio': None, 'stop_loss_pct': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'min_rate': None, 'max_rate': None, 'strategy': None, 'enter_tag': None, 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 8.0, 'price_precision': 7.0, 'precision_mode': 1, 'contract_size': 1, 'orders': [], 'has_open_orders': False}\n    trade = Trade(pair='XRP/BTC', stake_amount=0.001, amount=100.0, amount_requested=101.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), close_date=dt_now() - timedelta(hours=1), open_rate=0.123, close_rate=0.125, enter_tag='buys_signal_001', exchange='binance', precision_mode=2, amount_precision=7.0, price_precision=8.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'XRP/BTC', 'base_currency': 'XRP', 'quote_currency': 'BTC', 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': trade.close_date.strftime(DATETIME_PRINT_FORMAT), 'close_timestamp': int(trade.close_date.timestamp() * 1000), 'open_rate': 0.123, 'close_rate': 0.125, 'amount': 100.0, 'amount_requested': 101.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': 60, 'trade_duration_s': 3600, 'stop_loss_abs': None, 'stop_loss_pct': None, 'stop_loss_ratio': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'close_rate_requested': None, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'is_open': None, 'max_rate': None, 'min_rate': None, 'open_rate_requested': None, 'open_trade_value': 12.33075, 'exit_reason': None, 'exit_order_status': None, 'strategy': None, 'enter_tag': 'buys_signal_001', 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 7.0, 'price_precision': 8.0, 'precision_mode': 2, 'contract_size': 1, 'orders': [], 'has_open_orders': False}",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_to_json(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=123.0, amount_requested=123.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), open_rate=0.123, exchange='binance', enter_tag=None, precision_mode=1, amount_precision=8.0, price_precision=7.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'ADA/USDT', 'base_currency': 'ADA', 'quote_currency': 'USDT', 'is_open': None, 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': None, 'close_timestamp': None, 'open_rate': 0.123, 'open_rate_requested': None, 'open_trade_value': 15.1668225, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'close_rate': None, 'close_rate_requested': None, 'amount': 123.0, 'amount_requested': 123.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': None, 'trade_duration_s': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'exit_reason': None, 'exit_order_status': None, 'stop_loss_abs': None, 'stop_loss_ratio': None, 'stop_loss_pct': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'min_rate': None, 'max_rate': None, 'strategy': None, 'enter_tag': None, 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 8.0, 'price_precision': 7.0, 'precision_mode': 1, 'contract_size': 1, 'orders': [], 'has_open_orders': False}\n    trade = Trade(pair='XRP/BTC', stake_amount=0.001, amount=100.0, amount_requested=101.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), close_date=dt_now() - timedelta(hours=1), open_rate=0.123, close_rate=0.125, enter_tag='buys_signal_001', exchange='binance', precision_mode=2, amount_precision=7.0, price_precision=8.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'XRP/BTC', 'base_currency': 'XRP', 'quote_currency': 'BTC', 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': trade.close_date.strftime(DATETIME_PRINT_FORMAT), 'close_timestamp': int(trade.close_date.timestamp() * 1000), 'open_rate': 0.123, 'close_rate': 0.125, 'amount': 100.0, 'amount_requested': 101.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': 60, 'trade_duration_s': 3600, 'stop_loss_abs': None, 'stop_loss_pct': None, 'stop_loss_ratio': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'close_rate_requested': None, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'is_open': None, 'max_rate': None, 'min_rate': None, 'open_rate_requested': None, 'open_trade_value': 12.33075, 'exit_reason': None, 'exit_order_status': None, 'strategy': None, 'enter_tag': 'buys_signal_001', 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 7.0, 'price_precision': 8.0, 'precision_mode': 2, 'contract_size': 1, 'orders': [], 'has_open_orders': False}",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_to_json(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, amount=123.0, amount_requested=123.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), open_rate=0.123, exchange='binance', enter_tag=None, precision_mode=1, amount_precision=8.0, price_precision=7.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'ADA/USDT', 'base_currency': 'ADA', 'quote_currency': 'USDT', 'is_open': None, 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': None, 'close_timestamp': None, 'open_rate': 0.123, 'open_rate_requested': None, 'open_trade_value': 15.1668225, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'close_rate': None, 'close_rate_requested': None, 'amount': 123.0, 'amount_requested': 123.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': None, 'trade_duration_s': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'exit_reason': None, 'exit_order_status': None, 'stop_loss_abs': None, 'stop_loss_ratio': None, 'stop_loss_pct': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'min_rate': None, 'max_rate': None, 'strategy': None, 'enter_tag': None, 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 8.0, 'price_precision': 7.0, 'precision_mode': 1, 'contract_size': 1, 'orders': [], 'has_open_orders': False}\n    trade = Trade(pair='XRP/BTC', stake_amount=0.001, amount=100.0, amount_requested=101.0, fee_open=fee.return_value, fee_close=fee.return_value, open_date=dt_now() - timedelta(hours=2), close_date=dt_now() - timedelta(hours=1), open_rate=0.123, close_rate=0.125, enter_tag='buys_signal_001', exchange='binance', precision_mode=2, amount_precision=7.0, price_precision=8.0, contract_size=1)\n    result = trade.to_json()\n    assert isinstance(result, dict)\n    assert result == {'trade_id': None, 'pair': 'XRP/BTC', 'base_currency': 'XRP', 'quote_currency': 'BTC', 'open_date': trade.open_date.strftime(DATETIME_PRINT_FORMAT), 'open_timestamp': int(trade.open_date.timestamp() * 1000), 'close_date': trade.close_date.strftime(DATETIME_PRINT_FORMAT), 'close_timestamp': int(trade.close_date.timestamp() * 1000), 'open_rate': 0.123, 'close_rate': 0.125, 'amount': 100.0, 'amount_requested': 101.0, 'stake_amount': 0.001, 'max_stake_amount': None, 'trade_duration': 60, 'trade_duration_s': 3600, 'stop_loss_abs': None, 'stop_loss_pct': None, 'stop_loss_ratio': None, 'stoploss_order_id': None, 'stoploss_last_update': None, 'stoploss_last_update_timestamp': None, 'initial_stop_loss_abs': None, 'initial_stop_loss_pct': None, 'initial_stop_loss_ratio': None, 'realized_profit': 0.0, 'realized_profit_ratio': None, 'close_profit': None, 'close_profit_pct': None, 'close_profit_abs': None, 'profit_ratio': None, 'profit_pct': None, 'profit_abs': None, 'close_rate_requested': None, 'fee_close': 0.0025, 'fee_close_cost': None, 'fee_close_currency': None, 'fee_open': 0.0025, 'fee_open_cost': None, 'fee_open_currency': None, 'is_open': None, 'max_rate': None, 'min_rate': None, 'open_rate_requested': None, 'open_trade_value': 12.33075, 'exit_reason': None, 'exit_order_status': None, 'strategy': None, 'enter_tag': 'buys_signal_001', 'timeframe': None, 'exchange': 'binance', 'leverage': None, 'interest_rate': None, 'liquidation_price': None, 'is_short': None, 'trading_mode': None, 'funding_fees': None, 'amount_precision': 7.0, 'price_precision': 8.0, 'precision_mode': 2, 'contract_size': 1, 'orders': [], 'has_open_orders': False}"
        ]
    },
    {
        "func_name": "test_stoploss_reinitialization",
        "original": "def test_stoploss_reinitialization(default_conf, fee):\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.06)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.94\n    assert trade_adj.stop_loss_pct == -0.06\n    assert trade_adj.initial_stop_loss == 0.94\n    assert trade_adj.initial_stop_loss_pct == -0.06\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.96\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04\n    trade.adjust_stop_loss(1.02, 0.04)\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.initial_stop_loss == 0.96\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04",
        "mutated": [
            "def test_stoploss_reinitialization(default_conf, fee):\n    if False:\n        i = 10\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.06)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.94\n    assert trade_adj.stop_loss_pct == -0.06\n    assert trade_adj.initial_stop_loss == 0.94\n    assert trade_adj.initial_stop_loss_pct == -0.06\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.96\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04\n    trade.adjust_stop_loss(1.02, 0.04)\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.initial_stop_loss == 0.96\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04",
            "def test_stoploss_reinitialization(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.06)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.94\n    assert trade_adj.stop_loss_pct == -0.06\n    assert trade_adj.initial_stop_loss == 0.94\n    assert trade_adj.initial_stop_loss_pct == -0.06\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.96\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04\n    trade.adjust_stop_loss(1.02, 0.04)\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.initial_stop_loss == 0.96\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04",
            "def test_stoploss_reinitialization(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.06)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.94\n    assert trade_adj.stop_loss_pct == -0.06\n    assert trade_adj.initial_stop_loss == 0.94\n    assert trade_adj.initial_stop_loss_pct == -0.06\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.96\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04\n    trade.adjust_stop_loss(1.02, 0.04)\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.initial_stop_loss == 0.96\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04",
            "def test_stoploss_reinitialization(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.06)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.94\n    assert trade_adj.stop_loss_pct == -0.06\n    assert trade_adj.initial_stop_loss == 0.94\n    assert trade_adj.initial_stop_loss_pct == -0.06\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.96\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04\n    trade.adjust_stop_loss(1.02, 0.04)\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.initial_stop_loss == 0.96\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04",
            "def test_stoploss_reinitialization(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    trade.adjust_stop_loss(trade.open_rate, 0.05, True)\n    assert trade.stop_loss == 0.95\n    assert trade.stop_loss_pct == -0.05\n    assert trade.initial_stop_loss == 0.95\n    assert trade.initial_stop_loss_pct == -0.05\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.06)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.94\n    assert trade_adj.stop_loss_pct == -0.06\n    assert trade_adj.initial_stop_loss == 0.94\n    assert trade_adj.initial_stop_loss_pct == -0.06\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.96\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04\n    trade.adjust_stop_loss(1.02, 0.04)\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.initial_stop_loss == 0.96\n    Trade.stoploss_reinitialization(0.04)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9792\n    assert trade_adj.stop_loss_pct == -0.04\n    assert trade_adj.initial_stop_loss == 0.96\n    assert trade_adj.initial_stop_loss_pct == -0.04"
        ]
    },
    {
        "func_name": "test_stoploss_reinitialization_leverage",
        "original": "def test_stoploss_reinitialization_leverage(default_conf, fee):\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, 0.1, True)\n    assert trade.stop_loss == 0.98\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.98\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.97\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 0.97\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.99\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.02, 0.05)\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.initial_stop_loss == 0.99\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05",
        "mutated": [
            "def test_stoploss_reinitialization_leverage(default_conf, fee):\n    if False:\n        i = 10\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, 0.1, True)\n    assert trade.stop_loss == 0.98\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.98\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.97\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 0.97\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.99\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.02, 0.05)\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.initial_stop_loss == 0.99\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05",
            "def test_stoploss_reinitialization_leverage(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, 0.1, True)\n    assert trade.stop_loss == 0.98\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.98\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.97\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 0.97\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.99\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.02, 0.05)\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.initial_stop_loss == 0.99\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05",
            "def test_stoploss_reinitialization_leverage(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, 0.1, True)\n    assert trade.stop_loss == 0.98\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.98\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.97\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 0.97\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.99\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.02, 0.05)\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.initial_stop_loss == 0.99\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05",
            "def test_stoploss_reinitialization_leverage(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, 0.1, True)\n    assert trade.stop_loss == 0.98\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.98\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.97\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 0.97\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.99\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.02, 0.05)\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.initial_stop_loss == 0.99\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05",
            "def test_stoploss_reinitialization_leverage(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, 0.1, True)\n    assert trade.stop_loss == 0.98\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 0.98\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.97\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 0.97\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.99\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(1.02, 0.05)\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.initial_stop_loss == 0.99\n    Trade.stoploss_reinitialization(0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.0098\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 0.99\n    assert trade_adj.initial_stop_loss_pct == -0.05"
        ]
    },
    {
        "func_name": "test_stoploss_reinitialization_short",
        "original": "def test_stoploss_reinitialization_short(default_conf, fee):\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=10, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, -0.1, True)\n    assert trade.stop_loss == 1.02\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.02\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(-0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.03\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 1.03\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.01\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.98, -0.05)\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.initial_stop_loss == 1.01\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade_adj.set_liquidation_price(0.985)\n    trade.adjust_stop_loss(0.9799, -0.05)\n    assert trade_adj.stop_loss == 0.989699\n    assert trade_adj.liquidation_price == 0.985",
        "mutated": [
            "def test_stoploss_reinitialization_short(default_conf, fee):\n    if False:\n        i = 10\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=10, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, -0.1, True)\n    assert trade.stop_loss == 1.02\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.02\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(-0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.03\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 1.03\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.01\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.98, -0.05)\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.initial_stop_loss == 1.01\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade_adj.set_liquidation_price(0.985)\n    trade.adjust_stop_loss(0.9799, -0.05)\n    assert trade_adj.stop_loss == 0.989699\n    assert trade_adj.liquidation_price == 0.985",
            "def test_stoploss_reinitialization_short(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=10, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, -0.1, True)\n    assert trade.stop_loss == 1.02\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.02\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(-0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.03\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 1.03\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.01\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.98, -0.05)\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.initial_stop_loss == 1.01\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade_adj.set_liquidation_price(0.985)\n    trade.adjust_stop_loss(0.9799, -0.05)\n    assert trade_adj.stop_loss == 0.989699\n    assert trade_adj.liquidation_price == 0.985",
            "def test_stoploss_reinitialization_short(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=10, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, -0.1, True)\n    assert trade.stop_loss == 1.02\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.02\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(-0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.03\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 1.03\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.01\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.98, -0.05)\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.initial_stop_loss == 1.01\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade_adj.set_liquidation_price(0.985)\n    trade.adjust_stop_loss(0.9799, -0.05)\n    assert trade_adj.stop_loss == 0.989699\n    assert trade_adj.liquidation_price == 0.985",
            "def test_stoploss_reinitialization_short(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=10, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, -0.1, True)\n    assert trade.stop_loss == 1.02\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.02\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(-0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.03\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 1.03\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.01\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.98, -0.05)\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.initial_stop_loss == 1.01\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade_adj.set_liquidation_price(0.985)\n    trade.adjust_stop_loss(0.9799, -0.05)\n    assert trade_adj.stop_loss == 0.989699\n    assert trade_adj.liquidation_price == 0.985",
            "def test_stoploss_reinitialization_short(default_conf, fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    init_db(default_conf['db_url'])\n    trade = Trade(pair='ADA/USDT', stake_amount=0.001, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=10, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1, is_short=True, leverage=5.0)\n    trade.adjust_stop_loss(trade.open_rate, -0.1, True)\n    assert trade.stop_loss == 1.02\n    assert trade.stop_loss_pct == -0.1\n    assert trade.initial_stop_loss == 1.02\n    assert trade.initial_stop_loss_pct == -0.1\n    Trade.session.add(trade)\n    Trade.commit()\n    Trade.stoploss_reinitialization(-0.15)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.03\n    assert trade_adj.stop_loss_pct == -0.15\n    assert trade_adj.initial_stop_loss == 1.03\n    assert trade_adj.initial_stop_loss_pct == -0.15\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 1.01\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade.adjust_stop_loss(0.98, -0.05)\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.initial_stop_loss == 1.01\n    Trade.stoploss_reinitialization(-0.05)\n    trades = Trade.get_open_trades()\n    assert len(trades) == 1\n    trade_adj = trades[0]\n    assert trade_adj.stop_loss == 0.9898\n    assert trade_adj.stop_loss_pct == -0.05\n    assert trade_adj.initial_stop_loss == 1.01\n    assert trade_adj.initial_stop_loss_pct == -0.05\n    trade_adj.set_liquidation_price(0.985)\n    trade.adjust_stop_loss(0.9799, -0.05)\n    assert trade_adj.stop_loss == 0.989699\n    assert trade_adj.liquidation_price == 0.985"
        ]
    },
    {
        "func_name": "test_update_fee",
        "original": "def test_update_fee(fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    fee_cost = 0.15\n    fee_currency = 'BTC'\n    fee_rate = 0.0075\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency == fee_currency\n    assert trade.fee_open_cost == fee_cost\n    assert trade.fee_open == fee_rate\n    assert trade.fee_close == fee_rate\n    assert trade.fee_close_currency is None\n    assert trade.fee_close_cost is None\n    fee_rate = 0.0076\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert trade.fee_close == 0.0076\n    assert trade.fee_close_cost == fee_cost\n    assert trade.fee_close == fee_rate",
        "mutated": [
            "def test_update_fee(fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    fee_cost = 0.15\n    fee_currency = 'BTC'\n    fee_rate = 0.0075\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency == fee_currency\n    assert trade.fee_open_cost == fee_cost\n    assert trade.fee_open == fee_rate\n    assert trade.fee_close == fee_rate\n    assert trade.fee_close_currency is None\n    assert trade.fee_close_cost is None\n    fee_rate = 0.0076\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert trade.fee_close == 0.0076\n    assert trade.fee_close_cost == fee_cost\n    assert trade.fee_close == fee_rate",
            "def test_update_fee(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    fee_cost = 0.15\n    fee_currency = 'BTC'\n    fee_rate = 0.0075\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency == fee_currency\n    assert trade.fee_open_cost == fee_cost\n    assert trade.fee_open == fee_rate\n    assert trade.fee_close == fee_rate\n    assert trade.fee_close_currency is None\n    assert trade.fee_close_cost is None\n    fee_rate = 0.0076\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert trade.fee_close == 0.0076\n    assert trade.fee_close_cost == fee_cost\n    assert trade.fee_close == fee_rate",
            "def test_update_fee(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    fee_cost = 0.15\n    fee_currency = 'BTC'\n    fee_rate = 0.0075\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency == fee_currency\n    assert trade.fee_open_cost == fee_cost\n    assert trade.fee_open == fee_rate\n    assert trade.fee_close == fee_rate\n    assert trade.fee_close_currency is None\n    assert trade.fee_close_cost is None\n    fee_rate = 0.0076\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert trade.fee_close == 0.0076\n    assert trade.fee_close_cost == fee_cost\n    assert trade.fee_close == fee_rate",
            "def test_update_fee(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    fee_cost = 0.15\n    fee_currency = 'BTC'\n    fee_rate = 0.0075\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency == fee_currency\n    assert trade.fee_open_cost == fee_cost\n    assert trade.fee_open == fee_rate\n    assert trade.fee_close == fee_rate\n    assert trade.fee_close_currency is None\n    assert trade.fee_close_cost is None\n    fee_rate = 0.0076\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert trade.fee_close == 0.0076\n    assert trade.fee_close_cost == fee_cost\n    assert trade.fee_close == fee_rate",
            "def test_update_fee(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    fee_cost = 0.15\n    fee_currency = 'BTC'\n    fee_rate = 0.0075\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency == fee_currency\n    assert trade.fee_open_cost == fee_cost\n    assert trade.fee_open == fee_rate\n    assert trade.fee_close == fee_rate\n    assert trade.fee_close_currency is None\n    assert trade.fee_close_cost is None\n    fee_rate = 0.0076\n    trade.update_fee(fee_cost, fee_currency, fee_rate, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert trade.fee_close == 0.0076\n    assert trade.fee_close_cost == fee_cost\n    assert trade.fee_close == fee_rate"
        ]
    },
    {
        "func_name": "test_fee_updated",
        "original": "def test_fee_updated(fee):\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert not trade.fee_updated('asdf')\n    trade.update_fee(0.15, 'BTC', 0.0075, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency is not None\n    assert trade.fee_close_currency is None\n    trade.update_fee(0.15, 'ABC', 0.0075, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert not trade.fee_updated('asfd')",
        "mutated": [
            "def test_fee_updated(fee):\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert not trade.fee_updated('asdf')\n    trade.update_fee(0.15, 'BTC', 0.0075, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency is not None\n    assert trade.fee_close_currency is None\n    trade.update_fee(0.15, 'ABC', 0.0075, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert not trade.fee_updated('asfd')",
            "def test_fee_updated(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert not trade.fee_updated('asdf')\n    trade.update_fee(0.15, 'BTC', 0.0075, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency is not None\n    assert trade.fee_close_currency is None\n    trade.update_fee(0.15, 'ABC', 0.0075, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert not trade.fee_updated('asfd')",
            "def test_fee_updated(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert not trade.fee_updated('asdf')\n    trade.update_fee(0.15, 'BTC', 0.0075, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency is not None\n    assert trade.fee_close_currency is None\n    trade.update_fee(0.15, 'ABC', 0.0075, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert not trade.fee_updated('asfd')",
            "def test_fee_updated(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert not trade.fee_updated('asdf')\n    trade.update_fee(0.15, 'BTC', 0.0075, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency is not None\n    assert trade.fee_close_currency is None\n    trade.update_fee(0.15, 'ABC', 0.0075, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert not trade.fee_updated('asfd')",
            "def test_fee_updated(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=30.0, fee_open=fee.return_value, open_date=dt_now() - timedelta(hours=2), amount=30.0, fee_close=fee.return_value, exchange='binance', open_rate=1, max_rate=1)\n    assert trade.fee_open_currency is None\n    assert not trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert not trade.fee_updated('asdf')\n    trade.update_fee(0.15, 'BTC', 0.0075, 'buy')\n    assert trade.fee_updated('buy')\n    assert not trade.fee_updated('sell')\n    assert trade.fee_open_currency is not None\n    assert trade.fee_close_currency is None\n    trade.update_fee(0.15, 'ABC', 0.0075, 'sell')\n    assert trade.fee_updated('buy')\n    assert trade.fee_updated('sell')\n    assert not trade.fee_updated('asfd')"
        ]
    },
    {
        "func_name": "test_total_open_trades_stakes",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_total_open_trades_stakes(fee, is_short, use_db):\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.total_open_trades_stakes()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.total_open_trades_stakes()\n    assert res == 0.004\n    Trade.use_db = True",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_total_open_trades_stakes(fee, is_short, use_db):\n    if False:\n        i = 10\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.total_open_trades_stakes()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.total_open_trades_stakes()\n    assert res == 0.004\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_total_open_trades_stakes(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.total_open_trades_stakes()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.total_open_trades_stakes()\n    assert res == 0.004\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_total_open_trades_stakes(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.total_open_trades_stakes()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.total_open_trades_stakes()\n    assert res == 0.004\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_total_open_trades_stakes(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.total_open_trades_stakes()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.total_open_trades_stakes()\n    assert res == 0.004\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_total_open_trades_stakes(fee, is_short, use_db):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.total_open_trades_stakes()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.total_open_trades_stakes()\n    assert res == 0.004\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_get_total_closed_profit",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,result', [(True, -0.006739127), (False, 0.000739127), (None, -0.005429127)])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_total_closed_profit(fee, use_db, is_short, result):\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.get_total_closed_profit()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.get_total_closed_profit()\n    assert pytest.approx(res) == result\n    Trade.use_db = True",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,result', [(True, -0.006739127), (False, 0.000739127), (None, -0.005429127)])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_total_closed_profit(fee, use_db, is_short, result):\n    if False:\n        i = 10\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.get_total_closed_profit()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.get_total_closed_profit()\n    assert pytest.approx(res) == result\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,result', [(True, -0.006739127), (False, 0.000739127), (None, -0.005429127)])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_total_closed_profit(fee, use_db, is_short, result):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.get_total_closed_profit()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.get_total_closed_profit()\n    assert pytest.approx(res) == result\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,result', [(True, -0.006739127), (False, 0.000739127), (None, -0.005429127)])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_total_closed_profit(fee, use_db, is_short, result):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.get_total_closed_profit()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.get_total_closed_profit()\n    assert pytest.approx(res) == result\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,result', [(True, -0.006739127), (False, 0.000739127), (None, -0.005429127)])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_total_closed_profit(fee, use_db, is_short, result):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.get_total_closed_profit()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.get_total_closed_profit()\n    assert pytest.approx(res) == result\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,result', [(True, -0.006739127), (False, 0.000739127), (None, -0.005429127)])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_total_closed_profit(fee, use_db, is_short, result):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    res = Trade.get_total_closed_profit()\n    assert res == 0\n    create_mock_trades(fee, is_short, use_db)\n    res = Trade.get_total_closed_profit()\n    assert pytest.approx(res) == result\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_get_trades_proxy",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_trades_proxy(fee, use_db, is_short):\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    trades = Trade.get_trades_proxy()\n    assert len(trades) == 6\n    assert isinstance(trades[0], Trade)\n    trades = Trade.get_trades_proxy(is_open=True)\n    assert len(trades) == 4\n    assert trades[0].is_open\n    trades = Trade.get_trades_proxy(is_open=False)\n    assert len(trades) == 2\n    assert not trades[0].is_open\n    opendate = datetime.now(tz=timezone.utc) - timedelta(minutes=15)\n    assert len(Trade.get_trades_proxy(open_date=opendate)) == 3\n    Trade.use_db = True",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_trades_proxy(fee, use_db, is_short):\n    if False:\n        i = 10\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    trades = Trade.get_trades_proxy()\n    assert len(trades) == 6\n    assert isinstance(trades[0], Trade)\n    trades = Trade.get_trades_proxy(is_open=True)\n    assert len(trades) == 4\n    assert trades[0].is_open\n    trades = Trade.get_trades_proxy(is_open=False)\n    assert len(trades) == 2\n    assert not trades[0].is_open\n    opendate = datetime.now(tz=timezone.utc) - timedelta(minutes=15)\n    assert len(Trade.get_trades_proxy(open_date=opendate)) == 3\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_trades_proxy(fee, use_db, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    trades = Trade.get_trades_proxy()\n    assert len(trades) == 6\n    assert isinstance(trades[0], Trade)\n    trades = Trade.get_trades_proxy(is_open=True)\n    assert len(trades) == 4\n    assert trades[0].is_open\n    trades = Trade.get_trades_proxy(is_open=False)\n    assert len(trades) == 2\n    assert not trades[0].is_open\n    opendate = datetime.now(tz=timezone.utc) - timedelta(minutes=15)\n    assert len(Trade.get_trades_proxy(open_date=opendate)) == 3\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_trades_proxy(fee, use_db, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    trades = Trade.get_trades_proxy()\n    assert len(trades) == 6\n    assert isinstance(trades[0], Trade)\n    trades = Trade.get_trades_proxy(is_open=True)\n    assert len(trades) == 4\n    assert trades[0].is_open\n    trades = Trade.get_trades_proxy(is_open=False)\n    assert len(trades) == 2\n    assert not trades[0].is_open\n    opendate = datetime.now(tz=timezone.utc) - timedelta(minutes=15)\n    assert len(Trade.get_trades_proxy(open_date=opendate)) == 3\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_trades_proxy(fee, use_db, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    trades = Trade.get_trades_proxy()\n    assert len(trades) == 6\n    assert isinstance(trades[0], Trade)\n    trades = Trade.get_trades_proxy(is_open=True)\n    assert len(trades) == 4\n    assert trades[0].is_open\n    trades = Trade.get_trades_proxy(is_open=False)\n    assert len(trades) == 2\n    assert not trades[0].is_open\n    opendate = datetime.now(tz=timezone.utc) - timedelta(minutes=15)\n    assert len(Trade.get_trades_proxy(open_date=opendate)) == 3\n    Trade.use_db = True",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\n@pytest.mark.parametrize('use_db', [True, False])\ndef test_get_trades_proxy(fee, use_db, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = use_db\n    Trade.reset_trades()\n    create_mock_trades(fee, is_short, use_db)\n    trades = Trade.get_trades_proxy()\n    assert len(trades) == 6\n    assert isinstance(trades[0], Trade)\n    trades = Trade.get_trades_proxy(is_open=True)\n    assert len(trades) == 4\n    assert trades[0].is_open\n    trades = Trade.get_trades_proxy(is_open=False)\n    assert len(trades) == 2\n    assert not trades[0].is_open\n    opendate = datetime.now(tz=timezone.utc) - timedelta(minutes=15)\n    assert len(Trade.get_trades_proxy(open_date=opendate)) == 3\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_get_trades__query",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_trades__query(fee, is_short):\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()\n    create_mock_trades(fee, is_short)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_trades__query(fee, is_short):\n    if False:\n        i = 10\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()\n    create_mock_trades(fee, is_short)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_trades__query(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()\n    create_mock_trades(fee, is_short)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_trades__query(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()\n    create_mock_trades(fee, is_short)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_trades__query(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()\n    create_mock_trades(fee, is_short)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_trades__query(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()\n    create_mock_trades(fee, is_short)\n    query = Trade.get_trades_query([])\n    query1 = Trade.get_trades_query([], include_orders=False)\n    assert query._with_options == ()\n    assert query1._with_options != ()"
        ]
    },
    {
        "func_name": "test_get_trades_backtest",
        "original": "def test_get_trades_backtest():\n    Trade.use_db = False\n    with pytest.raises(NotImplementedError, match='`Trade.get_trades\\\\(\\\\)` not .*'):\n        Trade.get_trades([])\n    Trade.use_db = True",
        "mutated": [
            "def test_get_trades_backtest():\n    if False:\n        i = 10\n    Trade.use_db = False\n    with pytest.raises(NotImplementedError, match='`Trade.get_trades\\\\(\\\\)` not .*'):\n        Trade.get_trades([])\n    Trade.use_db = True",
            "def test_get_trades_backtest():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    Trade.use_db = False\n    with pytest.raises(NotImplementedError, match='`Trade.get_trades\\\\(\\\\)` not .*'):\n        Trade.get_trades([])\n    Trade.use_db = True",
            "def test_get_trades_backtest():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    Trade.use_db = False\n    with pytest.raises(NotImplementedError, match='`Trade.get_trades\\\\(\\\\)` not .*'):\n        Trade.get_trades([])\n    Trade.use_db = True",
            "def test_get_trades_backtest():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    Trade.use_db = False\n    with pytest.raises(NotImplementedError, match='`Trade.get_trades\\\\(\\\\)` not .*'):\n        Trade.get_trades([])\n    Trade.use_db = True",
            "def test_get_trades_backtest():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    Trade.use_db = False\n    with pytest.raises(NotImplementedError, match='`Trade.get_trades\\\\(\\\\)` not .*'):\n        Trade.get_trades([])\n    Trade.use_db = True"
        ]
    },
    {
        "func_name": "test_get_overall_performance",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_get_overall_performance(fee):\n    create_mock_trades(fee, False)\n    res = Trade.get_overall_performance()\n    assert len(res) == 2\n    assert 'pair' in res[0]\n    assert 'profit' in res[0]\n    assert 'count' in res[0]",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_overall_performance(fee):\n    if False:\n        i = 10\n    create_mock_trades(fee, False)\n    res = Trade.get_overall_performance()\n    assert len(res) == 2\n    assert 'pair' in res[0]\n    assert 'profit' in res[0]\n    assert 'count' in res[0]",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_overall_performance(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    create_mock_trades(fee, False)\n    res = Trade.get_overall_performance()\n    assert len(res) == 2\n    assert 'pair' in res[0]\n    assert 'profit' in res[0]\n    assert 'count' in res[0]",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_overall_performance(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    create_mock_trades(fee, False)\n    res = Trade.get_overall_performance()\n    assert len(res) == 2\n    assert 'pair' in res[0]\n    assert 'profit' in res[0]\n    assert 'count' in res[0]",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_overall_performance(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    create_mock_trades(fee, False)\n    res = Trade.get_overall_performance()\n    assert len(res) == 2\n    assert 'pair' in res[0]\n    assert 'profit' in res[0]\n    assert 'count' in res[0]",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_overall_performance(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    create_mock_trades(fee, False)\n    res = Trade.get_overall_performance()\n    assert len(res) == 2\n    assert 'pair' in res[0]\n    assert 'profit' in res[0]\n    assert 'count' in res[0]"
        ]
    },
    {
        "func_name": "test_get_best_pair",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,pair,profit', [(True, 'ETC/BTC', -0.005), (False, 'XRP/BTC', 0.01), (None, 'XRP/BTC', 0.01)])\ndef test_get_best_pair(fee, is_short, pair, profit):\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades(fee, is_short)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == pair\n    assert res[1] == profit",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,pair,profit', [(True, 'ETC/BTC', -0.005), (False, 'XRP/BTC', 0.01), (None, 'XRP/BTC', 0.01)])\ndef test_get_best_pair(fee, is_short, pair, profit):\n    if False:\n        i = 10\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades(fee, is_short)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == pair\n    assert res[1] == profit",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,pair,profit', [(True, 'ETC/BTC', -0.005), (False, 'XRP/BTC', 0.01), (None, 'XRP/BTC', 0.01)])\ndef test_get_best_pair(fee, is_short, pair, profit):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades(fee, is_short)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == pair\n    assert res[1] == profit",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,pair,profit', [(True, 'ETC/BTC', -0.005), (False, 'XRP/BTC', 0.01), (None, 'XRP/BTC', 0.01)])\ndef test_get_best_pair(fee, is_short, pair, profit):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades(fee, is_short)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == pair\n    assert res[1] == profit",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,pair,profit', [(True, 'ETC/BTC', -0.005), (False, 'XRP/BTC', 0.01), (None, 'XRP/BTC', 0.01)])\ndef test_get_best_pair(fee, is_short, pair, profit):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades(fee, is_short)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == pair\n    assert res[1] == profit",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short,pair,profit', [(True, 'ETC/BTC', -0.005), (False, 'XRP/BTC', 0.01), (None, 'XRP/BTC', 0.01)])\ndef test_get_best_pair(fee, is_short, pair, profit):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades(fee, is_short)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == pair\n    assert res[1] == profit"
        ]
    },
    {
        "func_name": "test_get_best_pair_lev",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_get_best_pair_lev(fee):\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades_with_leverage(fee)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == 'DOGE/BTC'\n    assert res[1] == 0.1713156134055116",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_best_pair_lev(fee):\n    if False:\n        i = 10\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades_with_leverage(fee)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == 'DOGE/BTC'\n    assert res[1] == 0.1713156134055116",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_best_pair_lev(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades_with_leverage(fee)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == 'DOGE/BTC'\n    assert res[1] == 0.1713156134055116",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_best_pair_lev(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades_with_leverage(fee)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == 'DOGE/BTC'\n    assert res[1] == 0.1713156134055116",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_best_pair_lev(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades_with_leverage(fee)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == 'DOGE/BTC'\n    assert res[1] == 0.1713156134055116",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_get_best_pair_lev(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    res = Trade.get_best_pair()\n    assert res is None\n    create_mock_trades_with_leverage(fee)\n    res = Trade.get_best_pair()\n    assert len(res) == 2\n    assert res[0] == 'DOGE/BTC'\n    assert res[1] == 0.1713156134055116"
        ]
    },
    {
        "func_name": "test_get_canceled_exit_order_count",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_canceled_exit_order_count(fee, is_short):\n    create_mock_trades(fee, is_short=is_short)\n    trade = Trade.get_trades([Trade.pair == 'ETC/BTC']).first()\n    assert trade.get_canceled_exit_order_count() == 0\n    trade.orders[-1].status = 'canceled'\n    assert trade.get_canceled_exit_order_count() == 1",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_canceled_exit_order_count(fee, is_short):\n    if False:\n        i = 10\n    create_mock_trades(fee, is_short=is_short)\n    trade = Trade.get_trades([Trade.pair == 'ETC/BTC']).first()\n    assert trade.get_canceled_exit_order_count() == 0\n    trade.orders[-1].status = 'canceled'\n    assert trade.get_canceled_exit_order_count() == 1",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_canceled_exit_order_count(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    create_mock_trades(fee, is_short=is_short)\n    trade = Trade.get_trades([Trade.pair == 'ETC/BTC']).first()\n    assert trade.get_canceled_exit_order_count() == 0\n    trade.orders[-1].status = 'canceled'\n    assert trade.get_canceled_exit_order_count() == 1",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_canceled_exit_order_count(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    create_mock_trades(fee, is_short=is_short)\n    trade = Trade.get_trades([Trade.pair == 'ETC/BTC']).first()\n    assert trade.get_canceled_exit_order_count() == 0\n    trade.orders[-1].status = 'canceled'\n    assert trade.get_canceled_exit_order_count() == 1",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_canceled_exit_order_count(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    create_mock_trades(fee, is_short=is_short)\n    trade = Trade.get_trades([Trade.pair == 'ETC/BTC']).first()\n    assert trade.get_canceled_exit_order_count() == 0\n    trade.orders[-1].status = 'canceled'\n    assert trade.get_canceled_exit_order_count() == 1",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_get_canceled_exit_order_count(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    create_mock_trades(fee, is_short=is_short)\n    trade = Trade.get_trades([Trade.pair == 'ETC/BTC']).first()\n    assert trade.get_canceled_exit_order_count() == 0\n    trade.orders[-1].status = 'canceled'\n    assert trade.get_canceled_exit_order_count() == 1"
        ]
    },
    {
        "func_name": "test_update_order_from_ccxt",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_update_order_from_ccxt(caplog, time_machine):\n    start = datetime(2023, 1, 1, 4, tzinfo=timezone.utc)\n    time_machine.move_to(start, tick=False)\n    o = Order.parse_from_ccxt_object({'id': '1234'}, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.ft_is_open\n    ccxt_order = {'id': '1234', 'side': 'buy', 'symbol': 'ADA/USDT', 'type': 'limit', 'price': 1234.5, 'amount': 20.0, 'filled': 9, 'remaining': 11, 'status': 'open', 'timestamp': 1599394315123}\n    o = Order.parse_from_ccxt_object(ccxt_order, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.order_type == 'limit'\n    assert o.price == 1234.5\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.filled == 9\n    assert o.remaining == 11\n    assert o.order_date is not None\n    assert o.ft_is_open\n    assert o.order_filled_date is None\n    ccxt_order.update({'filled': None, 'remaining': 20.0, 'status': 'canceled'})\n    o.update_from_ccxt_object(ccxt_order)\n    ccxt_order.update({'filled': 20.0, 'remaining': 0.0, 'status': 'closed'})\n    o.update_from_ccxt_object(ccxt_order)\n    assert o.filled == 20.0\n    assert o.remaining == 0.0\n    assert not o.ft_is_open\n    assert o.order_filled_date == start\n    time_machine.move_to(start + timedelta(hours=1), tick=False)\n    ccxt_order.update({'id': 'somethingelse'})\n    with pytest.raises(DependencyException, match=\"Order-id's don't match\"):\n        o.update_from_ccxt_object(ccxt_order)\n    message = 'aaaa is not a valid response object.'\n    assert not log_has(message, caplog)\n    Order.update_orders([o], 'aaaa')\n    assert log_has(message, caplog)\n    Order.update_orders([o], {'id': '1234'})\n    assert o.order_filled_date == start\n    ccxt_order.update({'id': '1234'})\n    Order.update_orders([o], ccxt_order)\n    assert o.order_filled_date == start",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_order_from_ccxt(caplog, time_machine):\n    if False:\n        i = 10\n    start = datetime(2023, 1, 1, 4, tzinfo=timezone.utc)\n    time_machine.move_to(start, tick=False)\n    o = Order.parse_from_ccxt_object({'id': '1234'}, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.ft_is_open\n    ccxt_order = {'id': '1234', 'side': 'buy', 'symbol': 'ADA/USDT', 'type': 'limit', 'price': 1234.5, 'amount': 20.0, 'filled': 9, 'remaining': 11, 'status': 'open', 'timestamp': 1599394315123}\n    o = Order.parse_from_ccxt_object(ccxt_order, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.order_type == 'limit'\n    assert o.price == 1234.5\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.filled == 9\n    assert o.remaining == 11\n    assert o.order_date is not None\n    assert o.ft_is_open\n    assert o.order_filled_date is None\n    ccxt_order.update({'filled': None, 'remaining': 20.0, 'status': 'canceled'})\n    o.update_from_ccxt_object(ccxt_order)\n    ccxt_order.update({'filled': 20.0, 'remaining': 0.0, 'status': 'closed'})\n    o.update_from_ccxt_object(ccxt_order)\n    assert o.filled == 20.0\n    assert o.remaining == 0.0\n    assert not o.ft_is_open\n    assert o.order_filled_date == start\n    time_machine.move_to(start + timedelta(hours=1), tick=False)\n    ccxt_order.update({'id': 'somethingelse'})\n    with pytest.raises(DependencyException, match=\"Order-id's don't match\"):\n        o.update_from_ccxt_object(ccxt_order)\n    message = 'aaaa is not a valid response object.'\n    assert not log_has(message, caplog)\n    Order.update_orders([o], 'aaaa')\n    assert log_has(message, caplog)\n    Order.update_orders([o], {'id': '1234'})\n    assert o.order_filled_date == start\n    ccxt_order.update({'id': '1234'})\n    Order.update_orders([o], ccxt_order)\n    assert o.order_filled_date == start",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_order_from_ccxt(caplog, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    start = datetime(2023, 1, 1, 4, tzinfo=timezone.utc)\n    time_machine.move_to(start, tick=False)\n    o = Order.parse_from_ccxt_object({'id': '1234'}, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.ft_is_open\n    ccxt_order = {'id': '1234', 'side': 'buy', 'symbol': 'ADA/USDT', 'type': 'limit', 'price': 1234.5, 'amount': 20.0, 'filled': 9, 'remaining': 11, 'status': 'open', 'timestamp': 1599394315123}\n    o = Order.parse_from_ccxt_object(ccxt_order, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.order_type == 'limit'\n    assert o.price == 1234.5\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.filled == 9\n    assert o.remaining == 11\n    assert o.order_date is not None\n    assert o.ft_is_open\n    assert o.order_filled_date is None\n    ccxt_order.update({'filled': None, 'remaining': 20.0, 'status': 'canceled'})\n    o.update_from_ccxt_object(ccxt_order)\n    ccxt_order.update({'filled': 20.0, 'remaining': 0.0, 'status': 'closed'})\n    o.update_from_ccxt_object(ccxt_order)\n    assert o.filled == 20.0\n    assert o.remaining == 0.0\n    assert not o.ft_is_open\n    assert o.order_filled_date == start\n    time_machine.move_to(start + timedelta(hours=1), tick=False)\n    ccxt_order.update({'id': 'somethingelse'})\n    with pytest.raises(DependencyException, match=\"Order-id's don't match\"):\n        o.update_from_ccxt_object(ccxt_order)\n    message = 'aaaa is not a valid response object.'\n    assert not log_has(message, caplog)\n    Order.update_orders([o], 'aaaa')\n    assert log_has(message, caplog)\n    Order.update_orders([o], {'id': '1234'})\n    assert o.order_filled_date == start\n    ccxt_order.update({'id': '1234'})\n    Order.update_orders([o], ccxt_order)\n    assert o.order_filled_date == start",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_order_from_ccxt(caplog, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    start = datetime(2023, 1, 1, 4, tzinfo=timezone.utc)\n    time_machine.move_to(start, tick=False)\n    o = Order.parse_from_ccxt_object({'id': '1234'}, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.ft_is_open\n    ccxt_order = {'id': '1234', 'side': 'buy', 'symbol': 'ADA/USDT', 'type': 'limit', 'price': 1234.5, 'amount': 20.0, 'filled': 9, 'remaining': 11, 'status': 'open', 'timestamp': 1599394315123}\n    o = Order.parse_from_ccxt_object(ccxt_order, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.order_type == 'limit'\n    assert o.price == 1234.5\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.filled == 9\n    assert o.remaining == 11\n    assert o.order_date is not None\n    assert o.ft_is_open\n    assert o.order_filled_date is None\n    ccxt_order.update({'filled': None, 'remaining': 20.0, 'status': 'canceled'})\n    o.update_from_ccxt_object(ccxt_order)\n    ccxt_order.update({'filled': 20.0, 'remaining': 0.0, 'status': 'closed'})\n    o.update_from_ccxt_object(ccxt_order)\n    assert o.filled == 20.0\n    assert o.remaining == 0.0\n    assert not o.ft_is_open\n    assert o.order_filled_date == start\n    time_machine.move_to(start + timedelta(hours=1), tick=False)\n    ccxt_order.update({'id': 'somethingelse'})\n    with pytest.raises(DependencyException, match=\"Order-id's don't match\"):\n        o.update_from_ccxt_object(ccxt_order)\n    message = 'aaaa is not a valid response object.'\n    assert not log_has(message, caplog)\n    Order.update_orders([o], 'aaaa')\n    assert log_has(message, caplog)\n    Order.update_orders([o], {'id': '1234'})\n    assert o.order_filled_date == start\n    ccxt_order.update({'id': '1234'})\n    Order.update_orders([o], ccxt_order)\n    assert o.order_filled_date == start",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_order_from_ccxt(caplog, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    start = datetime(2023, 1, 1, 4, tzinfo=timezone.utc)\n    time_machine.move_to(start, tick=False)\n    o = Order.parse_from_ccxt_object({'id': '1234'}, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.ft_is_open\n    ccxt_order = {'id': '1234', 'side': 'buy', 'symbol': 'ADA/USDT', 'type': 'limit', 'price': 1234.5, 'amount': 20.0, 'filled': 9, 'remaining': 11, 'status': 'open', 'timestamp': 1599394315123}\n    o = Order.parse_from_ccxt_object(ccxt_order, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.order_type == 'limit'\n    assert o.price == 1234.5\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.filled == 9\n    assert o.remaining == 11\n    assert o.order_date is not None\n    assert o.ft_is_open\n    assert o.order_filled_date is None\n    ccxt_order.update({'filled': None, 'remaining': 20.0, 'status': 'canceled'})\n    o.update_from_ccxt_object(ccxt_order)\n    ccxt_order.update({'filled': 20.0, 'remaining': 0.0, 'status': 'closed'})\n    o.update_from_ccxt_object(ccxt_order)\n    assert o.filled == 20.0\n    assert o.remaining == 0.0\n    assert not o.ft_is_open\n    assert o.order_filled_date == start\n    time_machine.move_to(start + timedelta(hours=1), tick=False)\n    ccxt_order.update({'id': 'somethingelse'})\n    with pytest.raises(DependencyException, match=\"Order-id's don't match\"):\n        o.update_from_ccxt_object(ccxt_order)\n    message = 'aaaa is not a valid response object.'\n    assert not log_has(message, caplog)\n    Order.update_orders([o], 'aaaa')\n    assert log_has(message, caplog)\n    Order.update_orders([o], {'id': '1234'})\n    assert o.order_filled_date == start\n    ccxt_order.update({'id': '1234'})\n    Order.update_orders([o], ccxt_order)\n    assert o.order_filled_date == start",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_update_order_from_ccxt(caplog, time_machine):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    start = datetime(2023, 1, 1, 4, tzinfo=timezone.utc)\n    time_machine.move_to(start, tick=False)\n    o = Order.parse_from_ccxt_object({'id': '1234'}, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.ft_is_open\n    ccxt_order = {'id': '1234', 'side': 'buy', 'symbol': 'ADA/USDT', 'type': 'limit', 'price': 1234.5, 'amount': 20.0, 'filled': 9, 'remaining': 11, 'status': 'open', 'timestamp': 1599394315123}\n    o = Order.parse_from_ccxt_object(ccxt_order, 'ADA/USDT', 'buy', 20.01, 1234.6)\n    assert isinstance(o, Order)\n    assert o.ft_pair == 'ADA/USDT'\n    assert o.ft_order_side == 'buy'\n    assert o.order_id == '1234'\n    assert o.order_type == 'limit'\n    assert o.price == 1234.5\n    assert o.ft_price == 1234.6\n    assert o.ft_amount == 20.01\n    assert o.filled == 9\n    assert o.remaining == 11\n    assert o.order_date is not None\n    assert o.ft_is_open\n    assert o.order_filled_date is None\n    ccxt_order.update({'filled': None, 'remaining': 20.0, 'status': 'canceled'})\n    o.update_from_ccxt_object(ccxt_order)\n    ccxt_order.update({'filled': 20.0, 'remaining': 0.0, 'status': 'closed'})\n    o.update_from_ccxt_object(ccxt_order)\n    assert o.filled == 20.0\n    assert o.remaining == 0.0\n    assert not o.ft_is_open\n    assert o.order_filled_date == start\n    time_machine.move_to(start + timedelta(hours=1), tick=False)\n    ccxt_order.update({'id': 'somethingelse'})\n    with pytest.raises(DependencyException, match=\"Order-id's don't match\"):\n        o.update_from_ccxt_object(ccxt_order)\n    message = 'aaaa is not a valid response object.'\n    assert not log_has(message, caplog)\n    Order.update_orders([o], 'aaaa')\n    assert log_has(message, caplog)\n    Order.update_orders([o], {'id': '1234'})\n    assert o.order_filled_date == start\n    ccxt_order.update({'id': '1234'})\n    Order.update_orders([o], ccxt_order)\n    assert o.order_filled_date == start"
        ]
    },
    {
        "func_name": "test_select_order",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_select_order(fee, is_short):\n    create_mock_trades(fee, is_short)\n    trades = Trade.get_trades().all()\n    order = trades[0].select_order(trades[0].entry_side, True)\n    assert order is not None\n    order = trades[0].select_order(trades[0].entry_side, False)\n    assert order is None\n    order = trades[0].select_order(trades[0].exit_side, None)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, False)\n    assert order is not None\n    order = trades[1].select_order(trades[1].entry_side, None)\n    assert order is not None\n    order = trades[1].select_order(trades[1].exit_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].exit_side, False)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, True)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, False)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, True)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, False)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = trades[4].exit_side\n    order = trades[4].select_order(trades[4].exit_side, True)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = 'stoploss'\n    order = trades[4].select_order('stoploss', None)\n    assert order is not None\n    assert order.ft_order_side == 'stoploss'",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_select_order(fee, is_short):\n    if False:\n        i = 10\n    create_mock_trades(fee, is_short)\n    trades = Trade.get_trades().all()\n    order = trades[0].select_order(trades[0].entry_side, True)\n    assert order is not None\n    order = trades[0].select_order(trades[0].entry_side, False)\n    assert order is None\n    order = trades[0].select_order(trades[0].exit_side, None)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, False)\n    assert order is not None\n    order = trades[1].select_order(trades[1].entry_side, None)\n    assert order is not None\n    order = trades[1].select_order(trades[1].exit_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].exit_side, False)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, True)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, False)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, True)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, False)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = trades[4].exit_side\n    order = trades[4].select_order(trades[4].exit_side, True)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = 'stoploss'\n    order = trades[4].select_order('stoploss', None)\n    assert order is not None\n    assert order.ft_order_side == 'stoploss'",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_select_order(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    create_mock_trades(fee, is_short)\n    trades = Trade.get_trades().all()\n    order = trades[0].select_order(trades[0].entry_side, True)\n    assert order is not None\n    order = trades[0].select_order(trades[0].entry_side, False)\n    assert order is None\n    order = trades[0].select_order(trades[0].exit_side, None)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, False)\n    assert order is not None\n    order = trades[1].select_order(trades[1].entry_side, None)\n    assert order is not None\n    order = trades[1].select_order(trades[1].exit_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].exit_side, False)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, True)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, False)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, True)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, False)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = trades[4].exit_side\n    order = trades[4].select_order(trades[4].exit_side, True)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = 'stoploss'\n    order = trades[4].select_order('stoploss', None)\n    assert order is not None\n    assert order.ft_order_side == 'stoploss'",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_select_order(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    create_mock_trades(fee, is_short)\n    trades = Trade.get_trades().all()\n    order = trades[0].select_order(trades[0].entry_side, True)\n    assert order is not None\n    order = trades[0].select_order(trades[0].entry_side, False)\n    assert order is None\n    order = trades[0].select_order(trades[0].exit_side, None)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, False)\n    assert order is not None\n    order = trades[1].select_order(trades[1].entry_side, None)\n    assert order is not None\n    order = trades[1].select_order(trades[1].exit_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].exit_side, False)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, True)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, False)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, True)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, False)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = trades[4].exit_side\n    order = trades[4].select_order(trades[4].exit_side, True)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = 'stoploss'\n    order = trades[4].select_order('stoploss', None)\n    assert order is not None\n    assert order.ft_order_side == 'stoploss'",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_select_order(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    create_mock_trades(fee, is_short)\n    trades = Trade.get_trades().all()\n    order = trades[0].select_order(trades[0].entry_side, True)\n    assert order is not None\n    order = trades[0].select_order(trades[0].entry_side, False)\n    assert order is None\n    order = trades[0].select_order(trades[0].exit_side, None)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, False)\n    assert order is not None\n    order = trades[1].select_order(trades[1].entry_side, None)\n    assert order is not None\n    order = trades[1].select_order(trades[1].exit_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].exit_side, False)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, True)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, False)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, True)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, False)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = trades[4].exit_side\n    order = trades[4].select_order(trades[4].exit_side, True)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = 'stoploss'\n    order = trades[4].select_order('stoploss', None)\n    assert order is not None\n    assert order.ft_order_side == 'stoploss'",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('is_short', [True, False])\ndef test_select_order(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    create_mock_trades(fee, is_short)\n    trades = Trade.get_trades().all()\n    order = trades[0].select_order(trades[0].entry_side, True)\n    assert order is not None\n    order = trades[0].select_order(trades[0].entry_side, False)\n    assert order is None\n    order = trades[0].select_order(trades[0].exit_side, None)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].entry_side, False)\n    assert order is not None\n    order = trades[1].select_order(trades[1].entry_side, None)\n    assert order is not None\n    order = trades[1].select_order(trades[1].exit_side, True)\n    assert order is None\n    order = trades[1].select_order(trades[1].exit_side, False)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, True)\n    assert order is not None\n    order = trades[3].select_order(trades[3].entry_side, False)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, True)\n    assert order is None\n    order = trades[4].select_order(trades[4].entry_side, False)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = trades[4].exit_side\n    order = trades[4].select_order(trades[4].exit_side, True)\n    assert order is not None\n    trades[4].orders[1].ft_order_side = 'stoploss'\n    order = trades[4].select_order('stoploss', None)\n    assert order is not None\n    assert order.ft_order_side == 'stoploss'"
        ]
    },
    {
        "func_name": "test_Trade_object_idem",
        "original": "def test_Trade_object_idem():\n    assert issubclass(Trade, LocalTrade)\n    trade = vars(Trade)\n    localtrade = vars(LocalTrade)\n    excludes = ('delete', 'session', 'commit', 'rollback', 'query', 'open_date', 'get_best_pair', 'get_overall_performance', 'get_total_closed_profit', 'total_open_trades_stakes', 'get_closed_trades_without_assigned_fees', 'get_open_trades_without_assigned_fees', 'get_trades', 'get_trades_query', 'get_exit_reason_performance', 'get_enter_tag_performance', 'get_mix_tag_performance', 'get_trading_volume', 'validate_string_len')\n    EXCLUDES2 = ('trades', 'trades_open', 'bt_trades_open_pp', 'bt_open_open_trade_count', 'total_profit', 'from_json')\n    for item in trade:\n        if not item.startswith('_') and item not in excludes:\n            assert item in localtrade\n    for item in localtrade:\n        if not item.startswith('__') and item not in EXCLUDES2 and (type(getattr(LocalTrade, item)) not in (property, FunctionType)):\n            assert item in trade",
        "mutated": [
            "def test_Trade_object_idem():\n    if False:\n        i = 10\n    assert issubclass(Trade, LocalTrade)\n    trade = vars(Trade)\n    localtrade = vars(LocalTrade)\n    excludes = ('delete', 'session', 'commit', 'rollback', 'query', 'open_date', 'get_best_pair', 'get_overall_performance', 'get_total_closed_profit', 'total_open_trades_stakes', 'get_closed_trades_without_assigned_fees', 'get_open_trades_without_assigned_fees', 'get_trades', 'get_trades_query', 'get_exit_reason_performance', 'get_enter_tag_performance', 'get_mix_tag_performance', 'get_trading_volume', 'validate_string_len')\n    EXCLUDES2 = ('trades', 'trades_open', 'bt_trades_open_pp', 'bt_open_open_trade_count', 'total_profit', 'from_json')\n    for item in trade:\n        if not item.startswith('_') and item not in excludes:\n            assert item in localtrade\n    for item in localtrade:\n        if not item.startswith('__') and item not in EXCLUDES2 and (type(getattr(LocalTrade, item)) not in (property, FunctionType)):\n            assert item in trade",
            "def test_Trade_object_idem():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    assert issubclass(Trade, LocalTrade)\n    trade = vars(Trade)\n    localtrade = vars(LocalTrade)\n    excludes = ('delete', 'session', 'commit', 'rollback', 'query', 'open_date', 'get_best_pair', 'get_overall_performance', 'get_total_closed_profit', 'total_open_trades_stakes', 'get_closed_trades_without_assigned_fees', 'get_open_trades_without_assigned_fees', 'get_trades', 'get_trades_query', 'get_exit_reason_performance', 'get_enter_tag_performance', 'get_mix_tag_performance', 'get_trading_volume', 'validate_string_len')\n    EXCLUDES2 = ('trades', 'trades_open', 'bt_trades_open_pp', 'bt_open_open_trade_count', 'total_profit', 'from_json')\n    for item in trade:\n        if not item.startswith('_') and item not in excludes:\n            assert item in localtrade\n    for item in localtrade:\n        if not item.startswith('__') and item not in EXCLUDES2 and (type(getattr(LocalTrade, item)) not in (property, FunctionType)):\n            assert item in trade",
            "def test_Trade_object_idem():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    assert issubclass(Trade, LocalTrade)\n    trade = vars(Trade)\n    localtrade = vars(LocalTrade)\n    excludes = ('delete', 'session', 'commit', 'rollback', 'query', 'open_date', 'get_best_pair', 'get_overall_performance', 'get_total_closed_profit', 'total_open_trades_stakes', 'get_closed_trades_without_assigned_fees', 'get_open_trades_without_assigned_fees', 'get_trades', 'get_trades_query', 'get_exit_reason_performance', 'get_enter_tag_performance', 'get_mix_tag_performance', 'get_trading_volume', 'validate_string_len')\n    EXCLUDES2 = ('trades', 'trades_open', 'bt_trades_open_pp', 'bt_open_open_trade_count', 'total_profit', 'from_json')\n    for item in trade:\n        if not item.startswith('_') and item not in excludes:\n            assert item in localtrade\n    for item in localtrade:\n        if not item.startswith('__') and item not in EXCLUDES2 and (type(getattr(LocalTrade, item)) not in (property, FunctionType)):\n            assert item in trade",
            "def test_Trade_object_idem():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    assert issubclass(Trade, LocalTrade)\n    trade = vars(Trade)\n    localtrade = vars(LocalTrade)\n    excludes = ('delete', 'session', 'commit', 'rollback', 'query', 'open_date', 'get_best_pair', 'get_overall_performance', 'get_total_closed_profit', 'total_open_trades_stakes', 'get_closed_trades_without_assigned_fees', 'get_open_trades_without_assigned_fees', 'get_trades', 'get_trades_query', 'get_exit_reason_performance', 'get_enter_tag_performance', 'get_mix_tag_performance', 'get_trading_volume', 'validate_string_len')\n    EXCLUDES2 = ('trades', 'trades_open', 'bt_trades_open_pp', 'bt_open_open_trade_count', 'total_profit', 'from_json')\n    for item in trade:\n        if not item.startswith('_') and item not in excludes:\n            assert item in localtrade\n    for item in localtrade:\n        if not item.startswith('__') and item not in EXCLUDES2 and (type(getattr(LocalTrade, item)) not in (property, FunctionType)):\n            assert item in trade",
            "def test_Trade_object_idem():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    assert issubclass(Trade, LocalTrade)\n    trade = vars(Trade)\n    localtrade = vars(LocalTrade)\n    excludes = ('delete', 'session', 'commit', 'rollback', 'query', 'open_date', 'get_best_pair', 'get_overall_performance', 'get_total_closed_profit', 'total_open_trades_stakes', 'get_closed_trades_without_assigned_fees', 'get_open_trades_without_assigned_fees', 'get_trades', 'get_trades_query', 'get_exit_reason_performance', 'get_enter_tag_performance', 'get_mix_tag_performance', 'get_trading_volume', 'validate_string_len')\n    EXCLUDES2 = ('trades', 'trades_open', 'bt_trades_open_pp', 'bt_open_open_trade_count', 'total_profit', 'from_json')\n    for item in trade:\n        if not item.startswith('_') and item not in excludes:\n            assert item in localtrade\n    for item in localtrade:\n        if not item.startswith('__') and item not in EXCLUDES2 and (type(getattr(LocalTrade, item)) not in (property, FunctionType)):\n            assert item in trade"
        ]
    },
    {
        "func_name": "test_trade_truncates_string_fields",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_truncates_string_fields():\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=20), fee_open=0.001, fee_close=0.001, exchange='binance', leverage=1.0, trading_mode='futures', enter_tag='a' * CUSTOM_TAG_MAX_LENGTH * 2, exit_reason='b' * CUSTOM_TAG_MAX_LENGTH * 2)\n    Trade.session.add(trade)\n    Trade.commit()\n    trade1 = Trade.session.scalars(select(Trade)).first()\n    assert trade1.enter_tag == 'a' * CUSTOM_TAG_MAX_LENGTH\n    assert trade1.exit_reason == 'b' * CUSTOM_TAG_MAX_LENGTH",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_truncates_string_fields():\n    if False:\n        i = 10\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=20), fee_open=0.001, fee_close=0.001, exchange='binance', leverage=1.0, trading_mode='futures', enter_tag='a' * CUSTOM_TAG_MAX_LENGTH * 2, exit_reason='b' * CUSTOM_TAG_MAX_LENGTH * 2)\n    Trade.session.add(trade)\n    Trade.commit()\n    trade1 = Trade.session.scalars(select(Trade)).first()\n    assert trade1.enter_tag == 'a' * CUSTOM_TAG_MAX_LENGTH\n    assert trade1.exit_reason == 'b' * CUSTOM_TAG_MAX_LENGTH",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_truncates_string_fields():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=20), fee_open=0.001, fee_close=0.001, exchange='binance', leverage=1.0, trading_mode='futures', enter_tag='a' * CUSTOM_TAG_MAX_LENGTH * 2, exit_reason='b' * CUSTOM_TAG_MAX_LENGTH * 2)\n    Trade.session.add(trade)\n    Trade.commit()\n    trade1 = Trade.session.scalars(select(Trade)).first()\n    assert trade1.enter_tag == 'a' * CUSTOM_TAG_MAX_LENGTH\n    assert trade1.exit_reason == 'b' * CUSTOM_TAG_MAX_LENGTH",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_truncates_string_fields():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=20), fee_open=0.001, fee_close=0.001, exchange='binance', leverage=1.0, trading_mode='futures', enter_tag='a' * CUSTOM_TAG_MAX_LENGTH * 2, exit_reason='b' * CUSTOM_TAG_MAX_LENGTH * 2)\n    Trade.session.add(trade)\n    Trade.commit()\n    trade1 = Trade.session.scalars(select(Trade)).first()\n    assert trade1.enter_tag == 'a' * CUSTOM_TAG_MAX_LENGTH\n    assert trade1.exit_reason == 'b' * CUSTOM_TAG_MAX_LENGTH",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_truncates_string_fields():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=20), fee_open=0.001, fee_close=0.001, exchange='binance', leverage=1.0, trading_mode='futures', enter_tag='a' * CUSTOM_TAG_MAX_LENGTH * 2, exit_reason='b' * CUSTOM_TAG_MAX_LENGTH * 2)\n    Trade.session.add(trade)\n    Trade.commit()\n    trade1 = Trade.session.scalars(select(Trade)).first()\n    assert trade1.enter_tag == 'a' * CUSTOM_TAG_MAX_LENGTH\n    assert trade1.exit_reason == 'b' * CUSTOM_TAG_MAX_LENGTH",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_trade_truncates_string_fields():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    trade = Trade(pair='ADA/USDT', stake_amount=20.0, amount=30.0, open_rate=2.0, open_date=datetime.now(timezone.utc) - timedelta(minutes=20), fee_open=0.001, fee_close=0.001, exchange='binance', leverage=1.0, trading_mode='futures', enter_tag='a' * CUSTOM_TAG_MAX_LENGTH * 2, exit_reason='b' * CUSTOM_TAG_MAX_LENGTH * 2)\n    Trade.session.add(trade)\n    Trade.commit()\n    trade1 = Trade.session.scalars(select(Trade)).first()\n    assert trade1.enter_tag == 'a' * CUSTOM_TAG_MAX_LENGTH\n    assert trade1.exit_reason == 'b' * CUSTOM_TAG_MAX_LENGTH"
        ]
    },
    {
        "func_name": "test_recalc_trade_from_orders",
        "original": "def test_recalc_trade_from_orders(fee):\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost + o1_fee_cost\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    assert fee.return_value == 0.0025\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == o1_trade_val\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, 'buy')\n    assert len(trade.orders) == 0\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    o2_amount = 125\n    o2_rate = 0.9\n    o2_cost = o2_amount * o2_rate\n    o2_fee_cost = o2_cost * fee.return_value\n    o2_trade_val = o2_cost + o2_fee_cost\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost) / (o1_amount + o2_amount)\n    assert trade.amount == o1_amount + o2_amount\n    assert trade.stake_amount == o1_amount + o2_cost\n    assert trade.open_rate == avg_price\n    assert trade.fee_open_cost == o1_fee_cost + o2_fee_cost\n    assert trade.open_trade_value == o1_trade_val + o2_trade_val\n    o3_amount = 150\n    o3_rate = 0.85\n    o3_cost = o3_amount * o3_rate\n    o3_fee_cost = o3_cost * fee.return_value\n    o3_trade_val = o3_cost + o3_fee_cost\n    order3 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o3_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost + o3_cost) / (o1_amount + o2_amount + o3_amount)\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val\n    sell1 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=avg_price + 0.95, average=avg_price + 0.95, filled=o1_amount + o2_amount + o3_amount, remaining=0, cost=o1_cost + o2_cost + o3_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val",
        "mutated": [
            "def test_recalc_trade_from_orders(fee):\n    if False:\n        i = 10\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost + o1_fee_cost\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    assert fee.return_value == 0.0025\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == o1_trade_val\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, 'buy')\n    assert len(trade.orders) == 0\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    o2_amount = 125\n    o2_rate = 0.9\n    o2_cost = o2_amount * o2_rate\n    o2_fee_cost = o2_cost * fee.return_value\n    o2_trade_val = o2_cost + o2_fee_cost\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost) / (o1_amount + o2_amount)\n    assert trade.amount == o1_amount + o2_amount\n    assert trade.stake_amount == o1_amount + o2_cost\n    assert trade.open_rate == avg_price\n    assert trade.fee_open_cost == o1_fee_cost + o2_fee_cost\n    assert trade.open_trade_value == o1_trade_val + o2_trade_val\n    o3_amount = 150\n    o3_rate = 0.85\n    o3_cost = o3_amount * o3_rate\n    o3_fee_cost = o3_cost * fee.return_value\n    o3_trade_val = o3_cost + o3_fee_cost\n    order3 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o3_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost + o3_cost) / (o1_amount + o2_amount + o3_amount)\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val\n    sell1 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=avg_price + 0.95, average=avg_price + 0.95, filled=o1_amount + o2_amount + o3_amount, remaining=0, cost=o1_cost + o2_cost + o3_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val",
            "def test_recalc_trade_from_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost + o1_fee_cost\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    assert fee.return_value == 0.0025\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == o1_trade_val\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, 'buy')\n    assert len(trade.orders) == 0\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    o2_amount = 125\n    o2_rate = 0.9\n    o2_cost = o2_amount * o2_rate\n    o2_fee_cost = o2_cost * fee.return_value\n    o2_trade_val = o2_cost + o2_fee_cost\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost) / (o1_amount + o2_amount)\n    assert trade.amount == o1_amount + o2_amount\n    assert trade.stake_amount == o1_amount + o2_cost\n    assert trade.open_rate == avg_price\n    assert trade.fee_open_cost == o1_fee_cost + o2_fee_cost\n    assert trade.open_trade_value == o1_trade_val + o2_trade_val\n    o3_amount = 150\n    o3_rate = 0.85\n    o3_cost = o3_amount * o3_rate\n    o3_fee_cost = o3_cost * fee.return_value\n    o3_trade_val = o3_cost + o3_fee_cost\n    order3 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o3_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost + o3_cost) / (o1_amount + o2_amount + o3_amount)\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val\n    sell1 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=avg_price + 0.95, average=avg_price + 0.95, filled=o1_amount + o2_amount + o3_amount, remaining=0, cost=o1_cost + o2_cost + o3_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val",
            "def test_recalc_trade_from_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost + o1_fee_cost\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    assert fee.return_value == 0.0025\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == o1_trade_val\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, 'buy')\n    assert len(trade.orders) == 0\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    o2_amount = 125\n    o2_rate = 0.9\n    o2_cost = o2_amount * o2_rate\n    o2_fee_cost = o2_cost * fee.return_value\n    o2_trade_val = o2_cost + o2_fee_cost\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost) / (o1_amount + o2_amount)\n    assert trade.amount == o1_amount + o2_amount\n    assert trade.stake_amount == o1_amount + o2_cost\n    assert trade.open_rate == avg_price\n    assert trade.fee_open_cost == o1_fee_cost + o2_fee_cost\n    assert trade.open_trade_value == o1_trade_val + o2_trade_val\n    o3_amount = 150\n    o3_rate = 0.85\n    o3_cost = o3_amount * o3_rate\n    o3_fee_cost = o3_cost * fee.return_value\n    o3_trade_val = o3_cost + o3_fee_cost\n    order3 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o3_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost + o3_cost) / (o1_amount + o2_amount + o3_amount)\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val\n    sell1 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=avg_price + 0.95, average=avg_price + 0.95, filled=o1_amount + o2_amount + o3_amount, remaining=0, cost=o1_cost + o2_cost + o3_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val",
            "def test_recalc_trade_from_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost + o1_fee_cost\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    assert fee.return_value == 0.0025\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == o1_trade_val\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, 'buy')\n    assert len(trade.orders) == 0\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    o2_amount = 125\n    o2_rate = 0.9\n    o2_cost = o2_amount * o2_rate\n    o2_fee_cost = o2_cost * fee.return_value\n    o2_trade_val = o2_cost + o2_fee_cost\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost) / (o1_amount + o2_amount)\n    assert trade.amount == o1_amount + o2_amount\n    assert trade.stake_amount == o1_amount + o2_cost\n    assert trade.open_rate == avg_price\n    assert trade.fee_open_cost == o1_fee_cost + o2_fee_cost\n    assert trade.open_trade_value == o1_trade_val + o2_trade_val\n    o3_amount = 150\n    o3_rate = 0.85\n    o3_cost = o3_amount * o3_rate\n    o3_fee_cost = o3_cost * fee.return_value\n    o3_trade_val = o3_cost + o3_fee_cost\n    order3 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o3_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost + o3_cost) / (o1_amount + o2_amount + o3_amount)\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val\n    sell1 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=avg_price + 0.95, average=avg_price + 0.95, filled=o1_amount + o2_amount + o3_amount, remaining=0, cost=o1_cost + o2_cost + o3_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val",
            "def test_recalc_trade_from_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost + o1_fee_cost\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    assert fee.return_value == 0.0025\n    assert trade._calc_open_trade_value(trade.amount, trade.open_rate) == o1_trade_val\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_cost\n    assert trade.open_rate == o1_rate\n    assert trade.open_trade_value == o1_trade_val\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, 'buy')\n    assert len(trade.orders) == 0\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    o2_amount = 125\n    o2_rate = 0.9\n    o2_cost = o2_amount * o2_rate\n    o2_fee_cost = o2_cost * fee.return_value\n    o2_trade_val = o2_cost + o2_fee_cost\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost) / (o1_amount + o2_amount)\n    assert trade.amount == o1_amount + o2_amount\n    assert trade.stake_amount == o1_amount + o2_cost\n    assert trade.open_rate == avg_price\n    assert trade.fee_open_cost == o1_fee_cost + o2_fee_cost\n    assert trade.open_trade_value == o1_trade_val + o2_trade_val\n    o3_amount = 150\n    o3_rate = 0.85\n    o3_cost = o3_amount * o3_rate\n    o3_fee_cost = o3_cost * fee.return_value\n    o3_trade_val = o3_cost + o3_fee_cost\n    order3 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o3_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    avg_price = (o1_cost + o2_cost + o3_cost) / (o1_amount + o2_amount + o3_amount)\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val\n    sell1 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=avg_price + 0.95, average=avg_price + 0.95, filled=o1_amount + o2_amount + o3_amount, remaining=0, cost=o1_cost + o2_cost + o3_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount + o3_amount\n    assert trade.stake_amount == o1_cost + o2_cost + o3_cost\n    assert trade.open_rate == avg_price\n    assert pytest.approx(trade.fee_open_cost) == o1_fee_cost + o2_fee_cost + o3_fee_cost\n    assert pytest.approx(trade.open_trade_value) == o1_trade_val + o2_trade_val + o3_trade_val"
        ]
    },
    {
        "func_name": "test_recalc_trade_from_orders_kucoin",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_recalc_trade_from_orders_kucoin():\n    o1_amount = 11511963.86344489\n    o2_amount = 11750101.774393778\n    o3_amount = 23262065.63783866\n    res = o1_amount + o2_amount - o3_amount\n    assert res > 0.0\n    assert res < 0.1\n    o1_rate = 2.9901e-05\n    o2_rate = 2.9295e-05\n    o3_rate = 2.9822e-05\n    o1_cost = o1_amount * o1_rate\n    trade = Trade(pair='FLOKI/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=0.001, fee_close=0.001, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount\n    profit = trade.calculate_profit(o3_rate)\n    assert profit.profit_abs == pytest.approx(3.90069871)\n    assert profit.profit_ratio == pytest.approx(0.00566035)\n    order3 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order3)\n    trade.update_trade(order3)\n    assert trade.is_open is False\n    assert trade.amount == 8e-09\n    assert trade.close_profit_abs == 3.90069871\n    assert trade.close_profit == 0.00566035",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_recalc_trade_from_orders_kucoin():\n    if False:\n        i = 10\n    o1_amount = 11511963.86344489\n    o2_amount = 11750101.774393778\n    o3_amount = 23262065.63783866\n    res = o1_amount + o2_amount - o3_amount\n    assert res > 0.0\n    assert res < 0.1\n    o1_rate = 2.9901e-05\n    o2_rate = 2.9295e-05\n    o3_rate = 2.9822e-05\n    o1_cost = o1_amount * o1_rate\n    trade = Trade(pair='FLOKI/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=0.001, fee_close=0.001, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount\n    profit = trade.calculate_profit(o3_rate)\n    assert profit.profit_abs == pytest.approx(3.90069871)\n    assert profit.profit_ratio == pytest.approx(0.00566035)\n    order3 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order3)\n    trade.update_trade(order3)\n    assert trade.is_open is False\n    assert trade.amount == 8e-09\n    assert trade.close_profit_abs == 3.90069871\n    assert trade.close_profit == 0.00566035",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_recalc_trade_from_orders_kucoin():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    o1_amount = 11511963.86344489\n    o2_amount = 11750101.774393778\n    o3_amount = 23262065.63783866\n    res = o1_amount + o2_amount - o3_amount\n    assert res > 0.0\n    assert res < 0.1\n    o1_rate = 2.9901e-05\n    o2_rate = 2.9295e-05\n    o3_rate = 2.9822e-05\n    o1_cost = o1_amount * o1_rate\n    trade = Trade(pair='FLOKI/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=0.001, fee_close=0.001, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount\n    profit = trade.calculate_profit(o3_rate)\n    assert profit.profit_abs == pytest.approx(3.90069871)\n    assert profit.profit_ratio == pytest.approx(0.00566035)\n    order3 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order3)\n    trade.update_trade(order3)\n    assert trade.is_open is False\n    assert trade.amount == 8e-09\n    assert trade.close_profit_abs == 3.90069871\n    assert trade.close_profit == 0.00566035",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_recalc_trade_from_orders_kucoin():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    o1_amount = 11511963.86344489\n    o2_amount = 11750101.774393778\n    o3_amount = 23262065.63783866\n    res = o1_amount + o2_amount - o3_amount\n    assert res > 0.0\n    assert res < 0.1\n    o1_rate = 2.9901e-05\n    o2_rate = 2.9295e-05\n    o3_rate = 2.9822e-05\n    o1_cost = o1_amount * o1_rate\n    trade = Trade(pair='FLOKI/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=0.001, fee_close=0.001, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount\n    profit = trade.calculate_profit(o3_rate)\n    assert profit.profit_abs == pytest.approx(3.90069871)\n    assert profit.profit_ratio == pytest.approx(0.00566035)\n    order3 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order3)\n    trade.update_trade(order3)\n    assert trade.is_open is False\n    assert trade.amount == 8e-09\n    assert trade.close_profit_abs == 3.90069871\n    assert trade.close_profit == 0.00566035",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_recalc_trade_from_orders_kucoin():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    o1_amount = 11511963.86344489\n    o2_amount = 11750101.774393778\n    o3_amount = 23262065.63783866\n    res = o1_amount + o2_amount - o3_amount\n    assert res > 0.0\n    assert res < 0.1\n    o1_rate = 2.9901e-05\n    o2_rate = 2.9295e-05\n    o3_rate = 2.9822e-05\n    o1_cost = o1_amount * o1_rate\n    trade = Trade(pair='FLOKI/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=0.001, fee_close=0.001, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount\n    profit = trade.calculate_profit(o3_rate)\n    assert profit.profit_abs == pytest.approx(3.90069871)\n    assert profit.profit_ratio == pytest.approx(0.00566035)\n    order3 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order3)\n    trade.update_trade(order3)\n    assert trade.is_open is False\n    assert trade.amount == 8e-09\n    assert trade.close_profit_abs == 3.90069871\n    assert trade.close_profit == 0.00566035",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_recalc_trade_from_orders_kucoin():\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    o1_amount = 11511963.86344489\n    o2_amount = 11750101.774393778\n    o3_amount = 23262065.63783866\n    res = o1_amount + o2_amount - o3_amount\n    assert res > 0.0\n    assert res < 0.1\n    o1_rate = 2.9901e-05\n    o2_rate = 2.9295e-05\n    o3_rate = 2.9822e-05\n    o1_cost = o1_amount * o1_rate\n    trade = Trade(pair='FLOKI/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=0.001, fee_close=0.001, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, leverage=1)\n    order1 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    order2 = Order(ft_order_side='buy', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='buy', price=o2_rate, average=o2_rate, filled=o2_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount + o2_amount\n    profit = trade.calculate_profit(o3_rate)\n    assert profit.profit_abs == pytest.approx(3.90069871)\n    assert profit.profit_ratio == pytest.approx(0.00566035)\n    order3 = Order(ft_order_side='sell', ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side='sell', price=o3_rate, average=o3_rate, filled=o3_amount, remaining=0, cost=o2_amount * o2_rate, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order3)\n    trade.update_trade(order3)\n    assert trade.is_open is False\n    assert trade.amount == 8e-09\n    assert trade.close_profit_abs == 3.90069871\n    assert trade.close_profit == 0.00566035"
        ]
    },
    {
        "func_name": "test_recalc_trade_from_orders_ignores_bad_orders",
        "original": "@pytest.mark.parametrize('is_short', [True, False])\ndef test_recalc_trade_from_orders_ignores_bad_orders(fee, is_short):\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost - o1_fee_cost if is_short else o1_cost + o1_fee_cost\n    entry_side = 'sell' if is_short else 'buy'\n    exit_side = 'buy' if is_short else 'sell'\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, is_short=is_short, leverage=1.0)\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, entry_side)\n    order1 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order2 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=True, status='open', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order3 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='cancelled', symbol=trade.pair, order_type='market', side=entry_side, price=1, average=2, filled=0, remaining=4, cost=5, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order4 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order4)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    sell1 = Order(ft_order_side=exit_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=exit_side, price=4, average=3, filled=o1_amount, remaining=1, cost=5, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    order_noavg = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=None, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order_noavg)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 3",
        "mutated": [
            "@pytest.mark.parametrize('is_short', [True, False])\ndef test_recalc_trade_from_orders_ignores_bad_orders(fee, is_short):\n    if False:\n        i = 10\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost - o1_fee_cost if is_short else o1_cost + o1_fee_cost\n    entry_side = 'sell' if is_short else 'buy'\n    exit_side = 'buy' if is_short else 'sell'\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, is_short=is_short, leverage=1.0)\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, entry_side)\n    order1 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order2 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=True, status='open', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order3 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='cancelled', symbol=trade.pair, order_type='market', side=entry_side, price=1, average=2, filled=0, remaining=4, cost=5, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order4 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order4)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    sell1 = Order(ft_order_side=exit_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=exit_side, price=4, average=3, filled=o1_amount, remaining=1, cost=5, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    order_noavg = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=None, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order_noavg)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 3",
            "@pytest.mark.parametrize('is_short', [True, False])\ndef test_recalc_trade_from_orders_ignores_bad_orders(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost - o1_fee_cost if is_short else o1_cost + o1_fee_cost\n    entry_side = 'sell' if is_short else 'buy'\n    exit_side = 'buy' if is_short else 'sell'\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, is_short=is_short, leverage=1.0)\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, entry_side)\n    order1 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order2 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=True, status='open', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order3 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='cancelled', symbol=trade.pair, order_type='market', side=entry_side, price=1, average=2, filled=0, remaining=4, cost=5, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order4 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order4)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    sell1 = Order(ft_order_side=exit_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=exit_side, price=4, average=3, filled=o1_amount, remaining=1, cost=5, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    order_noavg = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=None, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order_noavg)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 3",
            "@pytest.mark.parametrize('is_short', [True, False])\ndef test_recalc_trade_from_orders_ignores_bad_orders(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost - o1_fee_cost if is_short else o1_cost + o1_fee_cost\n    entry_side = 'sell' if is_short else 'buy'\n    exit_side = 'buy' if is_short else 'sell'\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, is_short=is_short, leverage=1.0)\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, entry_side)\n    order1 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order2 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=True, status='open', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order3 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='cancelled', symbol=trade.pair, order_type='market', side=entry_side, price=1, average=2, filled=0, remaining=4, cost=5, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order4 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order4)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    sell1 = Order(ft_order_side=exit_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=exit_side, price=4, average=3, filled=o1_amount, remaining=1, cost=5, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    order_noavg = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=None, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order_noavg)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 3",
            "@pytest.mark.parametrize('is_short', [True, False])\ndef test_recalc_trade_from_orders_ignores_bad_orders(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost - o1_fee_cost if is_short else o1_cost + o1_fee_cost\n    entry_side = 'sell' if is_short else 'buy'\n    exit_side = 'buy' if is_short else 'sell'\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, is_short=is_short, leverage=1.0)\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, entry_side)\n    order1 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order2 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=True, status='open', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order3 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='cancelled', symbol=trade.pair, order_type='market', side=entry_side, price=1, average=2, filled=0, remaining=4, cost=5, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order4 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order4)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    sell1 = Order(ft_order_side=exit_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=exit_side, price=4, average=3, filled=o1_amount, remaining=1, cost=5, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    order_noavg = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=None, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order_noavg)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 3",
            "@pytest.mark.parametrize('is_short', [True, False])\ndef test_recalc_trade_from_orders_ignores_bad_orders(fee, is_short):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    o1_amount = 100\n    o1_rate = 1\n    o1_cost = o1_amount * o1_rate\n    o1_fee_cost = o1_cost * fee.return_value\n    o1_trade_val = o1_cost - o1_fee_cost if is_short else o1_cost + o1_fee_cost\n    entry_side = 'sell' if is_short else 'buy'\n    exit_side = 'buy' if is_short else 'sell'\n    trade = Trade(pair='ADA/USDT', stake_amount=o1_cost, open_date=dt_now() - timedelta(hours=2), amount=o1_amount, fee_open=fee.return_value, fee_close=fee.return_value, exchange='binance', open_rate=o1_rate, max_rate=o1_rate, is_short=is_short, leverage=1.0)\n    trade.update_fee(o1_fee_cost, 'BNB', fee.return_value, entry_side)\n    order1 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order2 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=True, status='open', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order2)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order3 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='cancelled', symbol=trade.pair, order_type='market', side=entry_side, price=1, average=2, filled=0, remaining=4, cost=5, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order3)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 1\n    order4 = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=o1_rate, filled=o1_amount, remaining=0, cost=o1_cost, order_date=dt_now() - timedelta(hours=1), order_filled_date=dt_now() - timedelta(hours=1))\n    trade.orders.append(order4)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    sell1 = Order(ft_order_side=exit_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=exit_side, price=4, average=3, filled=o1_amount, remaining=1, cost=5, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(sell1)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == o1_amount\n    assert trade.stake_amount == o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == o1_fee_cost\n    assert trade.open_trade_value == o1_trade_val\n    assert trade.nr_of_successful_entries == 2\n    order_noavg = Order(ft_order_side=entry_side, ft_pair=trade.pair, ft_is_open=False, status='closed', symbol=trade.pair, order_type='market', side=entry_side, price=o1_rate, average=None, filled=o1_amount, remaining=0, cost=o1_amount, order_date=trade.open_date, order_filled_date=trade.open_date)\n    trade.orders.append(order_noavg)\n    trade.recalc_trade_from_orders()\n    assert trade.amount == 2 * o1_amount\n    assert trade.stake_amount == 2 * o1_amount\n    assert trade.open_rate == o1_rate\n    assert trade.fee_open_cost == 2 * o1_fee_cost\n    assert trade.open_trade_value == 2 * o1_trade_val\n    assert trade.nr_of_successful_entries == 3"
        ]
    },
    {
        "func_name": "test_select_filled_orders",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_select_filled_orders(fee):\n    create_mock_trades(fee)\n    trades = Trade.get_trades().all()\n    orders = trades[0].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[0].select_filled_orders('sell')\n    assert orders is not None\n    assert len(orders) == 0\n    orders = trades[1].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    order = orders[0]\n    assert order.amount > 0\n    assert order.filled > 0\n    assert order.side == 'buy'\n    assert order.ft_order_side == 'buy'\n    assert order.status == 'closed'\n    orders = trades[1].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[3].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[3].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[4].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[4].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_select_filled_orders(fee):\n    if False:\n        i = 10\n    create_mock_trades(fee)\n    trades = Trade.get_trades().all()\n    orders = trades[0].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[0].select_filled_orders('sell')\n    assert orders is not None\n    assert len(orders) == 0\n    orders = trades[1].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    order = orders[0]\n    assert order.amount > 0\n    assert order.filled > 0\n    assert order.side == 'buy'\n    assert order.ft_order_side == 'buy'\n    assert order.status == 'closed'\n    orders = trades[1].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[3].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[3].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[4].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[4].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_select_filled_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    create_mock_trades(fee)\n    trades = Trade.get_trades().all()\n    orders = trades[0].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[0].select_filled_orders('sell')\n    assert orders is not None\n    assert len(orders) == 0\n    orders = trades[1].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    order = orders[0]\n    assert order.amount > 0\n    assert order.filled > 0\n    assert order.side == 'buy'\n    assert order.ft_order_side == 'buy'\n    assert order.status == 'closed'\n    orders = trades[1].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[3].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[3].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[4].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[4].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_select_filled_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    create_mock_trades(fee)\n    trades = Trade.get_trades().all()\n    orders = trades[0].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[0].select_filled_orders('sell')\n    assert orders is not None\n    assert len(orders) == 0\n    orders = trades[1].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    order = orders[0]\n    assert order.amount > 0\n    assert order.filled > 0\n    assert order.side == 'buy'\n    assert order.ft_order_side == 'buy'\n    assert order.status == 'closed'\n    orders = trades[1].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[3].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[3].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[4].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[4].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_select_filled_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    create_mock_trades(fee)\n    trades = Trade.get_trades().all()\n    orders = trades[0].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[0].select_filled_orders('sell')\n    assert orders is not None\n    assert len(orders) == 0\n    orders = trades[1].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    order = orders[0]\n    assert order.amount > 0\n    assert order.filled > 0\n    assert order.side == 'buy'\n    assert order.ft_order_side == 'buy'\n    assert order.status == 'closed'\n    orders = trades[1].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[3].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[3].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[4].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[4].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_select_filled_orders(fee):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    create_mock_trades(fee)\n    trades = Trade.get_trades().all()\n    orders = trades[0].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[0].select_filled_orders('sell')\n    assert orders is not None\n    assert len(orders) == 0\n    orders = trades[1].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    order = orders[0]\n    assert order.amount > 0\n    assert order.filled > 0\n    assert order.side == 'buy'\n    assert order.ft_order_side == 'buy'\n    assert order.status == 'closed'\n    orders = trades[1].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[3].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[3].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0\n    orders = trades[4].select_filled_orders('buy')\n    assert isinstance(orders, list)\n    assert len(orders) == 1\n    orders = trades[4].select_filled_orders('sell')\n    assert isinstance(orders, list)\n    assert len(orders) == 0"
        ]
    },
    {
        "func_name": "test_order_to_ccxt",
        "original": "@pytest.mark.usefixtures('init_persistence')\ndef test_order_to_ccxt(limit_buy_order_open, limit_sell_order_usdt_open):\n    order = Order.parse_from_ccxt_object(limit_buy_order_open, 'mocked', 'buy')\n    order.ft_trade_id = 1\n    order.session.add(order)\n    Order.session.commit()\n    order_resp = Order.order_by_id(limit_buy_order_open['id'])\n    assert order_resp\n    raw_order = order_resp.to_ccxt_object()\n    del raw_order['fee']\n    del raw_order['datetime']\n    del raw_order['info']\n    assert raw_order.get('stopPrice') is None\n    raw_order.pop('stopPrice', None)\n    del limit_buy_order_open['datetime']\n    assert raw_order == limit_buy_order_open\n    order1 = Order.parse_from_ccxt_object(limit_sell_order_usdt_open, 'mocked', 'sell')\n    order1.ft_order_side = 'stoploss'\n    order1.stop_price = order1.price * 0.9\n    order1.ft_trade_id = 1\n    order1.session.add(order1)\n    Order.session.commit()\n    order_resp1 = Order.order_by_id(limit_sell_order_usdt_open['id'])\n    raw_order1 = order_resp1.to_ccxt_object()\n    assert raw_order1.get('stopPrice') is not None",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\ndef test_order_to_ccxt(limit_buy_order_open, limit_sell_order_usdt_open):\n    if False:\n        i = 10\n    order = Order.parse_from_ccxt_object(limit_buy_order_open, 'mocked', 'buy')\n    order.ft_trade_id = 1\n    order.session.add(order)\n    Order.session.commit()\n    order_resp = Order.order_by_id(limit_buy_order_open['id'])\n    assert order_resp\n    raw_order = order_resp.to_ccxt_object()\n    del raw_order['fee']\n    del raw_order['datetime']\n    del raw_order['info']\n    assert raw_order.get('stopPrice') is None\n    raw_order.pop('stopPrice', None)\n    del limit_buy_order_open['datetime']\n    assert raw_order == limit_buy_order_open\n    order1 = Order.parse_from_ccxt_object(limit_sell_order_usdt_open, 'mocked', 'sell')\n    order1.ft_order_side = 'stoploss'\n    order1.stop_price = order1.price * 0.9\n    order1.ft_trade_id = 1\n    order1.session.add(order1)\n    Order.session.commit()\n    order_resp1 = Order.order_by_id(limit_sell_order_usdt_open['id'])\n    raw_order1 = order_resp1.to_ccxt_object()\n    assert raw_order1.get('stopPrice') is not None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_order_to_ccxt(limit_buy_order_open, limit_sell_order_usdt_open):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    order = Order.parse_from_ccxt_object(limit_buy_order_open, 'mocked', 'buy')\n    order.ft_trade_id = 1\n    order.session.add(order)\n    Order.session.commit()\n    order_resp = Order.order_by_id(limit_buy_order_open['id'])\n    assert order_resp\n    raw_order = order_resp.to_ccxt_object()\n    del raw_order['fee']\n    del raw_order['datetime']\n    del raw_order['info']\n    assert raw_order.get('stopPrice') is None\n    raw_order.pop('stopPrice', None)\n    del limit_buy_order_open['datetime']\n    assert raw_order == limit_buy_order_open\n    order1 = Order.parse_from_ccxt_object(limit_sell_order_usdt_open, 'mocked', 'sell')\n    order1.ft_order_side = 'stoploss'\n    order1.stop_price = order1.price * 0.9\n    order1.ft_trade_id = 1\n    order1.session.add(order1)\n    Order.session.commit()\n    order_resp1 = Order.order_by_id(limit_sell_order_usdt_open['id'])\n    raw_order1 = order_resp1.to_ccxt_object()\n    assert raw_order1.get('stopPrice') is not None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_order_to_ccxt(limit_buy_order_open, limit_sell_order_usdt_open):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    order = Order.parse_from_ccxt_object(limit_buy_order_open, 'mocked', 'buy')\n    order.ft_trade_id = 1\n    order.session.add(order)\n    Order.session.commit()\n    order_resp = Order.order_by_id(limit_buy_order_open['id'])\n    assert order_resp\n    raw_order = order_resp.to_ccxt_object()\n    del raw_order['fee']\n    del raw_order['datetime']\n    del raw_order['info']\n    assert raw_order.get('stopPrice') is None\n    raw_order.pop('stopPrice', None)\n    del limit_buy_order_open['datetime']\n    assert raw_order == limit_buy_order_open\n    order1 = Order.parse_from_ccxt_object(limit_sell_order_usdt_open, 'mocked', 'sell')\n    order1.ft_order_side = 'stoploss'\n    order1.stop_price = order1.price * 0.9\n    order1.ft_trade_id = 1\n    order1.session.add(order1)\n    Order.session.commit()\n    order_resp1 = Order.order_by_id(limit_sell_order_usdt_open['id'])\n    raw_order1 = order_resp1.to_ccxt_object()\n    assert raw_order1.get('stopPrice') is not None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_order_to_ccxt(limit_buy_order_open, limit_sell_order_usdt_open):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    order = Order.parse_from_ccxt_object(limit_buy_order_open, 'mocked', 'buy')\n    order.ft_trade_id = 1\n    order.session.add(order)\n    Order.session.commit()\n    order_resp = Order.order_by_id(limit_buy_order_open['id'])\n    assert order_resp\n    raw_order = order_resp.to_ccxt_object()\n    del raw_order['fee']\n    del raw_order['datetime']\n    del raw_order['info']\n    assert raw_order.get('stopPrice') is None\n    raw_order.pop('stopPrice', None)\n    del limit_buy_order_open['datetime']\n    assert raw_order == limit_buy_order_open\n    order1 = Order.parse_from_ccxt_object(limit_sell_order_usdt_open, 'mocked', 'sell')\n    order1.ft_order_side = 'stoploss'\n    order1.stop_price = order1.price * 0.9\n    order1.ft_trade_id = 1\n    order1.session.add(order1)\n    Order.session.commit()\n    order_resp1 = Order.order_by_id(limit_sell_order_usdt_open['id'])\n    raw_order1 = order_resp1.to_ccxt_object()\n    assert raw_order1.get('stopPrice') is not None",
            "@pytest.mark.usefixtures('init_persistence')\ndef test_order_to_ccxt(limit_buy_order_open, limit_sell_order_usdt_open):\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    order = Order.parse_from_ccxt_object(limit_buy_order_open, 'mocked', 'buy')\n    order.ft_trade_id = 1\n    order.session.add(order)\n    Order.session.commit()\n    order_resp = Order.order_by_id(limit_buy_order_open['id'])\n    assert order_resp\n    raw_order = order_resp.to_ccxt_object()\n    del raw_order['fee']\n    del raw_order['datetime']\n    del raw_order['info']\n    assert raw_order.get('stopPrice') is None\n    raw_order.pop('stopPrice', None)\n    del limit_buy_order_open['datetime']\n    assert raw_order == limit_buy_order_open\n    order1 = Order.parse_from_ccxt_object(limit_sell_order_usdt_open, 'mocked', 'sell')\n    order1.ft_order_side = 'stoploss'\n    order1.stop_price = order1.price * 0.9\n    order1.ft_trade_id = 1\n    order1.session.add(order1)\n    Order.session.commit()\n    order_resp1 = Order.order_by_id(limit_sell_order_usdt_open['id'])\n    raw_order1 = order_resp1.to_ccxt_object()\n    assert raw_order1.get('stopPrice') is not None"
        ]
    },
    {
        "func_name": "test_recalc_trade_from_orders_dca",
        "original": "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('data', [{'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -25.0, -25.0, -0.04)), (('sell', 100, 20), (50.0, 12.5, 625.0, 725.0, 750.0, 0.6)), (('sell', 50, 5), (50.0, 12.5, 625.0, 350.0, -375.0, -0.6))], 'end_profit': 350.0, 'end_profit_ratio': 0.14, 'fee': 0.0}, {'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -28.0625, -28.0625, -0.044788)), (('sell', 100, 20), (50.0, 12.5, 625.0, 713.8125, 741.875, 0.59201995)), (('sell', 50, 5), (50.0, 12.5, 625.0, 336.625, -377.1875, -0.60199501))], 'end_profit': 336.625, 'end_profit_ratio': 0.1343142, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 596.0, 596.0, 1.189027)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 596.0, 596.0, 1.189027)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1388.5, 792.5, 0.7186579)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3175.75, 1787.25, 1.08048062))], 'end_profit': 3175.75, 'end_profit_ratio': 0.974717, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 600.0, 600.0, 1.2)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 600.0, 600.0, 1.2)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1400.0, 800.0, 0.72727273)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3200.0, 1800.0, 1.09090909))], 'end_profit': 3200.0, 'end_profit_ratio': 0.98461538, 'fee': 0.0}, {'orders': [(('buy', 100, 8), (100.0, 8.0, 800.0, 0.0, None, None)), (('buy', 100, 9), (200.0, 8.5, 1700.0, 0.0, None, None)), (('sell', 100, 10), (100.0, 8.5, 850.0, 150.0, 150.0, 0.17647059)), (('buy', 150, 11), (250.0, 10, 2500.0, 150.0, 150.0, 0.17647059)), (('sell', 100, 12), (150.0, 10.0, 1500.0, 350.0, 200.0, 0.2)), (('sell', 150, 14), (150.0, 10.0, 1500.0, 950.0, 600.0, 0.4))], 'end_profit': 950.0, 'end_profit_ratio': 0.283582, 'fee': 0.0}])\ndef test_recalc_trade_from_orders_dca(data) -> None:\n    pair = 'ETH/USDT'\n    trade = Trade(id=2, pair=pair, stake_amount=1000, open_rate=data['orders'][0][0][2], amount=data['orders'][0][0][1], is_open=True, open_date=dt_now(), fee_open=data['fee'], fee_close=data['fee'], exchange='binance', is_short=False, leverage=1.0, trading_mode=TradingMode.SPOT)\n    Trade.session.add(trade)\n    for (idx, (order, result)) in enumerate(data['orders']):\n        amount = order[1]\n        price = order[2]\n        order_obj = Order(ft_order_side=order[0], ft_pair=trade.pair, order_id=f'order_{order[0]}_{idx}', ft_is_open=False, ft_amount=amount, ft_price=price, status='closed', symbol=trade.pair, order_type='market', side=order[0], price=price, average=price, filled=amount, remaining=0, cost=amount * price, order_date=dt_now() - timedelta(hours=10 + idx), order_filled_date=dt_now() - timedelta(hours=10 + idx))\n        trade.orders.append(order_obj)\n        trade.recalc_trade_from_orders()\n        Trade.commit()\n        orders1 = Order.session.scalars(select(Order)).all()\n        assert orders1\n        assert len(orders1) == idx + 1\n        trade = Trade.session.scalars(select(Trade)).first()\n        assert trade\n        assert len(trade.orders) == idx + 1\n        if idx < len(data) - 1:\n            assert trade.is_open is True\n        assert not trade.has_open_orders\n        assert trade.amount == result[0]\n        assert trade.open_rate == result[1]\n        assert trade.stake_amount == result[2]\n        assert pytest.approx(trade.realized_profit) == result[3]\n        assert pytest.approx(trade.close_profit_abs) == result[4]\n        assert pytest.approx(trade.close_profit) == result[5]\n    trade.close(price)\n    assert pytest.approx(trade.close_profit_abs) == data['end_profit']\n    assert pytest.approx(trade.close_profit) == data['end_profit_ratio']\n    assert not trade.is_open\n    trade = Trade.session.scalars(select(Trade)).first()\n    assert trade\n    assert not trade.has_open_orders",
        "mutated": [
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('data', [{'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -25.0, -25.0, -0.04)), (('sell', 100, 20), (50.0, 12.5, 625.0, 725.0, 750.0, 0.6)), (('sell', 50, 5), (50.0, 12.5, 625.0, 350.0, -375.0, -0.6))], 'end_profit': 350.0, 'end_profit_ratio': 0.14, 'fee': 0.0}, {'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -28.0625, -28.0625, -0.044788)), (('sell', 100, 20), (50.0, 12.5, 625.0, 713.8125, 741.875, 0.59201995)), (('sell', 50, 5), (50.0, 12.5, 625.0, 336.625, -377.1875, -0.60199501))], 'end_profit': 336.625, 'end_profit_ratio': 0.1343142, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 596.0, 596.0, 1.189027)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 596.0, 596.0, 1.189027)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1388.5, 792.5, 0.7186579)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3175.75, 1787.25, 1.08048062))], 'end_profit': 3175.75, 'end_profit_ratio': 0.974717, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 600.0, 600.0, 1.2)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 600.0, 600.0, 1.2)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1400.0, 800.0, 0.72727273)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3200.0, 1800.0, 1.09090909))], 'end_profit': 3200.0, 'end_profit_ratio': 0.98461538, 'fee': 0.0}, {'orders': [(('buy', 100, 8), (100.0, 8.0, 800.0, 0.0, None, None)), (('buy', 100, 9), (200.0, 8.5, 1700.0, 0.0, None, None)), (('sell', 100, 10), (100.0, 8.5, 850.0, 150.0, 150.0, 0.17647059)), (('buy', 150, 11), (250.0, 10, 2500.0, 150.0, 150.0, 0.17647059)), (('sell', 100, 12), (150.0, 10.0, 1500.0, 350.0, 200.0, 0.2)), (('sell', 150, 14), (150.0, 10.0, 1500.0, 950.0, 600.0, 0.4))], 'end_profit': 950.0, 'end_profit_ratio': 0.283582, 'fee': 0.0}])\ndef test_recalc_trade_from_orders_dca(data) -> None:\n    if False:\n        i = 10\n    pair = 'ETH/USDT'\n    trade = Trade(id=2, pair=pair, stake_amount=1000, open_rate=data['orders'][0][0][2], amount=data['orders'][0][0][1], is_open=True, open_date=dt_now(), fee_open=data['fee'], fee_close=data['fee'], exchange='binance', is_short=False, leverage=1.0, trading_mode=TradingMode.SPOT)\n    Trade.session.add(trade)\n    for (idx, (order, result)) in enumerate(data['orders']):\n        amount = order[1]\n        price = order[2]\n        order_obj = Order(ft_order_side=order[0], ft_pair=trade.pair, order_id=f'order_{order[0]}_{idx}', ft_is_open=False, ft_amount=amount, ft_price=price, status='closed', symbol=trade.pair, order_type='market', side=order[0], price=price, average=price, filled=amount, remaining=0, cost=amount * price, order_date=dt_now() - timedelta(hours=10 + idx), order_filled_date=dt_now() - timedelta(hours=10 + idx))\n        trade.orders.append(order_obj)\n        trade.recalc_trade_from_orders()\n        Trade.commit()\n        orders1 = Order.session.scalars(select(Order)).all()\n        assert orders1\n        assert len(orders1) == idx + 1\n        trade = Trade.session.scalars(select(Trade)).first()\n        assert trade\n        assert len(trade.orders) == idx + 1\n        if idx < len(data) - 1:\n            assert trade.is_open is True\n        assert not trade.has_open_orders\n        assert trade.amount == result[0]\n        assert trade.open_rate == result[1]\n        assert trade.stake_amount == result[2]\n        assert pytest.approx(trade.realized_profit) == result[3]\n        assert pytest.approx(trade.close_profit_abs) == result[4]\n        assert pytest.approx(trade.close_profit) == result[5]\n    trade.close(price)\n    assert pytest.approx(trade.close_profit_abs) == data['end_profit']\n    assert pytest.approx(trade.close_profit) == data['end_profit_ratio']\n    assert not trade.is_open\n    trade = Trade.session.scalars(select(Trade)).first()\n    assert trade\n    assert not trade.has_open_orders",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('data', [{'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -25.0, -25.0, -0.04)), (('sell', 100, 20), (50.0, 12.5, 625.0, 725.0, 750.0, 0.6)), (('sell', 50, 5), (50.0, 12.5, 625.0, 350.0, -375.0, -0.6))], 'end_profit': 350.0, 'end_profit_ratio': 0.14, 'fee': 0.0}, {'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -28.0625, -28.0625, -0.044788)), (('sell', 100, 20), (50.0, 12.5, 625.0, 713.8125, 741.875, 0.59201995)), (('sell', 50, 5), (50.0, 12.5, 625.0, 336.625, -377.1875, -0.60199501))], 'end_profit': 336.625, 'end_profit_ratio': 0.1343142, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 596.0, 596.0, 1.189027)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 596.0, 596.0, 1.189027)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1388.5, 792.5, 0.7186579)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3175.75, 1787.25, 1.08048062))], 'end_profit': 3175.75, 'end_profit_ratio': 0.974717, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 600.0, 600.0, 1.2)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 600.0, 600.0, 1.2)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1400.0, 800.0, 0.72727273)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3200.0, 1800.0, 1.09090909))], 'end_profit': 3200.0, 'end_profit_ratio': 0.98461538, 'fee': 0.0}, {'orders': [(('buy', 100, 8), (100.0, 8.0, 800.0, 0.0, None, None)), (('buy', 100, 9), (200.0, 8.5, 1700.0, 0.0, None, None)), (('sell', 100, 10), (100.0, 8.5, 850.0, 150.0, 150.0, 0.17647059)), (('buy', 150, 11), (250.0, 10, 2500.0, 150.0, 150.0, 0.17647059)), (('sell', 100, 12), (150.0, 10.0, 1500.0, 350.0, 200.0, 0.2)), (('sell', 150, 14), (150.0, 10.0, 1500.0, 950.0, 600.0, 0.4))], 'end_profit': 950.0, 'end_profit_ratio': 0.283582, 'fee': 0.0}])\ndef test_recalc_trade_from_orders_dca(data) -> None:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    pair = 'ETH/USDT'\n    trade = Trade(id=2, pair=pair, stake_amount=1000, open_rate=data['orders'][0][0][2], amount=data['orders'][0][0][1], is_open=True, open_date=dt_now(), fee_open=data['fee'], fee_close=data['fee'], exchange='binance', is_short=False, leverage=1.0, trading_mode=TradingMode.SPOT)\n    Trade.session.add(trade)\n    for (idx, (order, result)) in enumerate(data['orders']):\n        amount = order[1]\n        price = order[2]\n        order_obj = Order(ft_order_side=order[0], ft_pair=trade.pair, order_id=f'order_{order[0]}_{idx}', ft_is_open=False, ft_amount=amount, ft_price=price, status='closed', symbol=trade.pair, order_type='market', side=order[0], price=price, average=price, filled=amount, remaining=0, cost=amount * price, order_date=dt_now() - timedelta(hours=10 + idx), order_filled_date=dt_now() - timedelta(hours=10 + idx))\n        trade.orders.append(order_obj)\n        trade.recalc_trade_from_orders()\n        Trade.commit()\n        orders1 = Order.session.scalars(select(Order)).all()\n        assert orders1\n        assert len(orders1) == idx + 1\n        trade = Trade.session.scalars(select(Trade)).first()\n        assert trade\n        assert len(trade.orders) == idx + 1\n        if idx < len(data) - 1:\n            assert trade.is_open is True\n        assert not trade.has_open_orders\n        assert trade.amount == result[0]\n        assert trade.open_rate == result[1]\n        assert trade.stake_amount == result[2]\n        assert pytest.approx(trade.realized_profit) == result[3]\n        assert pytest.approx(trade.close_profit_abs) == result[4]\n        assert pytest.approx(trade.close_profit) == result[5]\n    trade.close(price)\n    assert pytest.approx(trade.close_profit_abs) == data['end_profit']\n    assert pytest.approx(trade.close_profit) == data['end_profit_ratio']\n    assert not trade.is_open\n    trade = Trade.session.scalars(select(Trade)).first()\n    assert trade\n    assert not trade.has_open_orders",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('data', [{'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -25.0, -25.0, -0.04)), (('sell', 100, 20), (50.0, 12.5, 625.0, 725.0, 750.0, 0.6)), (('sell', 50, 5), (50.0, 12.5, 625.0, 350.0, -375.0, -0.6))], 'end_profit': 350.0, 'end_profit_ratio': 0.14, 'fee': 0.0}, {'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -28.0625, -28.0625, -0.044788)), (('sell', 100, 20), (50.0, 12.5, 625.0, 713.8125, 741.875, 0.59201995)), (('sell', 50, 5), (50.0, 12.5, 625.0, 336.625, -377.1875, -0.60199501))], 'end_profit': 336.625, 'end_profit_ratio': 0.1343142, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 596.0, 596.0, 1.189027)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 596.0, 596.0, 1.189027)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1388.5, 792.5, 0.7186579)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3175.75, 1787.25, 1.08048062))], 'end_profit': 3175.75, 'end_profit_ratio': 0.974717, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 600.0, 600.0, 1.2)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 600.0, 600.0, 1.2)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1400.0, 800.0, 0.72727273)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3200.0, 1800.0, 1.09090909))], 'end_profit': 3200.0, 'end_profit_ratio': 0.98461538, 'fee': 0.0}, {'orders': [(('buy', 100, 8), (100.0, 8.0, 800.0, 0.0, None, None)), (('buy', 100, 9), (200.0, 8.5, 1700.0, 0.0, None, None)), (('sell', 100, 10), (100.0, 8.5, 850.0, 150.0, 150.0, 0.17647059)), (('buy', 150, 11), (250.0, 10, 2500.0, 150.0, 150.0, 0.17647059)), (('sell', 100, 12), (150.0, 10.0, 1500.0, 350.0, 200.0, 0.2)), (('sell', 150, 14), (150.0, 10.0, 1500.0, 950.0, 600.0, 0.4))], 'end_profit': 950.0, 'end_profit_ratio': 0.283582, 'fee': 0.0}])\ndef test_recalc_trade_from_orders_dca(data) -> None:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    pair = 'ETH/USDT'\n    trade = Trade(id=2, pair=pair, stake_amount=1000, open_rate=data['orders'][0][0][2], amount=data['orders'][0][0][1], is_open=True, open_date=dt_now(), fee_open=data['fee'], fee_close=data['fee'], exchange='binance', is_short=False, leverage=1.0, trading_mode=TradingMode.SPOT)\n    Trade.session.add(trade)\n    for (idx, (order, result)) in enumerate(data['orders']):\n        amount = order[1]\n        price = order[2]\n        order_obj = Order(ft_order_side=order[0], ft_pair=trade.pair, order_id=f'order_{order[0]}_{idx}', ft_is_open=False, ft_amount=amount, ft_price=price, status='closed', symbol=trade.pair, order_type='market', side=order[0], price=price, average=price, filled=amount, remaining=0, cost=amount * price, order_date=dt_now() - timedelta(hours=10 + idx), order_filled_date=dt_now() - timedelta(hours=10 + idx))\n        trade.orders.append(order_obj)\n        trade.recalc_trade_from_orders()\n        Trade.commit()\n        orders1 = Order.session.scalars(select(Order)).all()\n        assert orders1\n        assert len(orders1) == idx + 1\n        trade = Trade.session.scalars(select(Trade)).first()\n        assert trade\n        assert len(trade.orders) == idx + 1\n        if idx < len(data) - 1:\n            assert trade.is_open is True\n        assert not trade.has_open_orders\n        assert trade.amount == result[0]\n        assert trade.open_rate == result[1]\n        assert trade.stake_amount == result[2]\n        assert pytest.approx(trade.realized_profit) == result[3]\n        assert pytest.approx(trade.close_profit_abs) == result[4]\n        assert pytest.approx(trade.close_profit) == result[5]\n    trade.close(price)\n    assert pytest.approx(trade.close_profit_abs) == data['end_profit']\n    assert pytest.approx(trade.close_profit) == data['end_profit_ratio']\n    assert not trade.is_open\n    trade = Trade.session.scalars(select(Trade)).first()\n    assert trade\n    assert not trade.has_open_orders",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('data', [{'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -25.0, -25.0, -0.04)), (('sell', 100, 20), (50.0, 12.5, 625.0, 725.0, 750.0, 0.6)), (('sell', 50, 5), (50.0, 12.5, 625.0, 350.0, -375.0, -0.6))], 'end_profit': 350.0, 'end_profit_ratio': 0.14, 'fee': 0.0}, {'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -28.0625, -28.0625, -0.044788)), (('sell', 100, 20), (50.0, 12.5, 625.0, 713.8125, 741.875, 0.59201995)), (('sell', 50, 5), (50.0, 12.5, 625.0, 336.625, -377.1875, -0.60199501))], 'end_profit': 336.625, 'end_profit_ratio': 0.1343142, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 596.0, 596.0, 1.189027)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 596.0, 596.0, 1.189027)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1388.5, 792.5, 0.7186579)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3175.75, 1787.25, 1.08048062))], 'end_profit': 3175.75, 'end_profit_ratio': 0.974717, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 600.0, 600.0, 1.2)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 600.0, 600.0, 1.2)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1400.0, 800.0, 0.72727273)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3200.0, 1800.0, 1.09090909))], 'end_profit': 3200.0, 'end_profit_ratio': 0.98461538, 'fee': 0.0}, {'orders': [(('buy', 100, 8), (100.0, 8.0, 800.0, 0.0, None, None)), (('buy', 100, 9), (200.0, 8.5, 1700.0, 0.0, None, None)), (('sell', 100, 10), (100.0, 8.5, 850.0, 150.0, 150.0, 0.17647059)), (('buy', 150, 11), (250.0, 10, 2500.0, 150.0, 150.0, 0.17647059)), (('sell', 100, 12), (150.0, 10.0, 1500.0, 350.0, 200.0, 0.2)), (('sell', 150, 14), (150.0, 10.0, 1500.0, 950.0, 600.0, 0.4))], 'end_profit': 950.0, 'end_profit_ratio': 0.283582, 'fee': 0.0}])\ndef test_recalc_trade_from_orders_dca(data) -> None:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    pair = 'ETH/USDT'\n    trade = Trade(id=2, pair=pair, stake_amount=1000, open_rate=data['orders'][0][0][2], amount=data['orders'][0][0][1], is_open=True, open_date=dt_now(), fee_open=data['fee'], fee_close=data['fee'], exchange='binance', is_short=False, leverage=1.0, trading_mode=TradingMode.SPOT)\n    Trade.session.add(trade)\n    for (idx, (order, result)) in enumerate(data['orders']):\n        amount = order[1]\n        price = order[2]\n        order_obj = Order(ft_order_side=order[0], ft_pair=trade.pair, order_id=f'order_{order[0]}_{idx}', ft_is_open=False, ft_amount=amount, ft_price=price, status='closed', symbol=trade.pair, order_type='market', side=order[0], price=price, average=price, filled=amount, remaining=0, cost=amount * price, order_date=dt_now() - timedelta(hours=10 + idx), order_filled_date=dt_now() - timedelta(hours=10 + idx))\n        trade.orders.append(order_obj)\n        trade.recalc_trade_from_orders()\n        Trade.commit()\n        orders1 = Order.session.scalars(select(Order)).all()\n        assert orders1\n        assert len(orders1) == idx + 1\n        trade = Trade.session.scalars(select(Trade)).first()\n        assert trade\n        assert len(trade.orders) == idx + 1\n        if idx < len(data) - 1:\n            assert trade.is_open is True\n        assert not trade.has_open_orders\n        assert trade.amount == result[0]\n        assert trade.open_rate == result[1]\n        assert trade.stake_amount == result[2]\n        assert pytest.approx(trade.realized_profit) == result[3]\n        assert pytest.approx(trade.close_profit_abs) == result[4]\n        assert pytest.approx(trade.close_profit) == result[5]\n    trade.close(price)\n    assert pytest.approx(trade.close_profit_abs) == data['end_profit']\n    assert pytest.approx(trade.close_profit) == data['end_profit_ratio']\n    assert not trade.is_open\n    trade = Trade.session.scalars(select(Trade)).first()\n    assert trade\n    assert not trade.has_open_orders",
            "@pytest.mark.usefixtures('init_persistence')\n@pytest.mark.parametrize('data', [{'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -25.0, -25.0, -0.04)), (('sell', 100, 20), (50.0, 12.5, 625.0, 725.0, 750.0, 0.6)), (('sell', 50, 5), (50.0, 12.5, 625.0, 350.0, -375.0, -0.6))], 'end_profit': 350.0, 'end_profit_ratio': 0.14, 'fee': 0.0}, {'orders': [(('buy', 100, 10), (100.0, 10.0, 1000.0, 0.0, None, None)), (('buy', 100, 15), (200.0, 12.5, 2500.0, 0.0, None, None)), (('sell', 50, 12), (150.0, 12.5, 1875.0, -28.0625, -28.0625, -0.044788)), (('sell', 100, 20), (50.0, 12.5, 625.0, 713.8125, 741.875, 0.59201995)), (('sell', 50, 5), (50.0, 12.5, 625.0, 336.625, -377.1875, -0.60199501))], 'end_profit': 336.625, 'end_profit_ratio': 0.1343142, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 596.0, 596.0, 1.189027)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 596.0, 596.0, 1.189027)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1388.5, 792.5, 0.7186579)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3175.75, 1787.25, 1.08048062))], 'end_profit': 3175.75, 'end_profit_ratio': 0.974717, 'fee': 0.0025}, {'orders': [(('buy', 100, 3), (100.0, 3.0, 300.0, 0.0, None, None)), (('buy', 100, 7), (200.0, 5.0, 1000.0, 0.0, None, None)), (('sell', 100, 11), (100.0, 5.0, 500.0, 600.0, 600.0, 1.2)), (('buy', 150, 15), (250.0, 11.0, 2750.0, 600.0, 600.0, 1.2)), (('sell', 100, 19), (150.0, 11.0, 1650.0, 1400.0, 800.0, 0.72727273)), (('sell', 150, 23), (150.0, 11.0, 1650.0, 3200.0, 1800.0, 1.09090909))], 'end_profit': 3200.0, 'end_profit_ratio': 0.98461538, 'fee': 0.0}, {'orders': [(('buy', 100, 8), (100.0, 8.0, 800.0, 0.0, None, None)), (('buy', 100, 9), (200.0, 8.5, 1700.0, 0.0, None, None)), (('sell', 100, 10), (100.0, 8.5, 850.0, 150.0, 150.0, 0.17647059)), (('buy', 150, 11), (250.0, 10, 2500.0, 150.0, 150.0, 0.17647059)), (('sell', 100, 12), (150.0, 10.0, 1500.0, 350.0, 200.0, 0.2)), (('sell', 150, 14), (150.0, 10.0, 1500.0, 950.0, 600.0, 0.4))], 'end_profit': 950.0, 'end_profit_ratio': 0.283582, 'fee': 0.0}])\ndef test_recalc_trade_from_orders_dca(data) -> None:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    pair = 'ETH/USDT'\n    trade = Trade(id=2, pair=pair, stake_amount=1000, open_rate=data['orders'][0][0][2], amount=data['orders'][0][0][1], is_open=True, open_date=dt_now(), fee_open=data['fee'], fee_close=data['fee'], exchange='binance', is_short=False, leverage=1.0, trading_mode=TradingMode.SPOT)\n    Trade.session.add(trade)\n    for (idx, (order, result)) in enumerate(data['orders']):\n        amount = order[1]\n        price = order[2]\n        order_obj = Order(ft_order_side=order[0], ft_pair=trade.pair, order_id=f'order_{order[0]}_{idx}', ft_is_open=False, ft_amount=amount, ft_price=price, status='closed', symbol=trade.pair, order_type='market', side=order[0], price=price, average=price, filled=amount, remaining=0, cost=amount * price, order_date=dt_now() - timedelta(hours=10 + idx), order_filled_date=dt_now() - timedelta(hours=10 + idx))\n        trade.orders.append(order_obj)\n        trade.recalc_trade_from_orders()\n        Trade.commit()\n        orders1 = Order.session.scalars(select(Order)).all()\n        assert orders1\n        assert len(orders1) == idx + 1\n        trade = Trade.session.scalars(select(Trade)).first()\n        assert trade\n        assert len(trade.orders) == idx + 1\n        if idx < len(data) - 1:\n            assert trade.is_open is True\n        assert not trade.has_open_orders\n        assert trade.amount == result[0]\n        assert trade.open_rate == result[1]\n        assert trade.stake_amount == result[2]\n        assert pytest.approx(trade.realized_profit) == result[3]\n        assert pytest.approx(trade.close_profit_abs) == result[4]\n        assert pytest.approx(trade.close_profit) == result[5]\n    trade.close(price)\n    assert pytest.approx(trade.close_profit_abs) == data['end_profit']\n    assert pytest.approx(trade.close_profit) == data['end_profit_ratio']\n    assert not trade.is_open\n    trade = Trade.session.scalars(select(Trade)).first()\n    assert trade\n    assert not trade.has_open_orders"
        ]
    }
]