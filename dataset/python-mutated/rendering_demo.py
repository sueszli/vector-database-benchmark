"""
A demo for rendering mesh generated by `main.py`
"""
from rendering import cfg, _to_ctype, RenderPipeline
import scipy.io as sio
import imageio
import numpy as np
import matplotlib.pyplot as plt

def test():
    if False:
        while True:
            i = 10
    fp = '../samples/emma_input_0.mat'
    vertices = sio.loadmat(fp)['vertex'].T
    print(vertices.shape)
    img = imageio.imread('../samples/emma_input.jpg').astype(np.float32) / 255.0
    triangles = sio.loadmat('../visualize/tri.mat')['tri'].T - 1
    print(triangles.shape)
    triangles = _to_ctype(triangles).astype(np.int32)
    app = RenderPipeline(**cfg)
    img_render = app(vertices, triangles, img)
    plt.imshow(img_render)
    plt.show()

def main():
    if False:
        for i in range(10):
            print('nop')
    test()
if __name__ == '__main__':
    main()