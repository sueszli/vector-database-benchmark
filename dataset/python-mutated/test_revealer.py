from electrum.plugins.revealer.revealer import RevealerPlugin
from . import ElectrumTestCase

class TestRevealer(ElectrumTestCase):

    def test_version_0_noisemap(self):
        if False:
            for i in range(10):
                print('nop')
        versioned_seed = RevealerPlugin.get_versioned_seed_from_user_input('03b0c557d6d0d4308a3393851d78bd8c7861')
        noise_map = RevealerPlugin.get_noise_map(versioned_seed)
        bigint = 0
        for ((x, y), pixel) in noise_map.items():
            if pixel:
                bigint |= 1 << y * RevealerPlugin.SIZE[1] + x
        self.assertEqual(7460381371469617503079479678057292634708202391655593865874556315918246754102200132529574475032081884339276668573488267858907489363094890945702394799865294736279809524779999895464432136992155152007181628421415307283955955747540523561781716284716705863884142245970410457253357620673999827258159709258811777820554775642341596620212727216357786729943499804921302978927319507592694388042755328146949385181944535064815758327020184142565512169944160753572232127338923916616341749110592550675945493923963622402431744112297461029297971526809133053352081147526424140756247037500607912677437274315720718098818647132618224478309704330938341182416019501393695416921735797045055369256803465323316274072953850453798115711614920339641924261007658872035239225707998534956108241481087378851635403189615471820850324243279568696524454994508638169140472137717150733485918254069987842918589922262776784721101099811986482535925555241687298232224648106674825394321040687226060912281276900334457177577056725041636881855790580216330958909066095827860427385346976502850460829458072872244843143252013141226294459706397920837893590720353276959182842419800534016245987925915638128633057459324377083116966719869354305394414616961081890780323026246003710312709163131929394540271585282717298792049295726053202908756262275354964092468979308635714844054920499441790062631193346324869052049370007579824786386002163191915540442528567991493225388977943097316600889900146729940076689191161393387578200026074154088810443458655631152665050493974330717887741939989894607015517880499935393346080053081118836256739790729387193281113617820318815265324700577394558159834018041739650363901903302571439042652283441380776222868484675201898524911952079461434339261201784374952860235939099944694019025426344461854482153408780401595867063201663850542842956199472692079720881674287990565523695523623095863530318012694925332111366131898731356253270361091633660579276822256016441989656302989396932646773811091591373949880812480246028674571831555440982264344971489262305968913425397932050652807300542583492863095057809963576075185420258890410788327490651733930152921352142112924663410535842983522846747736709542645305522346452618860679729157135388894310353487294041605202723016628018125898188426274288855350719936777201041237609921606659266826578041897520279007670085547968786036416128680711353618531095778100189936794177028598344573647290473241747079136180664592357833494703516919562083417697686492311971601166338262088666509058690603739041281159938473429130795901375315921400978205179541311440681813595319750156265058339699146057064546025303228183301744754263185361870523171648331091891516214178998427171040396190305960183585673580343134987670289877317149984157658563532464648606802828176376505946743024611311388177628640531163555387474512503623026958038669658591205620691127501649411193517983547185219595, bigint)

    def test_version_1_noisemap(self):
        if False:
            for i in range(10):
                print('nop')
        versioned_seed = RevealerPlugin.get_versioned_seed_from_user_input('125Df05b7ccf079ce2978Ae18e99219868cd')
        noise_map = RevealerPlugin.get_noise_map(versioned_seed)
        bigint = 0
        for ((x, y), pixel) in noise_map.items():
            if pixel:
                bigint |= 1 << y * RevealerPlugin.SIZE[1] + x
        self.assertEqual(4877264810841394175318200379172409501650568560651783761755798554837188621884558861356813021404224399560601547756798918049578939388023178388794297413265792040251667377129042949145355050353519541504939037337664008629130094397717486919277039615303456983438831763432473868906993004401097741193506622695125777426508316478878353850669753548843615491024290714776944066580261680298481166463168376982958768658980261770501343082387677416044947731010437622819638529112110355117734260713773754914231127729083897976468801770792556733374472133365222895778107060707222312702915257246593214649290911674851221845755311421085815869405695060081732758393455711665573935768323765755596750579293287952116892096374076601940057011236370127750161954528132269545023479673827546995548206734027781113910896016768322462782338432275739125507405970711879707842071409934183280990488893948391368057715419815781480439531409382696500614402009777795760155636110671223550440141215707332881639553831554973779017263105634771894560810968628873771615473257002111494653695198726754293626472622041554743373671976361731748258604545030602151389818079245665661785374934789501958414938306677674881052510219245089135281304343467379738113246961243099422916978267539926117933469270696660731582197332339768252926277325642359124584361846689597559292210767899827137404610845473199811973660396541702901912308614839419051731715073240375027702159227134408403830865589381020096290418493582297070640344544139261959447842558825554403187807430380610993432865567034492424052735220631791664989684805568952316850136983369281013599205821630574314945914895472405844079521871452874022832287966922596321287878806802407990362317153440343124272980020293630361605973429032686596888795927969525315875174743504878001254687496254702820561010214551281990627074069122502386052083118754372607766923275743494821322686265471779027712046717603838079824958436941241327185026196904944040263303728950892727297536047753782816378341281726168749807504649362327812888459863334619528824059850607872026104883673232273774819424228972518637299484268586490410090609874418529099995469728287284768608886468526653247581201856915881480160687415971772761419736893653368634236185163774858657789910945322137433664794091378159865846655862774455597887014355680556308715155460187651558314982907164921057696482558934029488678728045951866814672994290239810434602029988286800757221186242325516051250964306497500265574118433149215058948338775063666504163906070279691409682311393562664425962841385861621854572633229939369184035339604949927413405883091388221574946116955134688832618167726790854194578041733315086379672119441474737187848849111901986910612632083880061244076835008425156649859441158964119034472795294923038806934016914818088995630664896020150238758695246560265414096176405435232373778993007051316673200967164699466166414299690460124777922650361, bigint)

    def test_version_1_noisemap_indexerror(self):
        if False:
            return 10
        versioned_seed = RevealerPlugin.get_versioned_seed_from_user_input('1A082CBDC627FFA37ABD154A64AD2565D725')
        noise_map = RevealerPlugin.get_noise_map(versioned_seed)
        bigint = 0
        for ((x, y), pixel) in noise_map.items():
            if pixel:
                bigint |= 1 << y * RevealerPlugin.SIZE[1] + x
        self.assertEqual(2903839476495119024032141904332565287290012222172557158397428025761881786789159353656155902975031198850903164123361861466285165643722207393946892862754735539866861354086091427188230399133498332420078574989213541171327925354480164186501485374426514018814262346730912607373616514207179804566777640779713064124131341699531673549329809917609914938697816276438336143053893012885044745722919141865771613714630758231206021587615610288167917438271145047710247092333336911155765376175028008691482867198456885975476965934571070490086217868611873287513327440520308928340294021465672915510418154122996553168123001217426168557613146696068078518786469278427080743125397327273559085945289508488399024537143376799627170192775322699793647229672664363821712355628952324239794242616716365773279560638467813941382621850344151417362266054163717402202839213692323989074030454370366555269594615472924239614315728047816838764508801531905349446416640967255474192816026721789538102226914493790066050557118591022850939981897894613206490738705887377390961545548067134847805000275135565337465139370870677535100445491080825598245551140581590012898621826309679767657614811909157266111771208473787663720065483611318193254212092177212450963252053688269219896924403605851763802734892153436465876002238405368510364026629536261655607666126397252450183080931217041524942001625477297714210490598294406248998286464557066675269349857483239451770105224090473153613862572942319250456983268960789442196270550522676014799772294200713963110006441738106976219462391325193400342668829506592274402560308801486601869968467659587655846743466266446577931742732214230287999229482574073700935609875301844204434931851037907448255433274016581612672710130352892215817407070070840613376220079614768785964516992094986617479011086000088698140803683926139324056150367165318097394355527960535067984736011757794957002184644836803759187003806234689573970261470988753895241697435111657937768553056103276157656011938545752592170943037943413213503519054780335506682091215487499464328013488179397321285644966324544383723696410675676243959218505742920818779218599625426819059543791722451349731097306215563361535241648181066889302882966962164866960469746920921004166041797586660333812370912644111025789153122495676166863810776190181065440199901554335388016755996023144006491070486897898888107824551077378436499224857398251585903767204434441877870978815553674322057389857855648341337713691315199687504441004942089622364165293001268497097178710890467198455371362115384014066114189549383509795955849989085677479500085471829317306338255539481165424033315124408908363240696382412832008968195092614463718480868915096429877317665409712267279568616300714669630560421250079413182052557663844071660690452644595721267635135403429767367912017078234733787249551388218606943304125163882363291332569095022213349247538454649450539367187, bigint)