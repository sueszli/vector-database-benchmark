"""Nexmark Query 0: Pass through (send and receive auction events).

The Nexmark suite is a series of queries (streaming pipelines) performed
on a simulation of auction events.

This query is a pass through that
simply parses the events generated by the launcher. It serves as a test
to verify the infrastructure.
"""
import apache_beam as beam

class RoundTripFn(beam.DoFn):

    def process(self, element):
        if False:
            return 10
        coder = element.CODER
        byte_value = coder.encode(element)
        recon = coder.decode(byte_value)
        yield recon

def load(events, metadata=None, pipeline_options=None):
    if False:
        print('Hello World!')
    return events | 'serialization_and_deserialization' >> beam.ParDo(RoundTripFn())