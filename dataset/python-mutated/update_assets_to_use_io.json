[
    {
        "func_name": "topstory_ids",
        "original": "@asset\ndef topstory_ids() -> List:\n    newstories_url = 'https://hacker-news.firebaseio.com/v0/topstories.json'\n    top_new_story_ids = requests.get(newstories_url).json()[:100]\n    return top_new_story_ids",
        "mutated": [
            "@asset\ndef topstory_ids() -> List:\n    if False:\n        i = 10\n    newstories_url = 'https://hacker-news.firebaseio.com/v0/topstories.json'\n    top_new_story_ids = requests.get(newstories_url).json()[:100]\n    return top_new_story_ids",
            "@asset\ndef topstory_ids() -> List:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    newstories_url = 'https://hacker-news.firebaseio.com/v0/topstories.json'\n    top_new_story_ids = requests.get(newstories_url).json()[:100]\n    return top_new_story_ids",
            "@asset\ndef topstory_ids() -> List:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    newstories_url = 'https://hacker-news.firebaseio.com/v0/topstories.json'\n    top_new_story_ids = requests.get(newstories_url).json()[:100]\n    return top_new_story_ids",
            "@asset\ndef topstory_ids() -> List:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    newstories_url = 'https://hacker-news.firebaseio.com/v0/topstories.json'\n    top_new_story_ids = requests.get(newstories_url).json()[:100]\n    return top_new_story_ids",
            "@asset\ndef topstory_ids() -> List:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    newstories_url = 'https://hacker-news.firebaseio.com/v0/topstories.json'\n    top_new_story_ids = requests.get(newstories_url).json()[:100]\n    return top_new_story_ids"
        ]
    },
    {
        "func_name": "topstories",
        "original": "@asset\ndef topstories(context: AssetExecutionContext, topstory_ids: List) -> pd.DataFrame:\n    logger = get_dagster_logger()\n    results = []\n    for item_id in topstory_ids:\n        item = requests.get(f'https://hacker-news.firebaseio.com/v0/item/{item_id}.json').json()\n        results.append(item)\n        if len(results) % 20 == 0:\n            logger.info(f'Got {len(results)} items so far.')\n    df = pd.DataFrame(results)\n    context.add_output_metadata(metadata={'num_records': len(df), 'preview': MetadataValue.md(df.head().to_markdown())})\n    return df",
        "mutated": [
            "@asset\ndef topstories(context: AssetExecutionContext, topstory_ids: List) -> pd.DataFrame:\n    if False:\n        i = 10\n    logger = get_dagster_logger()\n    results = []\n    for item_id in topstory_ids:\n        item = requests.get(f'https://hacker-news.firebaseio.com/v0/item/{item_id}.json').json()\n        results.append(item)\n        if len(results) % 20 == 0:\n            logger.info(f'Got {len(results)} items so far.')\n    df = pd.DataFrame(results)\n    context.add_output_metadata(metadata={'num_records': len(df), 'preview': MetadataValue.md(df.head().to_markdown())})\n    return df",
            "@asset\ndef topstories(context: AssetExecutionContext, topstory_ids: List) -> pd.DataFrame:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    logger = get_dagster_logger()\n    results = []\n    for item_id in topstory_ids:\n        item = requests.get(f'https://hacker-news.firebaseio.com/v0/item/{item_id}.json').json()\n        results.append(item)\n        if len(results) % 20 == 0:\n            logger.info(f'Got {len(results)} items so far.')\n    df = pd.DataFrame(results)\n    context.add_output_metadata(metadata={'num_records': len(df), 'preview': MetadataValue.md(df.head().to_markdown())})\n    return df",
            "@asset\ndef topstories(context: AssetExecutionContext, topstory_ids: List) -> pd.DataFrame:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    logger = get_dagster_logger()\n    results = []\n    for item_id in topstory_ids:\n        item = requests.get(f'https://hacker-news.firebaseio.com/v0/item/{item_id}.json').json()\n        results.append(item)\n        if len(results) % 20 == 0:\n            logger.info(f'Got {len(results)} items so far.')\n    df = pd.DataFrame(results)\n    context.add_output_metadata(metadata={'num_records': len(df), 'preview': MetadataValue.md(df.head().to_markdown())})\n    return df",
            "@asset\ndef topstories(context: AssetExecutionContext, topstory_ids: List) -> pd.DataFrame:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    logger = get_dagster_logger()\n    results = []\n    for item_id in topstory_ids:\n        item = requests.get(f'https://hacker-news.firebaseio.com/v0/item/{item_id}.json').json()\n        results.append(item)\n        if len(results) % 20 == 0:\n            logger.info(f'Got {len(results)} items so far.')\n    df = pd.DataFrame(results)\n    context.add_output_metadata(metadata={'num_records': len(df), 'preview': MetadataValue.md(df.head().to_markdown())})\n    return df",
            "@asset\ndef topstories(context: AssetExecutionContext, topstory_ids: List) -> pd.DataFrame:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    logger = get_dagster_logger()\n    results = []\n    for item_id in topstory_ids:\n        item = requests.get(f'https://hacker-news.firebaseio.com/v0/item/{item_id}.json').json()\n        results.append(item)\n        if len(results) % 20 == 0:\n            logger.info(f'Got {len(results)} items so far.')\n    df = pd.DataFrame(results)\n    context.add_output_metadata(metadata={'num_records': len(df), 'preview': MetadataValue.md(df.head().to_markdown())})\n    return df"
        ]
    },
    {
        "func_name": "most_frequent_words",
        "original": "@asset\ndef most_frequent_words(context: AssetExecutionContext, topstories: pd.DataFrame) -> Dict:\n    stopwords = ['a', 'the', 'an', 'of', 'to', 'in', 'for', 'and', 'with', 'on', 'is']\n    word_counts = {}\n    for raw_title in topstories['title']:\n        title = raw_title.lower()\n        for word in title.split():\n            cleaned_word = word.strip('.,-!?:;()[]\\'\"-')\n            if cleaned_word not in stopwords and len(cleaned_word) > 0:\n                word_counts[cleaned_word] = word_counts.get(cleaned_word, 0) + 1\n    top_words = {pair[0]: pair[1] for pair in sorted(word_counts.items(), key=lambda x: x[1], reverse=True)[:25]}\n    plt.figure(figsize=(10, 6))\n    plt.bar(list(top_words.keys()), list(top_words.values()))\n    plt.xticks(rotation=45, ha='right')\n    plt.title('Top 25 Words in Hacker News Titles')\n    plt.tight_layout()\n    buffer = BytesIO()\n    plt.savefig(buffer, format='png')\n    image_data = base64.b64encode(buffer.getvalue())\n    md_content = f'![img](data:image/png;base64,{image_data.decode()})'\n    context.add_output_metadata(metadata={'plot': MetadataValue.md(md_content)})\n    return top_words",
        "mutated": [
            "@asset\ndef most_frequent_words(context: AssetExecutionContext, topstories: pd.DataFrame) -> Dict:\n    if False:\n        i = 10\n    stopwords = ['a', 'the', 'an', 'of', 'to', 'in', 'for', 'and', 'with', 'on', 'is']\n    word_counts = {}\n    for raw_title in topstories['title']:\n        title = raw_title.lower()\n        for word in title.split():\n            cleaned_word = word.strip('.,-!?:;()[]\\'\"-')\n            if cleaned_word not in stopwords and len(cleaned_word) > 0:\n                word_counts[cleaned_word] = word_counts.get(cleaned_word, 0) + 1\n    top_words = {pair[0]: pair[1] for pair in sorted(word_counts.items(), key=lambda x: x[1], reverse=True)[:25]}\n    plt.figure(figsize=(10, 6))\n    plt.bar(list(top_words.keys()), list(top_words.values()))\n    plt.xticks(rotation=45, ha='right')\n    plt.title('Top 25 Words in Hacker News Titles')\n    plt.tight_layout()\n    buffer = BytesIO()\n    plt.savefig(buffer, format='png')\n    image_data = base64.b64encode(buffer.getvalue())\n    md_content = f'![img](data:image/png;base64,{image_data.decode()})'\n    context.add_output_metadata(metadata={'plot': MetadataValue.md(md_content)})\n    return top_words",
            "@asset\ndef most_frequent_words(context: AssetExecutionContext, topstories: pd.DataFrame) -> Dict:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n    stopwords = ['a', 'the', 'an', 'of', 'to', 'in', 'for', 'and', 'with', 'on', 'is']\n    word_counts = {}\n    for raw_title in topstories['title']:\n        title = raw_title.lower()\n        for word in title.split():\n            cleaned_word = word.strip('.,-!?:;()[]\\'\"-')\n            if cleaned_word not in stopwords and len(cleaned_word) > 0:\n                word_counts[cleaned_word] = word_counts.get(cleaned_word, 0) + 1\n    top_words = {pair[0]: pair[1] for pair in sorted(word_counts.items(), key=lambda x: x[1], reverse=True)[:25]}\n    plt.figure(figsize=(10, 6))\n    plt.bar(list(top_words.keys()), list(top_words.values()))\n    plt.xticks(rotation=45, ha='right')\n    plt.title('Top 25 Words in Hacker News Titles')\n    plt.tight_layout()\n    buffer = BytesIO()\n    plt.savefig(buffer, format='png')\n    image_data = base64.b64encode(buffer.getvalue())\n    md_content = f'![img](data:image/png;base64,{image_data.decode()})'\n    context.add_output_metadata(metadata={'plot': MetadataValue.md(md_content)})\n    return top_words",
            "@asset\ndef most_frequent_words(context: AssetExecutionContext, topstories: pd.DataFrame) -> Dict:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n    stopwords = ['a', 'the', 'an', 'of', 'to', 'in', 'for', 'and', 'with', 'on', 'is']\n    word_counts = {}\n    for raw_title in topstories['title']:\n        title = raw_title.lower()\n        for word in title.split():\n            cleaned_word = word.strip('.,-!?:;()[]\\'\"-')\n            if cleaned_word not in stopwords and len(cleaned_word) > 0:\n                word_counts[cleaned_word] = word_counts.get(cleaned_word, 0) + 1\n    top_words = {pair[0]: pair[1] for pair in sorted(word_counts.items(), key=lambda x: x[1], reverse=True)[:25]}\n    plt.figure(figsize=(10, 6))\n    plt.bar(list(top_words.keys()), list(top_words.values()))\n    plt.xticks(rotation=45, ha='right')\n    plt.title('Top 25 Words in Hacker News Titles')\n    plt.tight_layout()\n    buffer = BytesIO()\n    plt.savefig(buffer, format='png')\n    image_data = base64.b64encode(buffer.getvalue())\n    md_content = f'![img](data:image/png;base64,{image_data.decode()})'\n    context.add_output_metadata(metadata={'plot': MetadataValue.md(md_content)})\n    return top_words",
            "@asset\ndef most_frequent_words(context: AssetExecutionContext, topstories: pd.DataFrame) -> Dict:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        n = 10\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n    stopwords = ['a', 'the', 'an', 'of', 'to', 'in', 'for', 'and', 'with', 'on', 'is']\n    word_counts = {}\n    for raw_title in topstories['title']:\n        title = raw_title.lower()\n        for word in title.split():\n            cleaned_word = word.strip('.,-!?:;()[]\\'\"-')\n            if cleaned_word not in stopwords and len(cleaned_word) > 0:\n                word_counts[cleaned_word] = word_counts.get(cleaned_word, 0) + 1\n    top_words = {pair[0]: pair[1] for pair in sorted(word_counts.items(), key=lambda x: x[1], reverse=True)[:25]}\n    plt.figure(figsize=(10, 6))\n    plt.bar(list(top_words.keys()), list(top_words.values()))\n    plt.xticks(rotation=45, ha='right')\n    plt.title('Top 25 Words in Hacker News Titles')\n    plt.tight_layout()\n    buffer = BytesIO()\n    plt.savefig(buffer, format='png')\n    image_data = base64.b64encode(buffer.getvalue())\n    md_content = f'![img](data:image/png;base64,{image_data.decode()})'\n    context.add_output_metadata(metadata={'plot': MetadataValue.md(md_content)})\n    return top_words",
            "@asset\ndef most_frequent_words(context: AssetExecutionContext, topstories: pd.DataFrame) -> Dict:\n    if False:\n        i = 10\n        while True:\n            print('Mutation')\n        dp = [0, 1]\n        for i in range(2, n + 1):\n            dp.append(dp[i - 1] + dp[i - 2])\n        print(dp[n])\n\n        def dfs(node):\n            if node == None:\n                return []\n            left = dfs(node.left)\n            right = dfs(node.right)\n        length = 15\n        if length <= 0:\n            return []\n        elif length == 1:\n            return [0]\n        sequence = [0, 1]\n        while len(sequence) < length:\n            next_value = sequence[-1] + sequence[-2]\n            sequence.append(next_value)\n        return sequence\n    stopwords = ['a', 'the', 'an', 'of', 'to', 'in', 'for', 'and', 'with', 'on', 'is']\n    word_counts = {}\n    for raw_title in topstories['title']:\n        title = raw_title.lower()\n        for word in title.split():\n            cleaned_word = word.strip('.,-!?:;()[]\\'\"-')\n            if cleaned_word not in stopwords and len(cleaned_word) > 0:\n                word_counts[cleaned_word] = word_counts.get(cleaned_word, 0) + 1\n    top_words = {pair[0]: pair[1] for pair in sorted(word_counts.items(), key=lambda x: x[1], reverse=True)[:25]}\n    plt.figure(figsize=(10, 6))\n    plt.bar(list(top_words.keys()), list(top_words.values()))\n    plt.xticks(rotation=45, ha='right')\n    plt.title('Top 25 Words in Hacker News Titles')\n    plt.tight_layout()\n    buffer = BytesIO()\n    plt.savefig(buffer, format='png')\n    image_data = base64.b64encode(buffer.getvalue())\n    md_content = f'![img](data:image/png;base64,{image_data.decode()})'\n    context.add_output_metadata(metadata={'plot': MetadataValue.md(md_content)})\n    return top_words"
        ]
    }
]